{"version":3,"sources":["../../../../public/plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.all.js"],"names":["Object","defineProperty","getOwnPropertyDescriptor","Element","prototype","get","innerText","call","set","s","Array","isArray","arg","toString","wysihtml5","version","commands","dom","quirks","toolbar","lang","selection","views","INVISIBLE_SPACE","EMPTY_FUNCTION","ELEMENT_NODE","TEXT_NODE","BACKSPACE_KEY","ENTER_KEY","ESCAPE_KEY","SPACE_KEY","DELETE_KEY","factory","global","define","amd","rangy","OBJECT","FUNCTION","UNDEFINED","domRangeProperties","domRangeMethods","textRangeProperties","textRangeMethods","isHostMethod","o","p","t","isHostObject","isHostProperty","createMultiplePropertyTest","testFunc","props","i","length","areHostMethods","areHostObjects","areHostProperties","isTextRange","range","getBody","doc","body","getElementsByTagName","modules","api","initialized","supported","util","features","config","alertOnFail","alertOnWarn","preferTextRange","autoInitialize","rangyAutoInitialize","consoleLog","msg","window","console","log","alertOrLog","shouldAlert","alert","fail","reason","warn","hasOwnProperty","extend","obj","deep","el","document","createElement","appendChild","slice","toArray","childNodes","nodeType","arrayLike","e","arr","len","addListener","eventType","listener","addEventListener","attachEvent","initListeners","getErrorDesc","ex","message","description","String","init","testRange","implementsDomRange","implementsTextRange","createRange","nodeName","toLowerCase","createTextRange","module","errorMessage","moduleName","Module","addInitListener","push","shimListeners","addShimListener","shim","win","createMissingNativeApi","name","dependencies","initializer","requiredModuleNames","requiredModule","Error","deprecationNotice","deprecated","replacement","createError","createModule","isCore","initFunc","newModule","arguments","createCoreModule","RangePrototype","rangePrototype","SelectionPrototype","selectionPrototype","docReady","loadHandler","UNDEF","textNode","createTextNode","arrayContains","val","isHtmlNamespace","node","ns","namespaceURI","parentElement","parent","parentNode","getNodeIndex","previousSibling","getNodeLength","getCommonAncestor","node1","node2","ancestors","n","isAncestorOf","ancestor","descendant","selfIsAncestor","isOrIsAncestorOf","getClosestAncestorIn","isCharacterDataNode","isTextOrCommentNode","insertAfter","precedingNode","nextNode","nextSibling","insertBefore","splitDataNode","index","positionsToPreserve","newNode","cloneNode","deleteData","position","offset","getDocument","ownerDocument","getWindow","defaultView","parentWindow","getIframeDocument","iframeEl","contentDocument","contentWindow","getIframeWindow","isWindow","getContentDocument","methodName","tagName","getRootContainer","comparePoints","nodeA","offsetA","nodeB","offsetB","nodeC","root","childA","childB","firstChild","crashyTextNodes","isBrokenNode","innerHTML","inspectNode","data","idAttr","id","fragmentFromNodeChildren","fragment","createDocumentFragment","child","getComputedStyleProperty","getComputedStyle","propName","documentElement","currentStyle","NodeIterator","_next","_current","hasNext","next","detach","createIterator","DomPosition","equals","pos","inspect","DOMException","codeName","code","INDEX_SIZE_ERR","HIERARCHY_REQUEST_ERR","WRONG_DOCUMENT_ERR","NO_MODIFICATION_ALLOWED_ERR","NOT_FOUND_ERR","NOT_SUPPORTED_ERR","INVALID_STATE_ERR","INVALID_NODE_TYPE_ERR","isNonTextPartiallySelected","startContainer","endContainer","getRangeDocument","getBoundaryBeforeNode","getBoundaryAfterNode","insertNodeAtPosition","firstNodeInserted","rangesIntersect","rangeA","rangeB","touchingIsIntersecting","assertRangeValid","startComparison","startOffset","endOffset","endComparison","cloneSubtree","iterator","partiallySelected","frag","subIterator","isPartiallySelectedSubtree","getSubtreeIterator","iterateSubtree","rangeIterator","func","iteratorState","it","stop","subRangeIterator","deleteSubtree","remove","extractSubtree","getNodesInRange","nodeTypes","filter","filterNodeTypes","regex","filterExists","RegExp","join","nodes","RangeIterator","test","sc","ec","getName","clonePartiallySelectedTextNodes","collapsed","so","eo","commonAncestorContainer","isSingleCharacterDataNode","_first","_last","reset","current","start","end","removeChild","subRange","cloneRange","collapse","Range","updateBoundaries","beforeAfterNodeTypes","rootContainerNodeTypes","readonlyNodeTypes","insertableNodeTypes","surroundNodeTypes","createAncestorFinder","getDocumentOrFragmentContainer","getReadonlyAncestor","getDocTypeNotationEntityAncestor","assertNoDocTypeNotationEntityAncestor","allowSelf","assertValidNodeType","invalidTypes","assertValidOffset","assertSameDocumentOrFragment","assertNodeNotReadOnly","assertNode","isOrphan","isValidOffset","isRangeValid","styleEl","htmlParsingConforms","createContextualFragment","fragmentStr","splitRangeBoundaries","startEndSame","setStartAndEnd","rangeToHtml","container","cloneContents","rangeProperties","s2s","s2e","e2e","e2s","n_b","n_a","n_b_a","n_i","compareBoundaryPoints","how","prefixA","prefixB","insertNode","setStartBefore","clone","canSurroundContents","boundariesInvalid","surroundContents","content","extractContents","hasChildNodes","lastChild","selectNode","prop","textParts","compareNode","nodeIndex","comparePoint","toHtml","intersectsNode","isPointInRange","intersectsRange","intersectsOrTouchesRange","intersection","intersectionRange","setStart","setEnd","union","unionRange","containsNode","allowPartial","containsNodeContents","containsRange","containsNodeText","nodeRange","textNodes","getNodes","lastTextNode","pop","collapseBefore","setEndBefore","collapseAfter","setStartAfter","getBookmark","containerNode","preSelectionRange","selectNodeContents","moveToBookmark","bookmark","charIndex","nodeStack","foundStart","nextCharIndex","rangesEqual","isValid","copyComparisonConstantsToObject","START_TO_START","START_TO_END","END_TO_END","END_TO_START","NODE_BEFORE","NODE_AFTER","NODE_BEFORE_AND_AFTER","NODE_INSIDE","copyComparisonConstants","constructor","createRangeContentRemover","remover","boundaryUpdater","boundary","returnValue","createPrototypeRange","createBeforeAfterNodeSetter","isBefore","isStart","setRangeStart","setRangeEnd","F","args","setBoundary","setEndAfter","deleteContents","splitBoundaries","splitBoundariesPreservingPositions","normalizeBoundaries","mergeForward","sibling","appendData","mergeBackward","nodeLength","insertData","normalizeStart","endNode","startNode","collapseToPoint","updateCollapsedAndCommonAncestor","r1","r2","DomRange","WrappedRange","WrappedTextRange","rangeProto","updateRangeProperties","nativeRange","updateNativeRange","startMoved","endMoved","nativeRangeDifferent","refresh","testTextNode","oppositeName","range2","type","createNativeRange","getTextRangeContainerElement","textRange","parentEl","duplicate","startEl","endEl","startEndContainer","textRangeIsCollapsed","compareEndPoints","getTextRangeBoundaryPosition","wholeRangeContainerElement","isCollapsed","startInfo","workingRange","containerElement","canHaveHTML","boundaryPosition","nodeInfo","workingNode","comparison","workingComparisonType","previousNode","boundaryNode","childNodeCount","moveToElementText","Math","floor","setEndPoint","tempRange","rangeLength","text","replace","moveStart","createBoundaryTextRange","boundaryParent","boundaryOffset","nodeIsDataNode","startBoundary","rangeContainerElement","rangeToTextRange","startRange","endRange","toTextRange","globalObj","createRangyRange","createIframeRange","createIframeRangyRange","checkSelectionRanges","BOOLEAN","NUMBER","getNativeSelection","selectionIsCollapsed","CONTROL","isDirectionBackward","dir","WrappedSelection","getWinSelection","winParam","getSelection","getDocSelection","winSelectionIsBackward","sel","backward","anchorNode","anchorOffset","focusNode","focusOffset","implementsWinGetSelection","implementsDocSelection","useDocumentSelection","isSelectionValid","nativeSel","testSelection","selectionHasAnchorAndFocus","selectionHasExtend","selectionHasRangeCount","rangeCount","selectionSupportsMultipleRanges","collapsedNonEditableSelectionsSupported","addRangeBackwardToNative","nativeSelection","addRange","getNativeRange","originalSelectionRangeCount","selectionHasMultipleRanges","originalSelectionRanges","originalSelectionBackward","getRangeAt","testEl","contentEditable","removeAllRanges","chromeMatch","navigator","appVersion","match","parseInt","implementsControlRange","testControlRange","createControlRange","updateAnchorAndFocusFromRange","anchorPrefix","focusPrefix","updateAnchorAndFocusFromNativeSelection","updateEmptySelection","_ranges","rangeContainsSingleElement","rangeNodes","getSingleElementFromRange","updateFromTextRange","wrappedRange","updateControlSelection","docSelection","controlRange","item","addRangeToControlSelection","rangeElement","newControlRange","add","select","getSelectionRangeAt","deleteProperties","detached","cachedRangySelections","actOnCachedSelection","action","cached","splice","docSel","getIframeSelection","selProto","createControlSelection","ranges","addRangeBackward","direction","previousRangeCount","selectionIsBackward","setRanges","empty","refreshSelection","checkForChanges","oldRanges","oldAnchorNode","oldAnchorOffset","removeRangeManually","getAllRanges","removeRange","removed","isBackward","isBackwards","rangeTexts","assertNodeInSameDocument","setSingleRange","collapseToStart","collapseToEnd","selectAllChildren","deleteFromDocument","element","eachRange","callMethodOnEachRange","params","results","apply","createStartOrEndSetter","changeEachRange","rangeBookmarks","selRanges","rangeBookmark","rangeHtmls","getNativeTextRange","rangeInspects","anchor","focus","detachAll","Selection","markerTextChar","gEBI","getElementById","insertRangeBoundaryMarker","atStart","markerId","Date","random","markerEl","boundaryRange","style","lineHeight","display","className","setRangeBoundary","compareRanges","saveRange","startMarkerId","endMarkerId","restoreRange","rangeInfo","normalize","saveRanges","rangeInfos","sort","saveSelection","restored","restoreRanges","restoreSelection","savedSelection","preserveDirection","removeMarkerElement","removeMarkers","Base","_instance","_static","_prototyping","proto","base","klass","_constructing","forEach","implement","valueOf","source","value","method","previous","toSource","hidden","key","object","block","context","undefined","browser","userAgent","testElement","isGecko","indexOf","isWebKit","isChrome","isOpera","iosVersion","androidVersion","isIE","equation","rv","re","appName","exec","parseFloat","$1","USER_AGENT","hasContentEditableSupport","hasEditingApiSupport","execCommand","queryCommandSupported","queryCommandState","hasQuerySelectorSupport","querySelector","querySelectorAll","isIncompatibleMobileBrowser","isIos","isAndroid","isTouchDevice","supportsEvent","supportsSandboxedIframes","throwsMixedContentWarningWhenIframeSrcIsEmpty","displaysCaretInEmptyContentEditableCorrectly","hasCurrentStyleProperty","hasHistoryIssue","platform","substr","insertsLineBreaksOnReturn","supportsPlaceholderAttributeOn","eventName","setAttribute","supportsEventsInIframeCorrectly","supportsHTML5Tags","html5","supportsCommand","buggyCommands","command","isBuggy","e1","queryCommandEnabled","e2","doesAutoLinkingInContentEditable","canDisableAutoLinking","clearsContentEditableCorrectly","supportsGetAttributeCorrectly","td","getAttribute","canSelectImagesInContentEditable","autoScrollsToCaret","autoClosesUnclosedTags","clonedTestElement","supportsNativeGetElementsByClassName","getElementsByClassName","supportsSelectionModify","needsSpaceAfterLineBreak","supportsSpeechApiOn","input","chromeVersion","crashesWhenDefineProperty","property","doesAsyncFocus","hasProblemsSettingCaretAfterImg","hasUndoInContextMenu","hasInsertNodeIssue","hasIframeFocusIssue","createsNestedInvalidMarkupAfterPaste","supportsMutationEvents","supportsModenPaste","array","contains","needle","without","arrayToSubstract","newArr","newArray","map","callback","thisArg","A","unique","vals","max","idx","Dispatcher","on","handler","events","off","handlers","newHandlers","fire","payload","observe","stopObserving","merge","otherObj","newObj","isPlainObject","isFunction","WHITE_SPACE_START","WHITE_SPACE_END","ENTITY_REG_EXP","ENTITY_MAP","string","str","trim","interpolate","vars","by","search","split","escapeHTML","linebreaks","convertSpaces","html","c","IGNORE_URLS_IN","URL_REG_EXP","TRAILING_CHAR_REG_EXP","MAX_DISPLAY_LENGTH","BRACKETS","autoLink","ignoreInClasses","_hasParentThatShouldBeIgnored","_parseNode","_convertUrlsToLinks","url","punctuation","opening","realUrl","displayUrl","_getTempElement","tempElement","_wysihtml5_tempElement","_wrapMatchesInNode","nodeValue","childNodesLength","addClass","classList","hasClass","removeClass","elementClassName","compareDocumentPosition","convertToList","_createListItem","list","listItem","_createList","listType","uneditableClass","lineBreaks","lineBreaksLength","childNode","lineBreak","isBlockElement","isLineBreak","currentListItem","getStyle","from","insert","after","replaceChild","copyAttributes","attributesToCopy","elementToCopyFrom","to","elementToCopyTo","attribute","andTo","callee","BOX_SIZING_PROPERTIES","shouldIgnoreBoxSizingBorderBox","hasBoxSizingBorderBox","offsetWidth","copyStyles","stylesToCopy","cssText","setStyles","delegate","selector","event","target","domNode","defaultNodeTypes","_isBlankText","prev","options","prevNode","types","ignoreBlankTexts","getAsDom","_innerHTMLShiv","_ensureHTML5Compatibility","_wysihtml5_supportsHTML5Tags","HTML5_ELEMENTS","getParentElement","_isSameNodeName","desiredNodeNames","_isElement","_hasClassName","classRegExp","classNames","_hasStyle","cssStyle","styleRegExp","styles","matchingSet","levels","findByStyle","findByClass","stylePropertyMapping","REG_EXP_CAMELIZE","camelize","charAt","toUpperCase","camelizedProperty","styleValue","needsOverflowReset","originalOverflow","overflow","getPropertyValue","getTextNodes","ingoreEmpty","all","textContent","concat","hasElementWithTagName","LIVE_CACHE","DOCUMENT_IDENTIFIER","_getDocumentIdentifier","_wysihtml5_identifier","cacheEntry","hasElementWithClassName","elementToInsert","before","into","insertCSS","rules","styleElement","styleSheet","link","head","_isLineBreak","_isLineBreakOrBlockElement","eventNames","handlerWrapper","srcElement","preventDefault","stopPropagation","cancelBubble","removeEventListener","detachEvent","parse","elementOrHtml_current","config_current","NODE_TYPE_MAPPING","_handleElement","_handleText","_handleComment","DEFAULT_NODE_NAME","WHITE_SPACE_REG_EXP","defaultRules","tags","classes","currentRules","elementOrHtml","isString","clearInternals","selectors","_applySelectorRules","_convert","cleanUp","unjoinNbsps","txtnodes","getCorrectInnerHTML","oldNode","oldNodeType","oldChilds","oldChildsLength","newChild","attributes","selectorRules","els","elementHandlingMethods","rule","tagRules","scopeName","renameTag","_wysihtml5","outerHTML","unwrap","rename_tag","one_of_type","_testTypes","remove_action","remove_action_rename_to","_handleAttributes","_handleStyles","definition","type_definitions","_testType","array_contains","a","nodeClasses","nodeStyles","classesLength","s_corrected","attr","currentClass","styleProp","methods","m","typeCeckMethods","sp","attrs","v","keep_styles","styleFloat","cssFloat","_getAttributesBeginningWith","beginning","returnAttributes","_checkAttribute","attributeName","attributeValue","attributeCheckMethods","newAttributeValue","_checkAttributes","local_attributes","globalAttributes","checkAttributes","oldAttributes","getAttributes","newValue","matchingAttributes","imax","setClass","set_class","add_class","addStyle","add_style","setAttributes","set_attributes","allowedClasses","newClasses","oldClasses","newClassesLength","newClass","check_attributes","addClassMethods","addStyleMethods","newStyle","classes_blacklist","src","width","height","INVISIBLE_SPACE_REG_EXP","comments","createComment","REG_EXP","href","alt","numbers","any","align_text","mapping","left","right","center","align_img","justify","clear_br","both","size_font","has_visible_contet","txt","isVisible","visibleElements","offsetHeight","removeEmptyTextNodes","renameElement","newNodeName","newElement","replaceWithChildNodes","_isBlockElement","_appendLineBreak","resolveList","useLineBreaks","isLastChild","shouldAppendLineBreak","paragraph","firstElementChild","windowProperties","windowProperties2","documentProperties","Sandbox","readyCallback","editableArea","_createIframe","insertInto","getIframe","_readyError","destroy","iframe","that","onload","onreadystatechange","_onLoadIframe","readyState","iframeWindow","iframeDocument","charset","characterSet","sandboxHtml","_getHtml","stylesheets","open","write","close","onerror","fileName","lineNumber","_unset","loaded","setTimeout","templateVars","setter","__defineGetter__","__defineSetter__","ContentEditableArea","getContentEditable","_bindElement","_createElement","_loadElement","contentExists","simulatePlaceholder","editor","view","placeholderText","CLASS_NAME","unset","composerIsVisible","hasPlaceholderSet","clear","placeholderSet","isEmpty","setValue","setTextContent","getTextContent","HAS_GET_ATTRIBUTE_BUG","isLoadedImage","hasAttribute","specified","complete","mozMatchesSelector","MapCell","cell","isColspan","isRowspan","firstCol","lastCol","firstRow","lastRow","isReal","spanCollection","modified","TableModifyerByCell","table","queryInList","query","ret","q","unshift","removeElement","referenceNode","tag","addSpannedCellToMap","r","cspan","rspan","spanCollect","rmax","cmax","rr","cc","setCellAsModified","smax","setTableMap","tableRows","getTableRows","ridx","row","cells","cidx","getRowCells","inlineTables","inlineCells","allCells","tableCells","inlineRows","allRows","getMapIndex","r_length","c_length","r_idx","c_idx","getElementAtIndex","col","getMapElsTo","to_cell","idx_start","idx_end","temp_idx","temp_cidx","maxr","maxc","orderSelectionEnds","secondcell","createCells","nr","correctColIndexForUnreals","corrIdx","getLastNewCellOnRow","rowLimit","removeEmptyTable","splitRowToCells","colspan","cType","newCells","removeAttribute","getRealRowEl","force","injectRowAt","new_cells","n_cidx","canMerge","decreaseCellSpan","span","removeSurplusLines","allRowspan","fillMissingCells","r_max","c_max","prevcell","rectify","unmerge","thisCell","rowspan","collapseCellToNextRow","cellIdx","newRowIdx","newIdx","lastCell","removeRowCell","getRowElementsByCell","modRow","getColumnElementsByCell","removeRow","oldRow","removeColCell","removeColumn","what","addRow","where","newRow","addRowCell","cr","colSpanAttr","addColumn","addColCell","doAdd","handleCellAddWithRowspan","modCell","addRowsNr","crow","temp_r_cells","nrow","getCellsBetween","cell1","cell2","c1","addCells","removeCells","mergeCellsBetween","unmergeCell","findCell","findRowByCell","findColumnByCell","elements","thisOwner","otherOwner","point","parents","location_index","smallest_common_ancestor","this_index","other_index","getPastedHtml","clipboardData","getData","getPastedHtmlWithDiv","composer","f","selBookmark","cleanerDiv","setBookmark","cleanPastedHTML","styleToRegex","styleStr","trimmedStr","escapedStr","extendRulesWithStyleExceptions","exceptStyles","newRules","pickRuleset","ruleset","pickedSet","defaultSet","condition","newHtml","ensureProperClearing","clearIfNecessary","TILDE_ESCAPED","elementsWithTilde","urlToSearch","redraw","tableCellsSelection","editable","selectCells","selection_class","moveHandler","upHandler","handleSelectionMousedown","removeCellSelections","handleMouseMove","handleMouseUp","selectedCells","addSelections","curTable","oldEnd","deselect","bindSideclick","sideClickHandler","RGBA_REGEX","RGB_REGEX","HEX6_REGEX","HEX3_REGEX","param_REGX","styleParser","parseColor","stylesStr","paramName","paramRegex","radix","colorMatch","shift","d","unparseColor","parseFontSize","_getCumulativeOffsetTop","top","offsetTop","offsetParent","getDepth","expandRangeToSurround","common","start_depth","end_depth","contain","unselectableClass","getRange","setSelection","setBefore","setAfter","avoidInvisibleSpace","isElement","displayStyle","getSelectedNode","fixSelBorders","getSelectedOwnNodes","getOwnRanges","ownNodes","maxi","findNodesInSelection","curNodes","containsUneditable","uneditables","getOwnUneditables","getPreviousNode","ignoreEmpty","getSelectionParentsByTag","curEl","getRangeToNodeEnd","sNode","lastR","caretIsLastInSelection","endc","endtxt","caretIsFirstInSelection","caretIsInTheBeginnig","ofNode","caretIsBeforeUneditable","executeAndRestoreRangy","restoreScrollPosition","executeAndRestore","oldScrollTop","scrollTop","oldScrollLeft","scrollLeft","placeholderHtml","caretPlaceholder","newCaretPlaceholder","prevSibling","newRange","insertHTML","surround","nodeOptions","deblockAndSurround","tempDivElements","tempElements","scrollIntoView","tolerance","hasScrollBars","scrollHeight","_wysihtml5ScrollIntoViewElement","selectLine","_selectLine_W3C","_selectLine_MSIE","modify","rangeTop","boundingTop","scrollWidth","rangeBottom","rangeEnd","measureNode","j","moveToPoint","getText","fixRangeOverflow","containment","_detectInlineRangeProblems","previousElementSibling","_endOffsetForNode","dontFix","allUneditables","deepUneditables","tmpRanges","tmpRange","jmax","getHtml","isEndToEndInNode","nodeNames","defaultTagName","REG_EXP_WHITE_SPACE","cssClass","regExp","matchingClassNames","hasStyleAttr","matchingStyles","removeStyle","s2","getMatchingStyleRegexp","regexes","sSplit","elStyle","isMatchingAllready","areMatchingAllready","removeOrChangeStyle","exactRegex","hasSameClasses","el1","el2","replaceWithOwnChildren","elementsHaveSameNonClassAttributes","attr1","attr2","getNamedItem","isSplitPoint","splitNodeAt","descendantNode","descendantOffset","Merge","firstNode","isElementMerge","firstTextNode","doMerge","textBits","getLength","HTMLApplier","tagNames","similarClassRegExp","similarStyleRegExp","applyToAnyTagName","getAncestorWithClass","cssClassMatch","getAncestorWithStyle","cssStyleMatch","getMatchingAncestor","matchType","postApply","lastNode","merges","currentMerge","rangeStartNode","rangeEndNode","rangeStartOffset","rangeEndOffset","precedingTextNode","getAdjacentMergeableTextNode","nextTextNode","forward","isTextNode","adjacentNode","areElementsMergeable","createContainer","applyToTextNode","isRemovable","undoToTextNode","ancestorWithClass","ancestorWithStyle","styleMode","styleChanged","ancestorRange","applyToRange","ri","undoToRange","getTextSelectedByRange","isAppliedToRange","appliedType","styleAncestor","selectedText","toggleRange","isApplied","parentsExactMatch","coverage","Commands","support","result","state","commandValue","stateValue","bold","formatInline","execWithToggle","undef","NODE_NAME","_format","tempClass","tempClassRegExp","anchors","hasElementChild","elementToSetCaretAfter","whiteSpace","_changeLinks","oldAttrs","oa","createLink","_removeFormat","codeElement","removeLink","fontSize","size","fontSizeStyle","st","fontsizeMatches","foreColor","color","foreColorStyle","colorVals","colString","colorStr","bgColorStyle","BLOCK_ELEMENTS_GROUP","_addClass","_removeClass","_addStyle","_removeStyle","_removeLastChildIfLineBreak","_execCommand","eventListener","_selectionWrap","surroundedNodes","_hasClasses","_hasStyles","formatBlock","blockElements","defaultNodeName","selectedNodes","classRemoveAction","blockRenameFound","styleRemoveAction","blockElement","b","hasClasses","hasStyles","formatCode","classname","pre","selectedNode","ALIAS_MAPPING","htmlApplier","_getTagNames","alias","_getApplier","identifier","dontRestoreSelect","noCleanup","ownRanges","state_element","aliasTagName","insertBlockQuote","endToEndParent","qouteEl","insertImage","image","imagesInSelection","LINE_BREAK","insertLineBreak","insertOrderedList","insertList","insertUnorderedList","isNode","findListEl","other","parentLi","otherNodeName","handleSameTypeList","otherLists","innerLists","getListsInSelection","l","handleOtherTypeList","renameLists","createListFallback","tempClassName","getTime","uneditableContainerClassname","cmd","italic","justifyCenter","justifyLeft","justifyRight","justifyFull","STYLE_STR","alignRightStyle","alignLeftStyle","alignCenterStyle","redo","undoManager","underline","undo","createTable","cols","rows","tableStyle","mergeTableCells","tableSelection","addTableCells","tableSelect","deleteTableCells","selCell","indentList","listEls","tryToPushLiLevel","liNodes","listTag","prevLi","liNode","prevLiList","found","outdentList","tryToPullLiLevel","listNode","outerListNode","outerLiNode","afterList","getAfterList","newList","Z_KEY","Y_KEY","MAX_HISTORY_ENTRIES","DATA_ATTR_NODE","DATA_ATTR_OFFSET","UNDO_HTML","REDO_HTML","cleanTempElements","UndoManager","historyStr","historyDom","transact","_observe","sandbox","lastKey","altKey","ctrlKey","metaKey","keyCode","isUndo","shiftKey","isRedo","previousHtml","currentHtml","getValue","getChildNodeIndex","undoPossible","redoPossible","historyEntry","getChildNodeByIndex","View","textareaElement","noTextarea","_observeViewChange","currentView","show","hide","disable","enable","Composer","CARET_HACK","editableElement","textarea","contentEditableMode","_initContentEditableArea","_initSandbox","_displayStyle","disabled","setToEnd","_create","_createWysiwygFormField","form","hiddenField","composerClassName","placeholder","_initAutoLinking","_initObjectResizing","_initUndoManager","_initLineBreaking","initSync","sync","supportsDisablingOfAutoLinking","supportsAutoLinking","isInUneditable","links","urlRegExp","newTextContent","properties","propertiesLength","USE_NATIVE_LINE_BREAK_INSIDE_TAGS","LIST_TAGS","adjust","HOST_TEMPLATE","TEXT_FORMATTING","BOX_FORMATTING","ADDITIONAL_CSS_RULES","focusWithoutScrolling","setActive","elementStyle","originalScrollTop","originalScrollLeft","originalStyles","WebkitUserSelect","scrollTo","originalActiveElement","hasPlaceholder","originalPlaceholder","originalDisplayValue","originalDisabled","displayValueForCopying","focusStylesHost","blurStylesHost","disabledStylesHost","blur","boxFormattingStyles","shortcuts","deleteAroundEditable","uneditable","curNode","first","handleDeleteKeyPress","beforeUneditable","handleTabKeyDown","focusBlurElement","pasteEvents","interactionEvents","clearInterval","domNodeRemovedInterval","setInterval","handleTables","tableClickHandle","changeevent","create","copyedFromMarking","setData","allImages","notMyImages","myImages","handleTabKey","titlePrefixes","IMG","title","hasTitle","INTERVAL","Synchronizer","fromComposerToTextarea","shouldParseHtml","fromTextareaToComposer","textareaValue","interval","startInterval","stopInterval","Textarea","supportsPlaceholder","eventMapping","focusin","focusout","defaultConfig","showToolbarAfterInit","parserRules","br","div","pasteParserRulesets","parser","bodyClassName","supportTouchDevices","Editor","_isCompatible","_initParser","handleBeforeLoad","synchronizer","Toolbar","isCompatible","htmlOrElement","parseContext","oldHtml","cleanHtml","_cleanAndPaste","pastedHTML","CLASS_NAME_OPENED","SELECTOR_FORM_ELEMENTS","SELECTOR_FIELDS","ATTRIBUTE_FIELDS","Dialog","_observed","callbackWrapper","_serialize","elementToChange","formElements","_clearInterval","fields","_interpolate","avoidHiddenFields","field","fieldName","focusedElement","defaultValue","firstField","linkStyles","wrapperStyles","margin","opacity","padding","zIndex","inputStyles","cursor","marginTop","outline","inputAttributes","Speech","wrapper","CLASS_NAME_COMMAND_DISABLED","CLASS_NAME_COMMANDS_DISABLED","CLASS_NAME_COMMAND_ACTIVE","CLASS_NAME_ACTION_ACTIVE","showOnInit","_getLinks","classNameCommandDisabled","classNameCommandsDisabled","classNameCommandActive","classNameActionActive","speechInputLinks","group","dialog","_getDialog","dialogElement","caretBookmark","dialogContainer","commandLink","commandsDisabled","commandObj","commandMapping","_updateLinkStates","execAction","commandLinks","actionLinks","unselectable","actionMapping","multiselect","Dialog_createTable","Dialog_foreColorStyle","firstElement","Dialog_fontSizeStyle","Handlebars","h","g","k","escapeExpression","firstLine","firstColumn","column","helpers","partials","registerHelper","inverse","fn","each","last","hash","includeZero","level","VERSION","COMPILER_REVISION","REVISION_CHANGES","HandlebarsEnvironment","logger","not","registerPartial","methodMap","DEBUG","INFO","WARN","ERROR","createFrame","VM","invokePartial","compile","programs","program","programWithDepth","noop","compilerInfo","partial","checkRevision","depth","Function","template","SafeString","Exception","Utils","depth0","buffer","stack1","functionType","self","program1","program3","program5","fa","locale","colours","black","silver","gray","maroon","red","purple","green","olive","navy","blue","orange","emphasis","small","font_styles","normal","h1","h2","h3","h4","h5","h6","edit","program7","smallmodals","cancel","program9","program11","program13","program15","program17","lists","unordered","ordered","outdent","indent","jQuery","$","bsWysihtml5","templates","tpl","Wysihtml5","toolbarOpts","defaultOptions","customTemplates","createToolbar","createEditor","initializeEditor","syncBootstrapDialogEvents","loadParserRules","addMoreShortcuts","ajax","dataType","error","jqXHR","textStatus","errorThrown","success","modal","find","children","toggleClass","culture","debug","keys","localeObject","en","append","click","delegateTarget","showformat","formatname","resetDefaults","defaultOptionsCache","bypassDefaults","$this","shallowExtend","settings","deepExtend","Constructor"],"mappings":"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","file":"bootstrap3-wysihtml5.all.js","sourcesContent":["// TODO: in future try to replace most inline compability checks with polyfills for code readability \n\n// element.textContent polyfill.\n// Unsupporting browsers: IE8\n\nif (Object.defineProperty && Object.getOwnPropertyDescriptor && Object.getOwnPropertyDescriptor(Element.prototype, \"textContent\") && !Object.getOwnPropertyDescriptor(Element.prototype, \"textContent\").get) {\n\t(function() {\n\t\tvar innerText = Object.getOwnPropertyDescriptor(Element.prototype, \"innerText\");\n\t\tObject.defineProperty(Element.prototype, \"textContent\",\n\t\t\t{\n\t\t\t\tget: function() {\n\t\t\t\t\treturn innerText.get.call(this);\n\t\t\t\t},\n\t\t\t\tset: function(s) {\n\t\t\t\t\treturn innerText.set.call(this, s);\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t})();\n}\n\n// isArray polyfill for ie8\nif(!Array.isArray) {\n  Array.isArray = function(arg) {\n    return Object.prototype.toString.call(arg) === '[object Array]';\n  };\n};/**\n * @license wysihtml5x v0.4.15\n * https://github.com/Edicy/wysihtml5\n *\n * Author: Christopher Blum (https://github.com/tiff)\n * Secondary author of extended features: Oliver Pulges (https://github.com/pulges)\n *\n * Copyright (C) 2012 XING AG\n * Licensed under the MIT license (MIT)\n *\n */\nvar wysihtml5 = {\n  version: \"0.4.15\",\n\n  // namespaces\n  commands:   {},\n  dom:        {},\n  quirks:     {},\n  toolbar:    {},\n  lang:       {},\n  selection:  {},\n  views:      {},\n\n  INVISIBLE_SPACE: \"\\uFEFF\",\n\n  EMPTY_FUNCTION: function() {},\n\n  ELEMENT_NODE: 1,\n  TEXT_NODE:    3,\n\n  BACKSPACE_KEY:  8,\n  ENTER_KEY:      13,\n  ESCAPE_KEY:     27,\n  SPACE_KEY:      32,\n  DELETE_KEY:     46\n};\n;/**\n * Rangy, a cross-browser JavaScript range and selection library\n * http://code.google.com/p/rangy/\n *\n * Copyright 2014, Tim Down\n * Licensed under the MIT license.\n * Version: 1.3alpha.20140804\n * Build date: 4 August 2014\n */\n\n(function(factory, global) {\n    if (typeof define == \"function\" && define.amd) {\n        // AMD. Register as an anonymous module.\n        define(factory);\n/*\n    TODO: look into this properly.\n    \n    } else if (typeof exports == \"object\") {\n        // Node/CommonJS style for Browserify\n        module.exports = factory;\n*/\n    } else {\n        // No AMD or CommonJS support so we place Rangy in a global variable\n        global.rangy = factory();\n    }\n})(function() {\n\n    var OBJECT = \"object\", FUNCTION = \"function\", UNDEFINED = \"undefined\";\n\n    // Minimal set of properties required for DOM Level 2 Range compliance. Comparison constants such as START_TO_START\n    // are omitted because ranges in KHTML do not have them but otherwise work perfectly well. See issue 113.\n    var domRangeProperties = [\"startContainer\", \"startOffset\", \"endContainer\", \"endOffset\", \"collapsed\",\n        \"commonAncestorContainer\"];\n\n    // Minimal set of methods required for DOM Level 2 Range compliance\n    var domRangeMethods = [\"setStart\", \"setStartBefore\", \"setStartAfter\", \"setEnd\", \"setEndBefore\",\n        \"setEndAfter\", \"collapse\", \"selectNode\", \"selectNodeContents\", \"compareBoundaryPoints\", \"deleteContents\",\n        \"extractContents\", \"cloneContents\", \"insertNode\", \"surroundContents\", \"cloneRange\", \"toString\", \"detach\"];\n\n    var textRangeProperties = [\"boundingHeight\", \"boundingLeft\", \"boundingTop\", \"boundingWidth\", \"htmlText\", \"text\"];\n\n    // Subset of TextRange's full set of methods that we're interested in\n    var textRangeMethods = [\"collapse\", \"compareEndPoints\", \"duplicate\", \"moveToElementText\", \"parentElement\", \"select\",\n        \"setEndPoint\", \"getBoundingClientRect\"];\n\n    /*----------------------------------------------------------------------------------------------------------------*/\n\n    // Trio of functions taken from Peter Michaux's article:\n    // http://peter.michaux.ca/articles/feature-detection-state-of-the-art-browser-scripting\n    function isHostMethod(o, p) {\n        var t = typeof o[p];\n        return t == FUNCTION || (!!(t == OBJECT && o[p])) || t == \"unknown\";\n    }\n\n    function isHostObject(o, p) {\n        return !!(typeof o[p] == OBJECT && o[p]);\n    }\n\n    function isHostProperty(o, p) {\n        return typeof o[p] != UNDEFINED;\n    }\n\n    // Creates a convenience function to save verbose repeated calls to tests functions\n    function createMultiplePropertyTest(testFunc) {\n        return function(o, props) {\n            var i = props.length;\n            while (i--) {\n                if (!testFunc(o, props[i])) {\n                    return false;\n                }\n            }\n            return true;\n        };\n    }\n\n    // Next trio of functions are a convenience to save verbose repeated calls to previous two functions\n    var areHostMethods = createMultiplePropertyTest(isHostMethod);\n    var areHostObjects = createMultiplePropertyTest(isHostObject);\n    var areHostProperties = createMultiplePropertyTest(isHostProperty);\n\n    function isTextRange(range) {\n        return range && areHostMethods(range, textRangeMethods) && areHostProperties(range, textRangeProperties);\n    }\n\n    function getBody(doc) {\n        return isHostObject(doc, \"body\") ? doc.body : doc.getElementsByTagName(\"body\")[0];\n    }\n\n    var modules = {};\n\n    var api = {\n        version: \"1.3alpha.20140804\",\n        initialized: false,\n        supported: true,\n\n        util: {\n            isHostMethod: isHostMethod,\n            isHostObject: isHostObject,\n            isHostProperty: isHostProperty,\n            areHostMethods: areHostMethods,\n            areHostObjects: areHostObjects,\n            areHostProperties: areHostProperties,\n            isTextRange: isTextRange,\n            getBody: getBody\n        },\n\n        features: {},\n\n        modules: modules,\n        config: {\n            alertOnFail: true,\n            alertOnWarn: false,\n            preferTextRange: false,\n            autoInitialize: (typeof rangyAutoInitialize == UNDEFINED) ? true : rangyAutoInitialize\n        }\n    };\n\n    function consoleLog(msg) {\n        if (isHostObject(window, \"console\") && isHostMethod(window.console, \"log\")) {\n            window.console.log(msg);\n        }\n    }\n\n    function alertOrLog(msg, shouldAlert) {\n        if (shouldAlert) {\n            window.alert(msg);\n        } else  {\n            consoleLog(msg);\n        }\n    }\n\n    function fail(reason) {\n        api.initialized = true;\n        api.supported = false;\n        alertOrLog(\"Rangy is not supported on this page in your browser. Reason: \" + reason, api.config.alertOnFail);\n    }\n\n    api.fail = fail;\n\n    function warn(msg) {\n        alertOrLog(\"Rangy warning: \" + msg, api.config.alertOnWarn);\n    }\n\n    api.warn = warn;\n\n    // Add utility extend() method\n    if ({}.hasOwnProperty) {\n        api.util.extend = function(obj, props, deep) {\n            var o, p;\n            for (var i in props) {\n                if (props.hasOwnProperty(i)) {\n                    o = obj[i];\n                    p = props[i];\n                    if (deep && o !== null && typeof o == \"object\" && p !== null && typeof p == \"object\") {\n                        api.util.extend(o, p, true);\n                    }\n                    obj[i] = p;\n                }\n            }\n            // Special case for toString, which does not show up in for...in loops in IE <= 8\n            if (props.hasOwnProperty(\"toString\")) {\n                obj.toString = props.toString;\n            }\n            return obj;\n        };\n    } else {\n        fail(\"hasOwnProperty not supported\");\n    }\n\n    // Test whether Array.prototype.slice can be relied on for NodeLists and use an alternative toArray() if not\n    (function() {\n        var el = document.createElement(\"div\");\n        el.appendChild(document.createElement(\"span\"));\n        var slice = [].slice;\n        var toArray;\n        try {\n            if (slice.call(el.childNodes, 0)[0].nodeType == 1) {\n                toArray = function(arrayLike) {\n                    return slice.call(arrayLike, 0);\n                };\n            }\n        } catch (e) {}\n\n        if (!toArray) {\n            toArray = function(arrayLike) {\n                var arr = [];\n                for (var i = 0, len = arrayLike.length; i < len; ++i) {\n                    arr[i] = arrayLike[i];\n                }\n                return arr;\n            };\n        }\n\n        api.util.toArray = toArray;\n    })();\n\n\n    // Very simple event handler wrapper function that doesn't attempt to solve issues such as \"this\" handling or\n    // normalization of event properties\n    var addListener;\n    if (isHostMethod(document, \"addEventListener\")) {\n        addListener = function(obj, eventType, listener) {\n            obj.addEventListener(eventType, listener, false);\n        };\n    } else if (isHostMethod(document, \"attachEvent\")) {\n        addListener = function(obj, eventType, listener) {\n            obj.attachEvent(\"on\" + eventType, listener);\n        };\n    } else {\n        fail(\"Document does not have required addEventListener or attachEvent method\");\n    }\n\n    api.util.addListener = addListener;\n\n    var initListeners = [];\n\n    function getErrorDesc(ex) {\n        return ex.message || ex.description || String(ex);\n    }\n\n    // Initialization\n    function init() {\n        if (api.initialized) {\n            return;\n        }\n        var testRange;\n        var implementsDomRange = false, implementsTextRange = false;\n\n        // First, perform basic feature tests\n\n        if (isHostMethod(document, \"createRange\")) {\n            testRange = document.createRange();\n            if (areHostMethods(testRange, domRangeMethods) && areHostProperties(testRange, domRangeProperties)) {\n                implementsDomRange = true;\n            }\n        }\n\n        var body = getBody(document);\n        if (!body || body.nodeName.toLowerCase() != \"body\") {\n            fail(\"No body element found\");\n            return;\n        }\n\n        if (body && isHostMethod(body, \"createTextRange\")) {\n            testRange = body.createTextRange();\n            if (isTextRange(testRange)) {\n                implementsTextRange = true;\n            }\n        }\n\n        if (!implementsDomRange && !implementsTextRange) {\n            fail(\"Neither Range nor TextRange are available\");\n            return;\n        }\n\n        api.initialized = true;\n        api.features = {\n            implementsDomRange: implementsDomRange,\n            implementsTextRange: implementsTextRange\n        };\n\n        // Initialize modules\n        var module, errorMessage;\n        for (var moduleName in modules) {\n            if ( (module = modules[moduleName]) instanceof Module ) {\n                module.init(module, api);\n            }\n        }\n\n        // Call init listeners\n        for (var i = 0, len = initListeners.length; i < len; ++i) {\n            try {\n                initListeners[i](api);\n            } catch (ex) {\n                errorMessage = \"Rangy init listener threw an exception. Continuing. Detail: \" + getErrorDesc(ex);\n                consoleLog(errorMessage);\n            }\n        }\n    }\n\n    // Allow external scripts to initialize this library in case it's loaded after the document has loaded\n    api.init = init;\n\n    // Execute listener immediately if already initialized\n    api.addInitListener = function(listener) {\n        if (api.initialized) {\n            listener(api);\n        } else {\n            initListeners.push(listener);\n        }\n    };\n\n    var shimListeners = [];\n\n    api.addShimListener = function(listener) {\n        shimListeners.push(listener);\n    };\n\n    function shim(win) {\n        win = win || window;\n        init();\n\n        // Notify listeners\n        for (var i = 0, len = shimListeners.length; i < len; ++i) {\n            shimListeners[i](win);\n        }\n    }\n\n    api.shim = api.createMissingNativeApi = shim;\n\n    function Module(name, dependencies, initializer) {\n        this.name = name;\n        this.dependencies = dependencies;\n        this.initialized = false;\n        this.supported = false;\n        this.initializer = initializer;\n    }\n\n    Module.prototype = {\n        init: function() {\n            var requiredModuleNames = this.dependencies || [];\n            for (var i = 0, len = requiredModuleNames.length, requiredModule, moduleName; i < len; ++i) {\n                moduleName = requiredModuleNames[i];\n\n                requiredModule = modules[moduleName];\n                if (!requiredModule || !(requiredModule instanceof Module)) {\n                    throw new Error(\"required module '\" + moduleName + \"' not found\");\n                }\n\n                requiredModule.init();\n\n                if (!requiredModule.supported) {\n                    throw new Error(\"required module '\" + moduleName + \"' not supported\");\n                }\n            }\n            \n            // Now run initializer\n            this.initializer(this);\n        },\n        \n        fail: function(reason) {\n            this.initialized = true;\n            this.supported = false;\n            throw new Error(\"Module '\" + this.name + \"' failed to load: \" + reason);\n        },\n\n        warn: function(msg) {\n            api.warn(\"Module \" + this.name + \": \" + msg);\n        },\n\n        deprecationNotice: function(deprecated, replacement) {\n            api.warn(\"DEPRECATED: \" + deprecated + \" in module \" + this.name + \"is deprecated. Please use \" +\n                replacement + \" instead\");\n        },\n\n        createError: function(msg) {\n            return new Error(\"Error in Rangy \" + this.name + \" module: \" + msg);\n        }\n    };\n    \n    function createModule(isCore, name, dependencies, initFunc) {\n        var newModule = new Module(name, dependencies, function(module) {\n            if (!module.initialized) {\n                module.initialized = true;\n                try {\n                    initFunc(api, module);\n                    module.supported = true;\n                } catch (ex) {\n                    var errorMessage = \"Module '\" + name + \"' failed to load: \" + getErrorDesc(ex);\n                    consoleLog(errorMessage);\n                }\n            }\n        });\n        modules[name] = newModule;\n    }\n\n    api.createModule = function(name) {\n        // Allow 2 or 3 arguments (second argument is an optional array of dependencies)\n        var initFunc, dependencies;\n        if (arguments.length == 2) {\n            initFunc = arguments[1];\n            dependencies = [];\n        } else {\n            initFunc = arguments[2];\n            dependencies = arguments[1];\n        }\n\n        var module = createModule(false, name, dependencies, initFunc);\n\n        // Initialize the module immediately if the core is already initialized\n        if (api.initialized) {\n            module.init();\n        }\n    };\n\n    api.createCoreModule = function(name, dependencies, initFunc) {\n        createModule(true, name, dependencies, initFunc);\n    };\n\n    /*----------------------------------------------------------------------------------------------------------------*/\n\n    // Ensure rangy.rangePrototype and rangy.selectionPrototype are available immediately\n\n    function RangePrototype() {}\n    api.RangePrototype = RangePrototype;\n    api.rangePrototype = new RangePrototype();\n\n    function SelectionPrototype() {}\n    api.selectionPrototype = new SelectionPrototype();\n\n    /*----------------------------------------------------------------------------------------------------------------*/\n\n    // Wait for document to load before running tests\n\n    var docReady = false;\n\n    var loadHandler = function(e) {\n        if (!docReady) {\n            docReady = true;\n            if (!api.initialized && api.config.autoInitialize) {\n                init();\n            }\n        }\n    };\n\n    // Test whether we have window and document objects that we will need\n    if (typeof window == UNDEFINED) {\n        fail(\"No window found\");\n        return;\n    }\n    if (typeof document == UNDEFINED) {\n        fail(\"No document found\");\n        return;\n    }\n\n    if (isHostMethod(document, \"addEventListener\")) {\n        document.addEventListener(\"DOMContentLoaded\", loadHandler, false);\n    }\n\n    // Add a fallback in case the DOMContentLoaded event isn't supported\n    addListener(window, \"load\", loadHandler);\n\n    /*----------------------------------------------------------------------------------------------------------------*/\n    \n    // DOM utility methods used by Rangy\n    api.createCoreModule(\"DomUtil\", [], function(api, module) {\n        var UNDEF = \"undefined\";\n        var util = api.util;\n\n        // Perform feature tests\n        if (!util.areHostMethods(document, [\"createDocumentFragment\", \"createElement\", \"createTextNode\"])) {\n            module.fail(\"document missing a Node creation method\");\n        }\n\n        if (!util.isHostMethod(document, \"getElementsByTagName\")) {\n            module.fail(\"document missing getElementsByTagName method\");\n        }\n\n        var el = document.createElement(\"div\");\n        if (!util.areHostMethods(el, [\"insertBefore\", \"appendChild\", \"cloneNode\"] ||\n                !util.areHostObjects(el, [\"previousSibling\", \"nextSibling\", \"childNodes\", \"parentNode\"]))) {\n            module.fail(\"Incomplete Element implementation\");\n        }\n\n        // innerHTML is required for Range's createContextualFragment method\n        if (!util.isHostProperty(el, \"innerHTML\")) {\n            module.fail(\"Element is missing innerHTML property\");\n        }\n\n        var textNode = document.createTextNode(\"test\");\n        if (!util.areHostMethods(textNode, [\"splitText\", \"deleteData\", \"insertData\", \"appendData\", \"cloneNode\"] ||\n                !util.areHostObjects(el, [\"previousSibling\", \"nextSibling\", \"childNodes\", \"parentNode\"]) ||\n                !util.areHostProperties(textNode, [\"data\"]))) {\n            module.fail(\"Incomplete Text Node implementation\");\n        }\n\n        /*----------------------------------------------------------------------------------------------------------------*/\n\n        // Removed use of indexOf because of a bizarre bug in Opera that is thrown in one of the Acid3 tests. I haven't been\n        // able to replicate it outside of the test. The bug is that indexOf returns -1 when called on an Array that\n        // contains just the document as a single element and the value searched for is the document.\n        var arrayContains = /*Array.prototype.indexOf ?\n            function(arr, val) {\n                return arr.indexOf(val) > -1;\n            }:*/\n\n            function(arr, val) {\n                var i = arr.length;\n                while (i--) {\n                    if (arr[i] === val) {\n                        return true;\n                    }\n                }\n                return false;\n            };\n\n        // Opera 11 puts HTML elements in the null namespace, it seems, and IE 7 has undefined namespaceURI\n        function isHtmlNamespace(node) {\n            var ns;\n            return typeof node.namespaceURI == UNDEF || ((ns = node.namespaceURI) === null || ns == \"http://www.w3.org/1999/xhtml\");\n        }\n\n        function parentElement(node) {\n            var parent = node.parentNode;\n            return (parent.nodeType == 1) ? parent : null;\n        }\n\n        function getNodeIndex(node) {\n            var i = 0;\n            while( (node = node.previousSibling) ) {\n                ++i;\n            }\n            return i;\n        }\n\n        function getNodeLength(node) {\n            switch (node.nodeType) {\n                case 7:\n                case 10:\n                    return 0;\n                case 3:\n                case 8:\n                    return node.length;\n                default:\n                    return node.childNodes.length;\n            }\n        }\n\n        function getCommonAncestor(node1, node2) {\n            var ancestors = [], n;\n            for (n = node1; n; n = n.parentNode) {\n                ancestors.push(n);\n            }\n\n            for (n = node2; n; n = n.parentNode) {\n                if (arrayContains(ancestors, n)) {\n                    return n;\n                }\n            }\n\n            return null;\n        }\n\n        function isAncestorOf(ancestor, descendant, selfIsAncestor) {\n            var n = selfIsAncestor ? descendant : descendant.parentNode;\n            while (n) {\n                if (n === ancestor) {\n                    return true;\n                } else {\n                    n = n.parentNode;\n                }\n            }\n            return false;\n        }\n\n        function isOrIsAncestorOf(ancestor, descendant) {\n            return isAncestorOf(ancestor, descendant, true);\n        }\n\n        function getClosestAncestorIn(node, ancestor, selfIsAncestor) {\n            var p, n = selfIsAncestor ? node : node.parentNode;\n            while (n) {\n                p = n.parentNode;\n                if (p === ancestor) {\n                    return n;\n                }\n                n = p;\n            }\n            return null;\n        }\n\n        function isCharacterDataNode(node) {\n            var t = node.nodeType;\n            return t == 3 || t == 4 || t == 8 ; // Text, CDataSection or Comment\n        }\n\n        function isTextOrCommentNode(node) {\n            if (!node) {\n                return false;\n            }\n            var t = node.nodeType;\n            return t == 3 || t == 8 ; // Text or Comment\n        }\n\n        function insertAfter(node, precedingNode) {\n            var nextNode = precedingNode.nextSibling, parent = precedingNode.parentNode;\n            if (nextNode) {\n                parent.insertBefore(node, nextNode);\n            } else {\n                parent.appendChild(node);\n            }\n            return node;\n        }\n\n        // Note that we cannot use splitText() because it is bugridden in IE 9.\n        function splitDataNode(node, index, positionsToPreserve) {\n            var newNode = node.cloneNode(false);\n            newNode.deleteData(0, index);\n            node.deleteData(index, node.length - index);\n            insertAfter(newNode, node);\n\n            // Preserve positions\n            if (positionsToPreserve) {\n                for (var i = 0, position; position = positionsToPreserve[i++]; ) {\n                    // Handle case where position was inside the portion of node after the split point\n                    if (position.node == node && position.offset > index) {\n                        position.node = newNode;\n                        position.offset -= index;\n                    }\n                    // Handle the case where the position is a node offset within node's parent\n                    else if (position.node == node.parentNode && position.offset > getNodeIndex(node)) {\n                        ++position.offset;\n                    }\n                }\n            }\n            return newNode;\n        }\n\n        function getDocument(node) {\n            if (node.nodeType == 9) {\n                return node;\n            } else if (typeof node.ownerDocument != UNDEF) {\n                return node.ownerDocument;\n            } else if (typeof node.document != UNDEF) {\n                return node.document;\n            } else if (node.parentNode) {\n                return getDocument(node.parentNode);\n            } else {\n                throw module.createError(\"getDocument: no document found for node\");\n            }\n        }\n\n        function getWindow(node) {\n            var doc = getDocument(node);\n            if (typeof doc.defaultView != UNDEF) {\n                return doc.defaultView;\n            } else if (typeof doc.parentWindow != UNDEF) {\n                return doc.parentWindow;\n            } else {\n                throw module.createError(\"Cannot get a window object for node\");\n            }\n        }\n\n        function getIframeDocument(iframeEl) {\n            if (typeof iframeEl.contentDocument != UNDEF) {\n                return iframeEl.contentDocument;\n            } else if (typeof iframeEl.contentWindow != UNDEF) {\n                return iframeEl.contentWindow.document;\n            } else {\n                throw module.createError(\"getIframeDocument: No Document object found for iframe element\");\n            }\n        }\n\n        function getIframeWindow(iframeEl) {\n            if (typeof iframeEl.contentWindow != UNDEF) {\n                return iframeEl.contentWindow;\n            } else if (typeof iframeEl.contentDocument != UNDEF) {\n                return iframeEl.contentDocument.defaultView;\n            } else {\n                throw module.createError(\"getIframeWindow: No Window object found for iframe element\");\n            }\n        }\n\n        // This looks bad. Is it worth it?\n        function isWindow(obj) {\n            return obj && util.isHostMethod(obj, \"setTimeout\") && util.isHostObject(obj, \"document\");\n        }\n\n        function getContentDocument(obj, module, methodName) {\n            var doc;\n\n            if (!obj) {\n                doc = document;\n            }\n\n            // Test if a DOM node has been passed and obtain a document object for it if so\n            else if (util.isHostProperty(obj, \"nodeType\")) {\n                doc = (obj.nodeType == 1 && obj.tagName.toLowerCase() == \"iframe\") ?\n                    getIframeDocument(obj) : getDocument(obj);\n            }\n\n            // Test if the doc parameter appears to be a Window object\n            else if (isWindow(obj)) {\n                doc = obj.document;\n            }\n\n            if (!doc) {\n                throw module.createError(methodName + \"(): Parameter must be a Window object or DOM node\");\n            }\n\n            return doc;\n        }\n\n        function getRootContainer(node) {\n            var parent;\n            while ( (parent = node.parentNode) ) {\n                node = parent;\n            }\n            return node;\n        }\n\n        function comparePoints(nodeA, offsetA, nodeB, offsetB) {\n            // See http://www.w3.org/TR/DOM-Level-2-Traversal-Range/ranges.html#Level-2-Range-Comparing\n            var nodeC, root, childA, childB, n;\n            if (nodeA == nodeB) {\n                // Case 1: nodes are the same\n                return offsetA === offsetB ? 0 : (offsetA < offsetB) ? -1 : 1;\n            } else if ( (nodeC = getClosestAncestorIn(nodeB, nodeA, true)) ) {\n                // Case 2: node C (container B or an ancestor) is a child node of A\n                return offsetA <= getNodeIndex(nodeC) ? -1 : 1;\n            } else if ( (nodeC = getClosestAncestorIn(nodeA, nodeB, true)) ) {\n                // Case 3: node C (container A or an ancestor) is a child node of B\n                return getNodeIndex(nodeC) < offsetB  ? -1 : 1;\n            } else {\n                root = getCommonAncestor(nodeA, nodeB);\n                if (!root) {\n                    throw new Error(\"comparePoints error: nodes have no common ancestor\");\n                }\n\n                // Case 4: containers are siblings or descendants of siblings\n                childA = (nodeA === root) ? root : getClosestAncestorIn(nodeA, root, true);\n                childB = (nodeB === root) ? root : getClosestAncestorIn(nodeB, root, true);\n\n                if (childA === childB) {\n                    // This shouldn't be possible\n                    throw module.createError(\"comparePoints got to case 4 and childA and childB are the same!\");\n                } else {\n                    n = root.firstChild;\n                    while (n) {\n                        if (n === childA) {\n                            return -1;\n                        } else if (n === childB) {\n                            return 1;\n                        }\n                        n = n.nextSibling;\n                    }\n                }\n            }\n        }\n\n        /*----------------------------------------------------------------------------------------------------------------*/\n\n        // Test for IE's crash (IE 6/7) or exception (IE >= 8) when a reference to garbage-collected text node is queried\n        var crashyTextNodes = false;\n\n        function isBrokenNode(node) {\n            var n;\n            try {\n                n = node.parentNode;\n                return false;\n            } catch (e) {\n                return true;\n            }\n        }\n\n        (function() {\n            var el = document.createElement(\"b\");\n            el.innerHTML = \"1\";\n            var textNode = el.firstChild;\n            el.innerHTML = \"<br>\";\n            crashyTextNodes = isBrokenNode(textNode);\n\n            api.features.crashyTextNodes = crashyTextNodes;\n        })();\n\n        /*----------------------------------------------------------------------------------------------------------------*/\n\n        function inspectNode(node) {\n            if (!node) {\n                return \"[No node]\";\n            }\n            if (crashyTextNodes && isBrokenNode(node)) {\n                return \"[Broken node]\";\n            }\n            if (isCharacterDataNode(node)) {\n                return '\"' + node.data + '\"';\n            }\n            if (node.nodeType == 1) {\n                var idAttr = node.id ? ' id=\"' + node.id + '\"' : \"\";\n                return \"<\" + node.nodeName + idAttr + \">[index:\" + getNodeIndex(node) + \",length:\" + node.childNodes.length + \"][\" + (node.innerHTML || \"[innerHTML not supported]\").slice(0, 25) + \"]\";\n            }\n            return node.nodeName;\n        }\n\n        function fragmentFromNodeChildren(node) {\n            var fragment = getDocument(node).createDocumentFragment(), child;\n            while ( (child = node.firstChild) ) {\n                fragment.appendChild(child);\n            }\n            return fragment;\n        }\n\n        var getComputedStyleProperty;\n        if (typeof window.getComputedStyle != UNDEF) {\n            getComputedStyleProperty = function(el, propName) {\n                return getWindow(el).getComputedStyle(el, null)[propName];\n            };\n        } else if (typeof document.documentElement.currentStyle != UNDEF) {\n            getComputedStyleProperty = function(el, propName) {\n                return el.currentStyle[propName];\n            };\n        } else {\n            module.fail(\"No means of obtaining computed style properties found\");\n        }\n\n        function NodeIterator(root) {\n            this.root = root;\n            this._next = root;\n        }\n\n        NodeIterator.prototype = {\n            _current: null,\n\n            hasNext: function() {\n                return !!this._next;\n            },\n\n            next: function() {\n                var n = this._current = this._next;\n                var child, next;\n                if (this._current) {\n                    child = n.firstChild;\n                    if (child) {\n                        this._next = child;\n                    } else {\n                        next = null;\n                        while ((n !== this.root) && !(next = n.nextSibling)) {\n                            n = n.parentNode;\n                        }\n                        this._next = next;\n                    }\n                }\n                return this._current;\n            },\n\n            detach: function() {\n                this._current = this._next = this.root = null;\n            }\n        };\n\n        function createIterator(root) {\n            return new NodeIterator(root);\n        }\n\n        function DomPosition(node, offset) {\n            this.node = node;\n            this.offset = offset;\n        }\n\n        DomPosition.prototype = {\n            equals: function(pos) {\n                return !!pos && this.node === pos.node && this.offset == pos.offset;\n            },\n\n            inspect: function() {\n                return \"[DomPosition(\" + inspectNode(this.node) + \":\" + this.offset + \")]\";\n            },\n\n            toString: function() {\n                return this.inspect();\n            }\n        };\n\n        function DOMException(codeName) {\n            this.code = this[codeName];\n            this.codeName = codeName;\n            this.message = \"DOMException: \" + this.codeName;\n        }\n\n        DOMException.prototype = {\n            INDEX_SIZE_ERR: 1,\n            HIERARCHY_REQUEST_ERR: 3,\n            WRONG_DOCUMENT_ERR: 4,\n            NO_MODIFICATION_ALLOWED_ERR: 7,\n            NOT_FOUND_ERR: 8,\n            NOT_SUPPORTED_ERR: 9,\n            INVALID_STATE_ERR: 11,\n            INVALID_NODE_TYPE_ERR: 24\n        };\n\n        DOMException.prototype.toString = function() {\n            return this.message;\n        };\n\n        api.dom = {\n            arrayContains: arrayContains,\n            isHtmlNamespace: isHtmlNamespace,\n            parentElement: parentElement,\n            getNodeIndex: getNodeIndex,\n            getNodeLength: getNodeLength,\n            getCommonAncestor: getCommonAncestor,\n            isAncestorOf: isAncestorOf,\n            isOrIsAncestorOf: isOrIsAncestorOf,\n            getClosestAncestorIn: getClosestAncestorIn,\n            isCharacterDataNode: isCharacterDataNode,\n            isTextOrCommentNode: isTextOrCommentNode,\n            insertAfter: insertAfter,\n            splitDataNode: splitDataNode,\n            getDocument: getDocument,\n            getWindow: getWindow,\n            getIframeWindow: getIframeWindow,\n            getIframeDocument: getIframeDocument,\n            getBody: util.getBody,\n            isWindow: isWindow,\n            getContentDocument: getContentDocument,\n            getRootContainer: getRootContainer,\n            comparePoints: comparePoints,\n            isBrokenNode: isBrokenNode,\n            inspectNode: inspectNode,\n            getComputedStyleProperty: getComputedStyleProperty,\n            fragmentFromNodeChildren: fragmentFromNodeChildren,\n            createIterator: createIterator,\n            DomPosition: DomPosition\n        };\n\n        api.DOMException = DOMException;\n    });\n\n    /*----------------------------------------------------------------------------------------------------------------*/\n\n    // Pure JavaScript implementation of DOM Range\n    api.createCoreModule(\"DomRange\", [\"DomUtil\"], function(api, module) {\n        var dom = api.dom;\n        var util = api.util;\n        var DomPosition = dom.DomPosition;\n        var DOMException = api.DOMException;\n\n        var isCharacterDataNode = dom.isCharacterDataNode;\n        var getNodeIndex = dom.getNodeIndex;\n        var isOrIsAncestorOf = dom.isOrIsAncestorOf;\n        var getDocument = dom.getDocument;\n        var comparePoints = dom.comparePoints;\n        var splitDataNode = dom.splitDataNode;\n        var getClosestAncestorIn = dom.getClosestAncestorIn;\n        var getNodeLength = dom.getNodeLength;\n        var arrayContains = dom.arrayContains;\n        var getRootContainer = dom.getRootContainer;\n        var crashyTextNodes = api.features.crashyTextNodes;\n\n        /*----------------------------------------------------------------------------------------------------------------*/\n\n        // Utility functions\n\n        function isNonTextPartiallySelected(node, range) {\n            return (node.nodeType != 3) &&\n                   (isOrIsAncestorOf(node, range.startContainer) || isOrIsAncestorOf(node, range.endContainer));\n        }\n\n        function getRangeDocument(range) {\n            return range.document || getDocument(range.startContainer);\n        }\n\n        function getBoundaryBeforeNode(node) {\n            return new DomPosition(node.parentNode, getNodeIndex(node));\n        }\n\n        function getBoundaryAfterNode(node) {\n            return new DomPosition(node.parentNode, getNodeIndex(node) + 1);\n        }\n\n        function insertNodeAtPosition(node, n, o) {\n            var firstNodeInserted = node.nodeType == 11 ? node.firstChild : node;\n            if (isCharacterDataNode(n)) {\n                if (o == n.length) {\n                    dom.insertAfter(node, n);\n                } else {\n                    n.parentNode.insertBefore(node, o == 0 ? n : splitDataNode(n, o));\n                }\n            } else if (o >= n.childNodes.length) {\n                n.appendChild(node);\n            } else {\n                n.insertBefore(node, n.childNodes[o]);\n            }\n            return firstNodeInserted;\n        }\n\n        function rangesIntersect(rangeA, rangeB, touchingIsIntersecting) {\n            assertRangeValid(rangeA);\n            assertRangeValid(rangeB);\n\n            if (getRangeDocument(rangeB) != getRangeDocument(rangeA)) {\n                throw new DOMException(\"WRONG_DOCUMENT_ERR\");\n            }\n\n            var startComparison = comparePoints(rangeA.startContainer, rangeA.startOffset, rangeB.endContainer, rangeB.endOffset),\n                endComparison = comparePoints(rangeA.endContainer, rangeA.endOffset, rangeB.startContainer, rangeB.startOffset);\n\n            return touchingIsIntersecting ? startComparison <= 0 && endComparison >= 0 : startComparison < 0 && endComparison > 0;\n        }\n\n        function cloneSubtree(iterator) {\n            var partiallySelected;\n            for (var node, frag = getRangeDocument(iterator.range).createDocumentFragment(), subIterator; node = iterator.next(); ) {\n                partiallySelected = iterator.isPartiallySelectedSubtree();\n                node = node.cloneNode(!partiallySelected);\n                if (partiallySelected) {\n                    subIterator = iterator.getSubtreeIterator();\n                    node.appendChild(cloneSubtree(subIterator));\n                    subIterator.detach();\n                }\n\n                if (node.nodeType == 10) { // DocumentType\n                    throw new DOMException(\"HIERARCHY_REQUEST_ERR\");\n                }\n                frag.appendChild(node);\n            }\n            return frag;\n        }\n\n        function iterateSubtree(rangeIterator, func, iteratorState) {\n            var it, n;\n            iteratorState = iteratorState || { stop: false };\n            for (var node, subRangeIterator; node = rangeIterator.next(); ) {\n                if (rangeIterator.isPartiallySelectedSubtree()) {\n                    if (func(node) === false) {\n                        iteratorState.stop = true;\n                        return;\n                    } else {\n                        // The node is partially selected by the Range, so we can use a new RangeIterator on the portion of\n                        // the node selected by the Range.\n                        subRangeIterator = rangeIterator.getSubtreeIterator();\n                        iterateSubtree(subRangeIterator, func, iteratorState);\n                        subRangeIterator.detach();\n                        if (iteratorState.stop) {\n                            return;\n                        }\n                    }\n                } else {\n                    // The whole node is selected, so we can use efficient DOM iteration to iterate over the node and its\n                    // descendants\n                    it = dom.createIterator(node);\n                    while ( (n = it.next()) ) {\n                        if (func(n) === false) {\n                            iteratorState.stop = true;\n                            return;\n                        }\n                    }\n                }\n            }\n        }\n\n        function deleteSubtree(iterator) {\n            var subIterator;\n            while (iterator.next()) {\n                if (iterator.isPartiallySelectedSubtree()) {\n                    subIterator = iterator.getSubtreeIterator();\n                    deleteSubtree(subIterator);\n                    subIterator.detach();\n                } else {\n                    iterator.remove();\n                }\n            }\n        }\n\n        function extractSubtree(iterator) {\n            for (var node, frag = getRangeDocument(iterator.range).createDocumentFragment(), subIterator; node = iterator.next(); ) {\n\n                if (iterator.isPartiallySelectedSubtree()) {\n                    node = node.cloneNode(false);\n                    subIterator = iterator.getSubtreeIterator();\n                    node.appendChild(extractSubtree(subIterator));\n                    subIterator.detach();\n                } else {\n                    iterator.remove();\n                }\n                if (node.nodeType == 10) { // DocumentType\n                    throw new DOMException(\"HIERARCHY_REQUEST_ERR\");\n                }\n                frag.appendChild(node);\n            }\n            return frag;\n        }\n\n        function getNodesInRange(range, nodeTypes, filter) {\n            var filterNodeTypes = !!(nodeTypes && nodeTypes.length), regex;\n            var filterExists = !!filter;\n            if (filterNodeTypes) {\n                regex = new RegExp(\"^(\" + nodeTypes.join(\"|\") + \")$\");\n            }\n\n            var nodes = [];\n            iterateSubtree(new RangeIterator(range, false), function(node) {\n                if (filterNodeTypes && !regex.test(node.nodeType)) {\n                    return;\n                }\n                if (filterExists && !filter(node)) {\n                    return;\n                }\n                // Don't include a boundary container if it is a character data node and the range does not contain any\n                // of its character data. See issue 190.\n                var sc = range.startContainer;\n                if (node == sc && isCharacterDataNode(sc) && range.startOffset == sc.length) {\n                    return;\n                }\n\n                var ec = range.endContainer;\n                if (node == ec && isCharacterDataNode(ec) && range.endOffset == 0) {\n                    return;\n                }\n\n                nodes.push(node);\n            });\n            return nodes;\n        }\n\n        function inspect(range) {\n            var name = (typeof range.getName == \"undefined\") ? \"Range\" : range.getName();\n            return \"[\" + name + \"(\" + dom.inspectNode(range.startContainer) + \":\" + range.startOffset + \", \" +\n                    dom.inspectNode(range.endContainer) + \":\" + range.endOffset + \")]\";\n        }\n\n        /*----------------------------------------------------------------------------------------------------------------*/\n\n        // RangeIterator code partially borrows from IERange by Tim Ryan (http://github.com/timcameronryan/IERange)\n\n        function RangeIterator(range, clonePartiallySelectedTextNodes) {\n            this.range = range;\n            this.clonePartiallySelectedTextNodes = clonePartiallySelectedTextNodes;\n\n\n            if (!range.collapsed) {\n                this.sc = range.startContainer;\n                this.so = range.startOffset;\n                this.ec = range.endContainer;\n                this.eo = range.endOffset;\n                var root = range.commonAncestorContainer;\n\n                if (this.sc === this.ec && isCharacterDataNode(this.sc)) {\n                    this.isSingleCharacterDataNode = true;\n                    this._first = this._last = this._next = this.sc;\n                } else {\n                    this._first = this._next = (this.sc === root && !isCharacterDataNode(this.sc)) ?\n                        this.sc.childNodes[this.so] : getClosestAncestorIn(this.sc, root, true);\n                    this._last = (this.ec === root && !isCharacterDataNode(this.ec)) ?\n                        this.ec.childNodes[this.eo - 1] : getClosestAncestorIn(this.ec, root, true);\n                }\n            }\n        }\n\n        RangeIterator.prototype = {\n            _current: null,\n            _next: null,\n            _first: null,\n            _last: null,\n            isSingleCharacterDataNode: false,\n\n            reset: function() {\n                this._current = null;\n                this._next = this._first;\n            },\n\n            hasNext: function() {\n                return !!this._next;\n            },\n\n            next: function() {\n                // Move to next node\n                var current = this._current = this._next;\n                if (current) {\n                    this._next = (current !== this._last) ? current.nextSibling : null;\n\n                    // Check for partially selected text nodes\n                    if (isCharacterDataNode(current) && this.clonePartiallySelectedTextNodes) {\n                        if (current === this.ec) {\n                            (current = current.cloneNode(true)).deleteData(this.eo, current.length - this.eo);\n                        }\n                        if (this._current === this.sc) {\n                            (current = current.cloneNode(true)).deleteData(0, this.so);\n                        }\n                    }\n                }\n\n                return current;\n            },\n\n            remove: function() {\n                var current = this._current, start, end;\n\n                if (isCharacterDataNode(current) && (current === this.sc || current === this.ec)) {\n                    start = (current === this.sc) ? this.so : 0;\n                    end = (current === this.ec) ? this.eo : current.length;\n                    if (start != end) {\n                        current.deleteData(start, end - start);\n                    }\n                } else {\n                    if (current.parentNode) {\n                        current.parentNode.removeChild(current);\n                    } else {\n                    }\n                }\n            },\n\n            // Checks if the current node is partially selected\n            isPartiallySelectedSubtree: function() {\n                var current = this._current;\n                return isNonTextPartiallySelected(current, this.range);\n            },\n\n            getSubtreeIterator: function() {\n                var subRange;\n                if (this.isSingleCharacterDataNode) {\n                    subRange = this.range.cloneRange();\n                    subRange.collapse(false);\n                } else {\n                    subRange = new Range(getRangeDocument(this.range));\n                    var current = this._current;\n                    var startContainer = current, startOffset = 0, endContainer = current, endOffset = getNodeLength(current);\n\n                    if (isOrIsAncestorOf(current, this.sc)) {\n                        startContainer = this.sc;\n                        startOffset = this.so;\n                    }\n                    if (isOrIsAncestorOf(current, this.ec)) {\n                        endContainer = this.ec;\n                        endOffset = this.eo;\n                    }\n\n                    updateBoundaries(subRange, startContainer, startOffset, endContainer, endOffset);\n                }\n                return new RangeIterator(subRange, this.clonePartiallySelectedTextNodes);\n            },\n\n            detach: function() {\n                this.range = this._current = this._next = this._first = this._last = this.sc = this.so = this.ec = this.eo = null;\n            }\n        };\n\n        /*----------------------------------------------------------------------------------------------------------------*/\n\n        var beforeAfterNodeTypes = [1, 3, 4, 5, 7, 8, 10];\n        var rootContainerNodeTypes = [2, 9, 11];\n        var readonlyNodeTypes = [5, 6, 10, 12];\n        var insertableNodeTypes = [1, 3, 4, 5, 7, 8, 10, 11];\n        var surroundNodeTypes = [1, 3, 4, 5, 7, 8];\n\n        function createAncestorFinder(nodeTypes) {\n            return function(node, selfIsAncestor) {\n                var t, n = selfIsAncestor ? node : node.parentNode;\n                while (n) {\n                    t = n.nodeType;\n                    if (arrayContains(nodeTypes, t)) {\n                        return n;\n                    }\n                    n = n.parentNode;\n                }\n                return null;\n            };\n        }\n\n        var getDocumentOrFragmentContainer = createAncestorFinder( [9, 11] );\n        var getReadonlyAncestor = createAncestorFinder(readonlyNodeTypes);\n        var getDocTypeNotationEntityAncestor = createAncestorFinder( [6, 10, 12] );\n\n        function assertNoDocTypeNotationEntityAncestor(node, allowSelf) {\n            if (getDocTypeNotationEntityAncestor(node, allowSelf)) {\n                throw new DOMException(\"INVALID_NODE_TYPE_ERR\");\n            }\n        }\n\n        function assertValidNodeType(node, invalidTypes) {\n            if (!arrayContains(invalidTypes, node.nodeType)) {\n                throw new DOMException(\"INVALID_NODE_TYPE_ERR\");\n            }\n        }\n\n        function assertValidOffset(node, offset) {\n            if (offset < 0 || offset > (isCharacterDataNode(node) ? node.length : node.childNodes.length)) {\n                throw new DOMException(\"INDEX_SIZE_ERR\");\n            }\n        }\n\n        function assertSameDocumentOrFragment(node1, node2) {\n            if (getDocumentOrFragmentContainer(node1, true) !== getDocumentOrFragmentContainer(node2, true)) {\n                throw new DOMException(\"WRONG_DOCUMENT_ERR\");\n            }\n        }\n\n        function assertNodeNotReadOnly(node) {\n            if (getReadonlyAncestor(node, true)) {\n                throw new DOMException(\"NO_MODIFICATION_ALLOWED_ERR\");\n            }\n        }\n\n        function assertNode(node, codeName) {\n            if (!node) {\n                throw new DOMException(codeName);\n            }\n        }\n\n        function isOrphan(node) {\n            return (crashyTextNodes && dom.isBrokenNode(node)) ||\n                !arrayContains(rootContainerNodeTypes, node.nodeType) && !getDocumentOrFragmentContainer(node, true);\n        }\n\n        function isValidOffset(node, offset) {\n            return offset <= (isCharacterDataNode(node) ? node.length : node.childNodes.length);\n        }\n\n        function isRangeValid(range) {\n            return (!!range.startContainer && !!range.endContainer &&\n                    !isOrphan(range.startContainer) &&\n                    !isOrphan(range.endContainer) &&\n                    isValidOffset(range.startContainer, range.startOffset) &&\n                    isValidOffset(range.endContainer, range.endOffset));\n        }\n\n        function assertRangeValid(range) {\n            if (!isRangeValid(range)) {\n                throw new Error(\"Range error: Range is no longer valid after DOM mutation (\" + range.inspect() + \")\");\n            }\n        }\n\n        /*----------------------------------------------------------------------------------------------------------------*/\n\n        // Test the browser's innerHTML support to decide how to implement createContextualFragment\n        var styleEl = document.createElement(\"style\");\n        var htmlParsingConforms = false;\n        try {\n            styleEl.innerHTML = \"<b>x</b>\";\n            htmlParsingConforms = (styleEl.firstChild.nodeType == 3); // Opera incorrectly creates an element node\n        } catch (e) {\n            // IE 6 and 7 throw\n        }\n\n        api.features.htmlParsingConforms = htmlParsingConforms;\n\n        var createContextualFragment = htmlParsingConforms ?\n\n            // Implementation as per HTML parsing spec, trusting in the browser's implementation of innerHTML. See\n            // discussion and base code for this implementation at issue 67.\n            // Spec: http://html5.org/specs/dom-parsing.html#extensions-to-the-range-interface\n            // Thanks to Aleks Williams.\n            function(fragmentStr) {\n                // \"Let node the context object's start's node.\"\n                var node = this.startContainer;\n                var doc = getDocument(node);\n\n                // \"If the context object's start's node is null, raise an INVALID_STATE_ERR\n                // exception and abort these steps.\"\n                if (!node) {\n                    throw new DOMException(\"INVALID_STATE_ERR\");\n                }\n\n                // \"Let element be as follows, depending on node's interface:\"\n                // Document, Document Fragment: null\n                var el = null;\n\n                // \"Element: node\"\n                if (node.nodeType == 1) {\n                    el = node;\n\n                // \"Text, Comment: node's parentElement\"\n                } else if (isCharacterDataNode(node)) {\n                    el = dom.parentElement(node);\n                }\n\n                // \"If either element is null or element's ownerDocument is an HTML document\n                // and element's local name is \"html\" and element's namespace is the HTML\n                // namespace\"\n                if (el === null || (\n                    el.nodeName == \"HTML\" &&\n                    dom.isHtmlNamespace(getDocument(el).documentElement) &&\n                    dom.isHtmlNamespace(el)\n                )) {\n\n                // \"let element be a new Element with \"body\" as its local name and the HTML\n                // namespace as its namespace.\"\"\n                    el = doc.createElement(\"body\");\n                } else {\n                    el = el.cloneNode(false);\n                }\n\n                // \"If the node's document is an HTML document: Invoke the HTML fragment parsing algorithm.\"\n                // \"If the node's document is an XML document: Invoke the XML fragment parsing algorithm.\"\n                // \"In either case, the algorithm must be invoked with fragment as the input\n                // and element as the context element.\"\n                el.innerHTML = fragmentStr;\n\n                // \"If this raises an exception, then abort these steps. Otherwise, let new\n                // children be the nodes returned.\"\n\n                // \"Let fragment be a new DocumentFragment.\"\n                // \"Append all new children to fragment.\"\n                // \"Return fragment.\"\n                return dom.fragmentFromNodeChildren(el);\n            } :\n\n            // In this case, innerHTML cannot be trusted, so fall back to a simpler, non-conformant implementation that\n            // previous versions of Rangy used (with the exception of using a body element rather than a div)\n            function(fragmentStr) {\n                var doc = getRangeDocument(this);\n                var el = doc.createElement(\"body\");\n                el.innerHTML = fragmentStr;\n\n                return dom.fragmentFromNodeChildren(el);\n            };\n\n        function splitRangeBoundaries(range, positionsToPreserve) {\n            assertRangeValid(range);\n\n            var sc = range.startContainer, so = range.startOffset, ec = range.endContainer, eo = range.endOffset;\n            var startEndSame = (sc === ec);\n\n            if (isCharacterDataNode(ec) && eo > 0 && eo < ec.length) {\n                splitDataNode(ec, eo, positionsToPreserve);\n            }\n\n            if (isCharacterDataNode(sc) && so > 0 && so < sc.length) {\n                sc = splitDataNode(sc, so, positionsToPreserve);\n                if (startEndSame) {\n                    eo -= so;\n                    ec = sc;\n                } else if (ec == sc.parentNode && eo >= getNodeIndex(sc)) {\n                    eo++;\n                }\n                so = 0;\n            }\n            range.setStartAndEnd(sc, so, ec, eo);\n        }\n        \n        function rangeToHtml(range) {\n            assertRangeValid(range);\n            var container = range.commonAncestorContainer.parentNode.cloneNode(false);\n            container.appendChild( range.cloneContents() );\n            return container.innerHTML;\n        }\n\n        /*----------------------------------------------------------------------------------------------------------------*/\n\n        var rangeProperties = [\"startContainer\", \"startOffset\", \"endContainer\", \"endOffset\", \"collapsed\",\n            \"commonAncestorContainer\"];\n\n        var s2s = 0, s2e = 1, e2e = 2, e2s = 3;\n        var n_b = 0, n_a = 1, n_b_a = 2, n_i = 3;\n\n        util.extend(api.rangePrototype, {\n            compareBoundaryPoints: function(how, range) {\n                assertRangeValid(this);\n                assertSameDocumentOrFragment(this.startContainer, range.startContainer);\n\n                var nodeA, offsetA, nodeB, offsetB;\n                var prefixA = (how == e2s || how == s2s) ? \"start\" : \"end\";\n                var prefixB = (how == s2e || how == s2s) ? \"start\" : \"end\";\n                nodeA = this[prefixA + \"Container\"];\n                offsetA = this[prefixA + \"Offset\"];\n                nodeB = range[prefixB + \"Container\"];\n                offsetB = range[prefixB + \"Offset\"];\n                return comparePoints(nodeA, offsetA, nodeB, offsetB);\n            },\n\n            insertNode: function(node) {\n                assertRangeValid(this);\n                assertValidNodeType(node, insertableNodeTypes);\n                assertNodeNotReadOnly(this.startContainer);\n\n                if (isOrIsAncestorOf(node, this.startContainer)) {\n                    throw new DOMException(\"HIERARCHY_REQUEST_ERR\");\n                }\n\n                // No check for whether the container of the start of the Range is of a type that does not allow\n                // children of the type of node: the browser's DOM implementation should do this for us when we attempt\n                // to add the node\n\n                var firstNodeInserted = insertNodeAtPosition(node, this.startContainer, this.startOffset);\n                this.setStartBefore(firstNodeInserted);\n            },\n\n            cloneContents: function() {\n                assertRangeValid(this);\n\n                var clone, frag;\n                if (this.collapsed) {\n                    return getRangeDocument(this).createDocumentFragment();\n                } else {\n                    if (this.startContainer === this.endContainer && isCharacterDataNode(this.startContainer)) {\n                        clone = this.startContainer.cloneNode(true);\n                        clone.data = clone.data.slice(this.startOffset, this.endOffset);\n                        frag = getRangeDocument(this).createDocumentFragment();\n                        frag.appendChild(clone);\n                        return frag;\n                    } else {\n                        var iterator = new RangeIterator(this, true);\n                        clone = cloneSubtree(iterator);\n                        iterator.detach();\n                    }\n                    return clone;\n                }\n            },\n\n            canSurroundContents: function() {\n                assertRangeValid(this);\n                assertNodeNotReadOnly(this.startContainer);\n                assertNodeNotReadOnly(this.endContainer);\n\n                // Check if the contents can be surrounded. Specifically, this means whether the range partially selects\n                // no non-text nodes.\n                var iterator = new RangeIterator(this, true);\n                var boundariesInvalid = (iterator._first && (isNonTextPartiallySelected(iterator._first, this)) ||\n                        (iterator._last && isNonTextPartiallySelected(iterator._last, this)));\n                iterator.detach();\n                return !boundariesInvalid;\n            },\n\n            surroundContents: function(node) {\n                assertValidNodeType(node, surroundNodeTypes);\n\n                if (!this.canSurroundContents()) {\n                    throw new DOMException(\"INVALID_STATE_ERR\");\n                }\n\n                // Extract the contents\n                var content = this.extractContents();\n\n                // Clear the children of the node\n                if (node.hasChildNodes()) {\n                    while (node.lastChild) {\n                        node.removeChild(node.lastChild);\n                    }\n                }\n\n                // Insert the new node and add the extracted contents\n                insertNodeAtPosition(node, this.startContainer, this.startOffset);\n                node.appendChild(content);\n\n                this.selectNode(node);\n            },\n\n            cloneRange: function() {\n                assertRangeValid(this);\n                var range = new Range(getRangeDocument(this));\n                var i = rangeProperties.length, prop;\n                while (i--) {\n                    prop = rangeProperties[i];\n                    range[prop] = this[prop];\n                }\n                return range;\n            },\n\n            toString: function() {\n                assertRangeValid(this);\n                var sc = this.startContainer;\n                if (sc === this.endContainer && isCharacterDataNode(sc)) {\n                    return (sc.nodeType == 3 || sc.nodeType == 4) ? sc.data.slice(this.startOffset, this.endOffset) : \"\";\n                } else {\n                    var textParts = [], iterator = new RangeIterator(this, true);\n                    iterateSubtree(iterator, function(node) {\n                        // Accept only text or CDATA nodes, not comments\n                        if (node.nodeType == 3 || node.nodeType == 4) {\n                            textParts.push(node.data);\n                        }\n                    });\n                    iterator.detach();\n                    return textParts.join(\"\");\n                }\n            },\n\n            // The methods below are all non-standard. The following batch were introduced by Mozilla but have since\n            // been removed from Mozilla.\n\n            compareNode: function(node) {\n                assertRangeValid(this);\n\n                var parent = node.parentNode;\n                var nodeIndex = getNodeIndex(node);\n\n                if (!parent) {\n                    throw new DOMException(\"NOT_FOUND_ERR\");\n                }\n\n                var startComparison = this.comparePoint(parent, nodeIndex),\n                    endComparison = this.comparePoint(parent, nodeIndex + 1);\n\n                if (startComparison < 0) { // Node starts before\n                    return (endComparison > 0) ? n_b_a : n_b;\n                } else {\n                    return (endComparison > 0) ? n_a : n_i;\n                }\n            },\n\n            comparePoint: function(node, offset) {\n                assertRangeValid(this);\n                assertNode(node, \"HIERARCHY_REQUEST_ERR\");\n                assertSameDocumentOrFragment(node, this.startContainer);\n\n                if (comparePoints(node, offset, this.startContainer, this.startOffset) < 0) {\n                    return -1;\n                } else if (comparePoints(node, offset, this.endContainer, this.endOffset) > 0) {\n                    return 1;\n                }\n                return 0;\n            },\n\n            createContextualFragment: createContextualFragment,\n\n            toHtml: function() {\n                return rangeToHtml(this);\n            },\n\n            // touchingIsIntersecting determines whether this method considers a node that borders a range intersects\n            // with it (as in WebKit) or not (as in Gecko pre-1.9, and the default)\n            intersectsNode: function(node, touchingIsIntersecting) {\n                assertRangeValid(this);\n                assertNode(node, \"NOT_FOUND_ERR\");\n                if (getDocument(node) !== getRangeDocument(this)) {\n                    return false;\n                }\n\n                var parent = node.parentNode, offset = getNodeIndex(node);\n                assertNode(parent, \"NOT_FOUND_ERR\");\n\n                var startComparison = comparePoints(parent, offset, this.endContainer, this.endOffset),\n                    endComparison = comparePoints(parent, offset + 1, this.startContainer, this.startOffset);\n\n                return touchingIsIntersecting ? startComparison <= 0 && endComparison >= 0 : startComparison < 0 && endComparison > 0;\n            },\n\n            isPointInRange: function(node, offset) {\n                assertRangeValid(this);\n                assertNode(node, \"HIERARCHY_REQUEST_ERR\");\n                assertSameDocumentOrFragment(node, this.startContainer);\n\n                return (comparePoints(node, offset, this.startContainer, this.startOffset) >= 0) &&\n                       (comparePoints(node, offset, this.endContainer, this.endOffset) <= 0);\n            },\n\n            // The methods below are non-standard and invented by me.\n\n            // Sharing a boundary start-to-end or end-to-start does not count as intersection.\n            intersectsRange: function(range) {\n                return rangesIntersect(this, range, false);\n            },\n\n            // Sharing a boundary start-to-end or end-to-start does count as intersection.\n            intersectsOrTouchesRange: function(range) {\n                return rangesIntersect(this, range, true);\n            },\n\n            intersection: function(range) {\n                if (this.intersectsRange(range)) {\n                    var startComparison = comparePoints(this.startContainer, this.startOffset, range.startContainer, range.startOffset),\n                        endComparison = comparePoints(this.endContainer, this.endOffset, range.endContainer, range.endOffset);\n\n                    var intersectionRange = this.cloneRange();\n                    if (startComparison == -1) {\n                        intersectionRange.setStart(range.startContainer, range.startOffset);\n                    }\n                    if (endComparison == 1) {\n                        intersectionRange.setEnd(range.endContainer, range.endOffset);\n                    }\n                    return intersectionRange;\n                }\n                return null;\n            },\n\n            union: function(range) {\n                if (this.intersectsOrTouchesRange(range)) {\n                    var unionRange = this.cloneRange();\n                    if (comparePoints(range.startContainer, range.startOffset, this.startContainer, this.startOffset) == -1) {\n                        unionRange.setStart(range.startContainer, range.startOffset);\n                    }\n                    if (comparePoints(range.endContainer, range.endOffset, this.endContainer, this.endOffset) == 1) {\n                        unionRange.setEnd(range.endContainer, range.endOffset);\n                    }\n                    return unionRange;\n                } else {\n                    throw new DOMException(\"Ranges do not intersect\");\n                }\n            },\n\n            containsNode: function(node, allowPartial) {\n                if (allowPartial) {\n                    return this.intersectsNode(node, false);\n                } else {\n                    return this.compareNode(node) == n_i;\n                }\n            },\n\n            containsNodeContents: function(node) {\n                return this.comparePoint(node, 0) >= 0 && this.comparePoint(node, getNodeLength(node)) <= 0;\n            },\n\n            containsRange: function(range) {\n                var intersection = this.intersection(range);\n                return intersection !== null && range.equals(intersection);\n            },\n\n            containsNodeText: function(node) {\n                var nodeRange = this.cloneRange();\n                nodeRange.selectNode(node);\n                var textNodes = nodeRange.getNodes([3]);\n                if (textNodes.length > 0) {\n                    nodeRange.setStart(textNodes[0], 0);\n                    var lastTextNode = textNodes.pop();\n                    nodeRange.setEnd(lastTextNode, lastTextNode.length);\n                    return this.containsRange(nodeRange);\n                } else {\n                    return this.containsNodeContents(node);\n                }\n            },\n\n            getNodes: function(nodeTypes, filter) {\n                assertRangeValid(this);\n                return getNodesInRange(this, nodeTypes, filter);\n            },\n\n            getDocument: function() {\n                return getRangeDocument(this);\n            },\n\n            collapseBefore: function(node) {\n                this.setEndBefore(node);\n                this.collapse(false);\n            },\n\n            collapseAfter: function(node) {\n                this.setStartAfter(node);\n                this.collapse(true);\n            },\n            \n            getBookmark: function(containerNode) {\n                var doc = getRangeDocument(this);\n                var preSelectionRange = api.createRange(doc);\n                containerNode = containerNode || dom.getBody(doc);\n                preSelectionRange.selectNodeContents(containerNode);\n                var range = this.intersection(preSelectionRange);\n                var start = 0, end = 0;\n                if (range) {\n                    preSelectionRange.setEnd(range.startContainer, range.startOffset);\n                    start = preSelectionRange.toString().length;\n                    end = start + range.toString().length;\n                }\n\n                return {\n                    start: start,\n                    end: end,\n                    containerNode: containerNode\n                };\n            },\n            \n            moveToBookmark: function(bookmark) {\n                var containerNode = bookmark.containerNode;\n                var charIndex = 0;\n                this.setStart(containerNode, 0);\n                this.collapse(true);\n                var nodeStack = [containerNode], node, foundStart = false, stop = false;\n                var nextCharIndex, i, childNodes;\n\n                while (!stop && (node = nodeStack.pop())) {\n                    if (node.nodeType == 3) {\n                        nextCharIndex = charIndex + node.length;\n                        if (!foundStart && bookmark.start >= charIndex && bookmark.start <= nextCharIndex) {\n                            this.setStart(node, bookmark.start - charIndex);\n                            foundStart = true;\n                        }\n                        if (foundStart && bookmark.end >= charIndex && bookmark.end <= nextCharIndex) {\n                            this.setEnd(node, bookmark.end - charIndex);\n                            stop = true;\n                        }\n                        charIndex = nextCharIndex;\n                    } else {\n                        childNodes = node.childNodes;\n                        i = childNodes.length;\n                        while (i--) {\n                            nodeStack.push(childNodes[i]);\n                        }\n                    }\n                }\n            },\n\n            getName: function() {\n                return \"DomRange\";\n            },\n\n            equals: function(range) {\n                return Range.rangesEqual(this, range);\n            },\n\n            isValid: function() {\n                return isRangeValid(this);\n            },\n            \n            inspect: function() {\n                return inspect(this);\n            },\n            \n            detach: function() {\n                // In DOM4, detach() is now a no-op.\n            }\n        });\n\n        function copyComparisonConstantsToObject(obj) {\n            obj.START_TO_START = s2s;\n            obj.START_TO_END = s2e;\n            obj.END_TO_END = e2e;\n            obj.END_TO_START = e2s;\n\n            obj.NODE_BEFORE = n_b;\n            obj.NODE_AFTER = n_a;\n            obj.NODE_BEFORE_AND_AFTER = n_b_a;\n            obj.NODE_INSIDE = n_i;\n        }\n\n        function copyComparisonConstants(constructor) {\n            copyComparisonConstantsToObject(constructor);\n            copyComparisonConstantsToObject(constructor.prototype);\n        }\n\n        function createRangeContentRemover(remover, boundaryUpdater) {\n            return function() {\n                assertRangeValid(this);\n\n                var sc = this.startContainer, so = this.startOffset, root = this.commonAncestorContainer;\n\n                var iterator = new RangeIterator(this, true);\n\n                // Work out where to position the range after content removal\n                var node, boundary;\n                if (sc !== root) {\n                    node = getClosestAncestorIn(sc, root, true);\n                    boundary = getBoundaryAfterNode(node);\n                    sc = boundary.node;\n                    so = boundary.offset;\n                }\n\n                // Check none of the range is read-only\n                iterateSubtree(iterator, assertNodeNotReadOnly);\n\n                iterator.reset();\n\n                // Remove the content\n                var returnValue = remover(iterator);\n                iterator.detach();\n\n                // Move to the new position\n                boundaryUpdater(this, sc, so, sc, so);\n\n                return returnValue;\n            };\n        }\n\n        function createPrototypeRange(constructor, boundaryUpdater) {\n            function createBeforeAfterNodeSetter(isBefore, isStart) {\n                return function(node) {\n                    assertValidNodeType(node, beforeAfterNodeTypes);\n                    assertValidNodeType(getRootContainer(node), rootContainerNodeTypes);\n\n                    var boundary = (isBefore ? getBoundaryBeforeNode : getBoundaryAfterNode)(node);\n                    (isStart ? setRangeStart : setRangeEnd)(this, boundary.node, boundary.offset);\n                };\n            }\n\n            function setRangeStart(range, node, offset) {\n                var ec = range.endContainer, eo = range.endOffset;\n                if (node !== range.startContainer || offset !== range.startOffset) {\n                    // Check the root containers of the range and the new boundary, and also check whether the new boundary\n                    // is after the current end. In either case, collapse the range to the new position\n                    if (getRootContainer(node) != getRootContainer(ec) || comparePoints(node, offset, ec, eo) == 1) {\n                        ec = node;\n                        eo = offset;\n                    }\n                    boundaryUpdater(range, node, offset, ec, eo);\n                }\n            }\n\n            function setRangeEnd(range, node, offset) {\n                var sc = range.startContainer, so = range.startOffset;\n                if (node !== range.endContainer || offset !== range.endOffset) {\n                    // Check the root containers of the range and the new boundary, and also check whether the new boundary\n                    // is after the current end. In either case, collapse the range to the new position\n                    if (getRootContainer(node) != getRootContainer(sc) || comparePoints(node, offset, sc, so) == -1) {\n                        sc = node;\n                        so = offset;\n                    }\n                    boundaryUpdater(range, sc, so, node, offset);\n                }\n            }\n\n            // Set up inheritance\n            var F = function() {};\n            F.prototype = api.rangePrototype;\n            constructor.prototype = new F();\n\n            util.extend(constructor.prototype, {\n                setStart: function(node, offset) {\n                    assertNoDocTypeNotationEntityAncestor(node, true);\n                    assertValidOffset(node, offset);\n\n                    setRangeStart(this, node, offset);\n                },\n\n                setEnd: function(node, offset) {\n                    assertNoDocTypeNotationEntityAncestor(node, true);\n                    assertValidOffset(node, offset);\n\n                    setRangeEnd(this, node, offset);\n                },\n\n                /**\n                 * Convenience method to set a range's start and end boundaries. Overloaded as follows:\n                 * - Two parameters (node, offset) creates a collapsed range at that position\n                 * - Three parameters (node, startOffset, endOffset) creates a range contained with node starting at\n                 *   startOffset and ending at endOffset\n                 * - Four parameters (startNode, startOffset, endNode, endOffset) creates a range starting at startOffset in\n                 *   startNode and ending at endOffset in endNode\n                 */\n                setStartAndEnd: function() {\n                    var args = arguments;\n                    var sc = args[0], so = args[1], ec = sc, eo = so;\n\n                    switch (args.length) {\n                        case 3:\n                            eo = args[2];\n                            break;\n                        case 4:\n                            ec = args[2];\n                            eo = args[3];\n                            break;\n                    }\n\n                    boundaryUpdater(this, sc, so, ec, eo);\n                },\n                \n                setBoundary: function(node, offset, isStart) {\n                    this[\"set\" + (isStart ? \"Start\" : \"End\")](node, offset);\n                },\n\n                setStartBefore: createBeforeAfterNodeSetter(true, true),\n                setStartAfter: createBeforeAfterNodeSetter(false, true),\n                setEndBefore: createBeforeAfterNodeSetter(true, false),\n                setEndAfter: createBeforeAfterNodeSetter(false, false),\n\n                collapse: function(isStart) {\n                    assertRangeValid(this);\n                    if (isStart) {\n                        boundaryUpdater(this, this.startContainer, this.startOffset, this.startContainer, this.startOffset);\n                    } else {\n                        boundaryUpdater(this, this.endContainer, this.endOffset, this.endContainer, this.endOffset);\n                    }\n                },\n\n                selectNodeContents: function(node) {\n                    assertNoDocTypeNotationEntityAncestor(node, true);\n\n                    boundaryUpdater(this, node, 0, node, getNodeLength(node));\n                },\n\n                selectNode: function(node) {\n                    assertNoDocTypeNotationEntityAncestor(node, false);\n                    assertValidNodeType(node, beforeAfterNodeTypes);\n\n                    var start = getBoundaryBeforeNode(node), end = getBoundaryAfterNode(node);\n                    boundaryUpdater(this, start.node, start.offset, end.node, end.offset);\n                },\n\n                extractContents: createRangeContentRemover(extractSubtree, boundaryUpdater),\n\n                deleteContents: createRangeContentRemover(deleteSubtree, boundaryUpdater),\n\n                canSurroundContents: function() {\n                    assertRangeValid(this);\n                    assertNodeNotReadOnly(this.startContainer);\n                    assertNodeNotReadOnly(this.endContainer);\n\n                    // Check if the contents can be surrounded. Specifically, this means whether the range partially selects\n                    // no non-text nodes.\n                    var iterator = new RangeIterator(this, true);\n                    var boundariesInvalid = (iterator._first && isNonTextPartiallySelected(iterator._first, this) ||\n                            (iterator._last && isNonTextPartiallySelected(iterator._last, this)));\n                    iterator.detach();\n                    return !boundariesInvalid;\n                },\n\n                splitBoundaries: function() {\n                    splitRangeBoundaries(this);\n                },\n\n                splitBoundariesPreservingPositions: function(positionsToPreserve) {\n                    splitRangeBoundaries(this, positionsToPreserve);\n                },\n\n                normalizeBoundaries: function() {\n                    assertRangeValid(this);\n\n                    var sc = this.startContainer, so = this.startOffset, ec = this.endContainer, eo = this.endOffset;\n\n                    var mergeForward = function(node) {\n                        var sibling = node.nextSibling;\n                        if (sibling && sibling.nodeType == node.nodeType) {\n                            ec = node;\n                            eo = node.length;\n                            node.appendData(sibling.data);\n                            sibling.parentNode.removeChild(sibling);\n                        }\n                    };\n\n                    var mergeBackward = function(node) {\n                        var sibling = node.previousSibling;\n                        if (sibling && sibling.nodeType == node.nodeType) {\n                            sc = node;\n                            var nodeLength = node.length;\n                            so = sibling.length;\n                            node.insertData(0, sibling.data);\n                            sibling.parentNode.removeChild(sibling);\n                            if (sc == ec) {\n                                eo += so;\n                                ec = sc;\n                            } else if (ec == node.parentNode) {\n                                var nodeIndex = getNodeIndex(node);\n                                if (eo == nodeIndex) {\n                                    ec = node;\n                                    eo = nodeLength;\n                                } else if (eo > nodeIndex) {\n                                    eo--;\n                                }\n                            }\n                        }\n                    };\n\n                    var normalizeStart = true;\n\n                    if (isCharacterDataNode(ec)) {\n                        if (ec.length == eo) {\n                            mergeForward(ec);\n                        }\n                    } else {\n                        if (eo > 0) {\n                            var endNode = ec.childNodes[eo - 1];\n                            if (endNode && isCharacterDataNode(endNode)) {\n                                mergeForward(endNode);\n                            }\n                        }\n                        normalizeStart = !this.collapsed;\n                    }\n\n                    if (normalizeStart) {\n                        if (isCharacterDataNode(sc)) {\n                            if (so == 0) {\n                                mergeBackward(sc);\n                            }\n                        } else {\n                            if (so < sc.childNodes.length) {\n                                var startNode = sc.childNodes[so];\n                                if (startNode && isCharacterDataNode(startNode)) {\n                                    mergeBackward(startNode);\n                                }\n                            }\n                        }\n                    } else {\n                        sc = ec;\n                        so = eo;\n                    }\n\n                    boundaryUpdater(this, sc, so, ec, eo);\n                },\n\n                collapseToPoint: function(node, offset) {\n                    assertNoDocTypeNotationEntityAncestor(node, true);\n                    assertValidOffset(node, offset);\n                    this.setStartAndEnd(node, offset);\n                }\n            });\n\n            copyComparisonConstants(constructor);\n        }\n\n        /*----------------------------------------------------------------------------------------------------------------*/\n\n        // Updates commonAncestorContainer and collapsed after boundary change\n        function updateCollapsedAndCommonAncestor(range) {\n            range.collapsed = (range.startContainer === range.endContainer && range.startOffset === range.endOffset);\n            range.commonAncestorContainer = range.collapsed ?\n                range.startContainer : dom.getCommonAncestor(range.startContainer, range.endContainer);\n        }\n\n        function updateBoundaries(range, startContainer, startOffset, endContainer, endOffset) {\n            range.startContainer = startContainer;\n            range.startOffset = startOffset;\n            range.endContainer = endContainer;\n            range.endOffset = endOffset;\n            range.document = dom.getDocument(startContainer);\n\n            updateCollapsedAndCommonAncestor(range);\n        }\n\n        function Range(doc) {\n            this.startContainer = doc;\n            this.startOffset = 0;\n            this.endContainer = doc;\n            this.endOffset = 0;\n            this.document = doc;\n            updateCollapsedAndCommonAncestor(this);\n        }\n\n        createPrototypeRange(Range, updateBoundaries);\n\n        util.extend(Range, {\n            rangeProperties: rangeProperties,\n            RangeIterator: RangeIterator,\n            copyComparisonConstants: copyComparisonConstants,\n            createPrototypeRange: createPrototypeRange,\n            inspect: inspect,\n            toHtml: rangeToHtml,\n            getRangeDocument: getRangeDocument,\n            rangesEqual: function(r1, r2) {\n                return r1.startContainer === r2.startContainer &&\n                    r1.startOffset === r2.startOffset &&\n                    r1.endContainer === r2.endContainer &&\n                    r1.endOffset === r2.endOffset;\n            }\n        });\n\n        api.DomRange = Range;\n    });\n\n    /*----------------------------------------------------------------------------------------------------------------*/\n\n    // Wrappers for the browser's native DOM Range and/or TextRange implementation \n    api.createCoreModule(\"WrappedRange\", [\"DomRange\"], function(api, module) {\n        var WrappedRange, WrappedTextRange;\n        var dom = api.dom;\n        var util = api.util;\n        var DomPosition = dom.DomPosition;\n        var DomRange = api.DomRange;\n        var getBody = dom.getBody;\n        var getContentDocument = dom.getContentDocument;\n        var isCharacterDataNode = dom.isCharacterDataNode;\n\n\n        /*----------------------------------------------------------------------------------------------------------------*/\n\n        if (api.features.implementsDomRange) {\n            // This is a wrapper around the browser's native DOM Range. It has two aims:\n            // - Provide workarounds for specific browser bugs\n            // - provide convenient extensions, which are inherited from Rangy's DomRange\n\n            (function() {\n                var rangeProto;\n                var rangeProperties = DomRange.rangeProperties;\n\n                function updateRangeProperties(range) {\n                    var i = rangeProperties.length, prop;\n                    while (i--) {\n                        prop = rangeProperties[i];\n                        range[prop] = range.nativeRange[prop];\n                    }\n                    // Fix for broken collapsed property in IE 9.\n                    range.collapsed = (range.startContainer === range.endContainer && range.startOffset === range.endOffset);\n                }\n\n                function updateNativeRange(range, startContainer, startOffset, endContainer, endOffset) {\n                    var startMoved = (range.startContainer !== startContainer || range.startOffset != startOffset);\n                    var endMoved = (range.endContainer !== endContainer || range.endOffset != endOffset);\n                    var nativeRangeDifferent = !range.equals(range.nativeRange);\n\n                    // Always set both boundaries for the benefit of IE9 (see issue 35)\n                    if (startMoved || endMoved || nativeRangeDifferent) {\n                        range.setEnd(endContainer, endOffset);\n                        range.setStart(startContainer, startOffset);\n                    }\n                }\n\n                var createBeforeAfterNodeSetter;\n\n                WrappedRange = function(range) {\n                    if (!range) {\n                        throw module.createError(\"WrappedRange: Range must be specified\");\n                    }\n                    this.nativeRange = range;\n                    updateRangeProperties(this);\n                };\n\n                DomRange.createPrototypeRange(WrappedRange, updateNativeRange);\n\n                rangeProto = WrappedRange.prototype;\n\n                rangeProto.selectNode = function(node) {\n                    this.nativeRange.selectNode(node);\n                    updateRangeProperties(this);\n                };\n\n                rangeProto.cloneContents = function() {\n                    return this.nativeRange.cloneContents();\n                };\n\n                // Due to a long-standing Firefox bug that I have not been able to find a reliable way to detect,\n                // insertNode() is never delegated to the native range.\n\n                rangeProto.surroundContents = function(node) {\n                    this.nativeRange.surroundContents(node);\n                    updateRangeProperties(this);\n                };\n\n                rangeProto.collapse = function(isStart) {\n                    this.nativeRange.collapse(isStart);\n                    updateRangeProperties(this);\n                };\n\n                rangeProto.cloneRange = function() {\n                    return new WrappedRange(this.nativeRange.cloneRange());\n                };\n\n                rangeProto.refresh = function() {\n                    updateRangeProperties(this);\n                };\n\n                rangeProto.toString = function() {\n                    return this.nativeRange.toString();\n                };\n\n                // Create test range and node for feature detection\n\n                var testTextNode = document.createTextNode(\"test\");\n                getBody(document).appendChild(testTextNode);\n                var range = document.createRange();\n\n                /*--------------------------------------------------------------------------------------------------------*/\n\n                // Test for Firefox 2 bug that prevents moving the start of a Range to a point after its current end and\n                // correct for it\n\n                range.setStart(testTextNode, 0);\n                range.setEnd(testTextNode, 0);\n\n                try {\n                    range.setStart(testTextNode, 1);\n\n                    rangeProto.setStart = function(node, offset) {\n                        this.nativeRange.setStart(node, offset);\n                        updateRangeProperties(this);\n                    };\n\n                    rangeProto.setEnd = function(node, offset) {\n                        this.nativeRange.setEnd(node, offset);\n                        updateRangeProperties(this);\n                    };\n\n                    createBeforeAfterNodeSetter = function(name) {\n                        return function(node) {\n                            this.nativeRange[name](node);\n                            updateRangeProperties(this);\n                        };\n                    };\n\n                } catch(ex) {\n\n                    rangeProto.setStart = function(node, offset) {\n                        try {\n                            this.nativeRange.setStart(node, offset);\n                        } catch (ex) {\n                            this.nativeRange.setEnd(node, offset);\n                            this.nativeRange.setStart(node, offset);\n                        }\n                        updateRangeProperties(this);\n                    };\n\n                    rangeProto.setEnd = function(node, offset) {\n                        try {\n                            this.nativeRange.setEnd(node, offset);\n                        } catch (ex) {\n                            this.nativeRange.setStart(node, offset);\n                            this.nativeRange.setEnd(node, offset);\n                        }\n                        updateRangeProperties(this);\n                    };\n\n                    createBeforeAfterNodeSetter = function(name, oppositeName) {\n                        return function(node) {\n                            try {\n                                this.nativeRange[name](node);\n                            } catch (ex) {\n                                this.nativeRange[oppositeName](node);\n                                this.nativeRange[name](node);\n                            }\n                            updateRangeProperties(this);\n                        };\n                    };\n                }\n\n                rangeProto.setStartBefore = createBeforeAfterNodeSetter(\"setStartBefore\", \"setEndBefore\");\n                rangeProto.setStartAfter = createBeforeAfterNodeSetter(\"setStartAfter\", \"setEndAfter\");\n                rangeProto.setEndBefore = createBeforeAfterNodeSetter(\"setEndBefore\", \"setStartBefore\");\n                rangeProto.setEndAfter = createBeforeAfterNodeSetter(\"setEndAfter\", \"setStartAfter\");\n\n                /*--------------------------------------------------------------------------------------------------------*/\n\n                // Always use DOM4-compliant selectNodeContents implementation: it's simpler and less code than testing\n                // whether the native implementation can be trusted\n                rangeProto.selectNodeContents = function(node) {\n                    this.setStartAndEnd(node, 0, dom.getNodeLength(node));\n                };\n\n                /*--------------------------------------------------------------------------------------------------------*/\n\n                // Test for and correct WebKit bug that has the behaviour of compareBoundaryPoints round the wrong way for\n                // constants START_TO_END and END_TO_START: https://bugs.webkit.org/show_bug.cgi?id=20738\n\n                range.selectNodeContents(testTextNode);\n                range.setEnd(testTextNode, 3);\n\n                var range2 = document.createRange();\n                range2.selectNodeContents(testTextNode);\n                range2.setEnd(testTextNode, 4);\n                range2.setStart(testTextNode, 2);\n\n                if (range.compareBoundaryPoints(range.START_TO_END, range2) == -1 &&\n                        range.compareBoundaryPoints(range.END_TO_START, range2) == 1) {\n                    // This is the wrong way round, so correct for it\n\n                    rangeProto.compareBoundaryPoints = function(type, range) {\n                        range = range.nativeRange || range;\n                        if (type == range.START_TO_END) {\n                            type = range.END_TO_START;\n                        } else if (type == range.END_TO_START) {\n                            type = range.START_TO_END;\n                        }\n                        return this.nativeRange.compareBoundaryPoints(type, range);\n                    };\n                } else {\n                    rangeProto.compareBoundaryPoints = function(type, range) {\n                        return this.nativeRange.compareBoundaryPoints(type, range.nativeRange || range);\n                    };\n                }\n\n                /*--------------------------------------------------------------------------------------------------------*/\n\n                // Test for IE 9 deleteContents() and extractContents() bug and correct it. See issue 107.\n\n                var el = document.createElement(\"div\");\n                el.innerHTML = \"123\";\n                var textNode = el.firstChild;\n                var body = getBody(document);\n                body.appendChild(el);\n\n                range.setStart(textNode, 1);\n                range.setEnd(textNode, 2);\n                range.deleteContents();\n\n                if (textNode.data == \"13\") {\n                    // Behaviour is correct per DOM4 Range so wrap the browser's implementation of deleteContents() and\n                    // extractContents()\n                    rangeProto.deleteContents = function() {\n                        this.nativeRange.deleteContents();\n                        updateRangeProperties(this);\n                    };\n\n                    rangeProto.extractContents = function() {\n                        var frag = this.nativeRange.extractContents();\n                        updateRangeProperties(this);\n                        return frag;\n                    };\n                } else {\n                }\n\n                body.removeChild(el);\n                body = null;\n\n                /*--------------------------------------------------------------------------------------------------------*/\n\n                // Test for existence of createContextualFragment and delegate to it if it exists\n                if (util.isHostMethod(range, \"createContextualFragment\")) {\n                    rangeProto.createContextualFragment = function(fragmentStr) {\n                        return this.nativeRange.createContextualFragment(fragmentStr);\n                    };\n                }\n\n                /*--------------------------------------------------------------------------------------------------------*/\n\n                // Clean up\n                getBody(document).removeChild(testTextNode);\n\n                rangeProto.getName = function() {\n                    return \"WrappedRange\";\n                };\n\n                api.WrappedRange = WrappedRange;\n\n                api.createNativeRange = function(doc) {\n                    doc = getContentDocument(doc, module, \"createNativeRange\");\n                    return doc.createRange();\n                };\n            })();\n        }\n        \n        if (api.features.implementsTextRange) {\n            /*\n            This is a workaround for a bug where IE returns the wrong container element from the TextRange's parentElement()\n            method. For example, in the following (where pipes denote the selection boundaries):\n\n            <ul id=\"ul\"><li id=\"a\">| a </li><li id=\"b\"> b |</li></ul>\n\n            var range = document.selection.createRange();\n            alert(range.parentElement().id); // Should alert \"ul\" but alerts \"b\"\n\n            This method returns the common ancestor node of the following:\n            - the parentElement() of the textRange\n            - the parentElement() of the textRange after calling collapse(true)\n            - the parentElement() of the textRange after calling collapse(false)\n            */\n            var getTextRangeContainerElement = function(textRange) {\n                var parentEl = textRange.parentElement();\n                var range = textRange.duplicate();\n                range.collapse(true);\n                var startEl = range.parentElement();\n                range = textRange.duplicate();\n                range.collapse(false);\n                var endEl = range.parentElement();\n                var startEndContainer = (startEl == endEl) ? startEl : dom.getCommonAncestor(startEl, endEl);\n\n                return startEndContainer == parentEl ? startEndContainer : dom.getCommonAncestor(parentEl, startEndContainer);\n            };\n\n            var textRangeIsCollapsed = function(textRange) {\n                return textRange.compareEndPoints(\"StartToEnd\", textRange) == 0;\n            };\n\n            // Gets the boundary of a TextRange expressed as a node and an offset within that node. This function started\n            // out as an improved version of code found in Tim Cameron Ryan's IERange (http://code.google.com/p/ierange/)\n            // but has grown, fixing problems with line breaks in preformatted text, adding workaround for IE TextRange\n            // bugs, handling for inputs and images, plus optimizations.\n            var getTextRangeBoundaryPosition = function(textRange, wholeRangeContainerElement, isStart, isCollapsed, startInfo) {\n                var workingRange = textRange.duplicate();\n                workingRange.collapse(isStart);\n                var containerElement = workingRange.parentElement();\n\n                // Sometimes collapsing a TextRange that's at the start of a text node can move it into the previous node, so\n                // check for that\n                if (!dom.isOrIsAncestorOf(wholeRangeContainerElement, containerElement)) {\n                    containerElement = wholeRangeContainerElement;\n                }\n\n\n                // Deal with nodes that cannot \"contain rich HTML markup\". In practice, this means form inputs, images and\n                // similar. See http://msdn.microsoft.com/en-us/library/aa703950%28VS.85%29.aspx\n                if (!containerElement.canHaveHTML) {\n                    var pos = new DomPosition(containerElement.parentNode, dom.getNodeIndex(containerElement));\n                    return {\n                        boundaryPosition: pos,\n                        nodeInfo: {\n                            nodeIndex: pos.offset,\n                            containerElement: pos.node\n                        }\n                    };\n                }\n\n                var workingNode = dom.getDocument(containerElement).createElement(\"span\");\n\n                // Workaround for HTML5 Shiv's insane violation of document.createElement(). See Rangy issue 104 and HTML5\n                // Shiv issue 64: https://github.com/aFarkas/html5shiv/issues/64\n                if (workingNode.parentNode) {\n                    workingNode.parentNode.removeChild(workingNode);\n                }\n\n                var comparison, workingComparisonType = isStart ? \"StartToStart\" : \"StartToEnd\";\n                var previousNode, nextNode, boundaryPosition, boundaryNode;\n                var start = (startInfo && startInfo.containerElement == containerElement) ? startInfo.nodeIndex : 0;\n                var childNodeCount = containerElement.childNodes.length;\n                var end = childNodeCount;\n\n                // Check end first. Code within the loop assumes that the endth child node of the container is definitely\n                // after the range boundary.\n                var nodeIndex = end;\n\n                while (true) {\n                    if (nodeIndex == childNodeCount) {\n                        containerElement.appendChild(workingNode);\n                    } else {\n                        containerElement.insertBefore(workingNode, containerElement.childNodes[nodeIndex]);\n                    }\n                    workingRange.moveToElementText(workingNode);\n                    comparison = workingRange.compareEndPoints(workingComparisonType, textRange);\n                    if (comparison == 0 || start == end) {\n                        break;\n                    } else if (comparison == -1) {\n                        if (end == start + 1) {\n                            // We know the endth child node is after the range boundary, so we must be done.\n                            break;\n                        } else {\n                            start = nodeIndex;\n                        }\n                    } else {\n                        end = (end == start + 1) ? start : nodeIndex;\n                    }\n                    nodeIndex = Math.floor((start + end) / 2);\n                    containerElement.removeChild(workingNode);\n                }\n\n\n                // We've now reached or gone past the boundary of the text range we're interested in\n                // so have identified the node we want\n                boundaryNode = workingNode.nextSibling;\n\n                if (comparison == -1 && boundaryNode && isCharacterDataNode(boundaryNode)) {\n                    // This is a character data node (text, comment, cdata). The working range is collapsed at the start of\n                    // the node containing the text range's boundary, so we move the end of the working range to the\n                    // boundary point and measure the length of its text to get the boundary's offset within the node.\n                    workingRange.setEndPoint(isStart ? \"EndToStart\" : \"EndToEnd\", textRange);\n\n                    var offset;\n\n                    if (/[\\r\\n]/.test(boundaryNode.data)) {\n                        /*\n                        For the particular case of a boundary within a text node containing rendered line breaks (within a\n                        <pre> element, for example), we need a slightly complicated approach to get the boundary's offset in\n                        IE. The facts:\n                        \n                        - Each line break is represented as \\r in the text node's data/nodeValue properties\n                        - Each line break is represented as \\r\\n in the TextRange's 'text' property\n                        - The 'text' property of the TextRange does not contain trailing line breaks\n                        \n                        To get round the problem presented by the final fact above, we can use the fact that TextRange's\n                        moveStart() and moveEnd() methods return the actual number of characters moved, which is not\n                        necessarily the same as the number of characters it was instructed to move. The simplest approach is\n                        to use this to store the characters moved when moving both the start and end of the range to the\n                        start of the document body and subtracting the start offset from the end offset (the\n                        \"move-negative-gazillion\" method). However, this is extremely slow when the document is large and\n                        the range is near the end of it. Clearly doing the mirror image (i.e. moving the range boundaries to\n                        the end of the document) has the same problem.\n                        \n                        Another approach that works is to use moveStart() to move the start boundary of the range up to the\n                        end boundary one character at a time and incrementing a counter with the value returned by the\n                        moveStart() call. However, the check for whether the start boundary has reached the end boundary is\n                        expensive, so this method is slow (although unlike \"move-negative-gazillion\" is largely unaffected\n                        by the location of the range within the document).\n                        \n                        The approach used below is a hybrid of the two methods above. It uses the fact that a string\n                        containing the TextRange's 'text' property with each \\r\\n converted to a single \\r character cannot\n                        be longer than the text of the TextRange, so the start of the range is moved that length initially\n                        and then a character at a time to make up for any trailing line breaks not contained in the 'text'\n                        property. This has good performance in most situations compared to the previous two methods.\n                        */\n                        var tempRange = workingRange.duplicate();\n                        var rangeLength = tempRange.text.replace(/\\r\\n/g, \"\\r\").length;\n\n                        offset = tempRange.moveStart(\"character\", rangeLength);\n                        while ( (comparison = tempRange.compareEndPoints(\"StartToEnd\", tempRange)) == -1) {\n                            offset++;\n                            tempRange.moveStart(\"character\", 1);\n                        }\n                    } else {\n                        offset = workingRange.text.length;\n                    }\n                    boundaryPosition = new DomPosition(boundaryNode, offset);\n                } else {\n\n                    // If the boundary immediately follows a character data node and this is the end boundary, we should favour\n                    // a position within that, and likewise for a start boundary preceding a character data node\n                    previousNode = (isCollapsed || !isStart) && workingNode.previousSibling;\n                    nextNode = (isCollapsed || isStart) && workingNode.nextSibling;\n                    if (nextNode && isCharacterDataNode(nextNode)) {\n                        boundaryPosition = new DomPosition(nextNode, 0);\n                    } else if (previousNode && isCharacterDataNode(previousNode)) {\n                        boundaryPosition = new DomPosition(previousNode, previousNode.data.length);\n                    } else {\n                        boundaryPosition = new DomPosition(containerElement, dom.getNodeIndex(workingNode));\n                    }\n                }\n\n                // Clean up\n                workingNode.parentNode.removeChild(workingNode);\n\n                return {\n                    boundaryPosition: boundaryPosition,\n                    nodeInfo: {\n                        nodeIndex: nodeIndex,\n                        containerElement: containerElement\n                    }\n                };\n            };\n\n            // Returns a TextRange representing the boundary of a TextRange expressed as a node and an offset within that\n            // node. This function started out as an optimized version of code found in Tim Cameron Ryan's IERange\n            // (http://code.google.com/p/ierange/)\n            var createBoundaryTextRange = function(boundaryPosition, isStart) {\n                var boundaryNode, boundaryParent, boundaryOffset = boundaryPosition.offset;\n                var doc = dom.getDocument(boundaryPosition.node);\n                var workingNode, childNodes, workingRange = getBody(doc).createTextRange();\n                var nodeIsDataNode = isCharacterDataNode(boundaryPosition.node);\n\n                if (nodeIsDataNode) {\n                    boundaryNode = boundaryPosition.node;\n                    boundaryParent = boundaryNode.parentNode;\n                } else {\n                    childNodes = boundaryPosition.node.childNodes;\n                    boundaryNode = (boundaryOffset < childNodes.length) ? childNodes[boundaryOffset] : null;\n                    boundaryParent = boundaryPosition.node;\n                }\n\n                // Position the range immediately before the node containing the boundary\n                workingNode = doc.createElement(\"span\");\n\n                // Making the working element non-empty element persuades IE to consider the TextRange boundary to be within\n                // the element rather than immediately before or after it\n                workingNode.innerHTML = \"&#feff;\";\n\n                // insertBefore is supposed to work like appendChild if the second parameter is null. However, a bug report\n                // for IERange suggests that it can crash the browser: http://code.google.com/p/ierange/issues/detail?id=12\n                if (boundaryNode) {\n                    boundaryParent.insertBefore(workingNode, boundaryNode);\n                } else {\n                    boundaryParent.appendChild(workingNode);\n                }\n\n                workingRange.moveToElementText(workingNode);\n                workingRange.collapse(!isStart);\n\n                // Clean up\n                boundaryParent.removeChild(workingNode);\n\n                // Move the working range to the text offset, if required\n                if (nodeIsDataNode) {\n                    workingRange[isStart ? \"moveStart\" : \"moveEnd\"](\"character\", boundaryOffset);\n                }\n\n                return workingRange;\n            };\n\n            /*------------------------------------------------------------------------------------------------------------*/\n\n            // This is a wrapper around a TextRange, providing full DOM Range functionality using rangy's DomRange as a\n            // prototype\n\n            WrappedTextRange = function(textRange) {\n                this.textRange = textRange;\n                this.refresh();\n            };\n\n            WrappedTextRange.prototype = new DomRange(document);\n\n            WrappedTextRange.prototype.refresh = function() {\n                var start, end, startBoundary;\n\n                // TextRange's parentElement() method cannot be trusted. getTextRangeContainerElement() works around that.\n                var rangeContainerElement = getTextRangeContainerElement(this.textRange);\n\n                if (textRangeIsCollapsed(this.textRange)) {\n                    end = start = getTextRangeBoundaryPosition(this.textRange, rangeContainerElement, true,\n                        true).boundaryPosition;\n                } else {\n                    startBoundary = getTextRangeBoundaryPosition(this.textRange, rangeContainerElement, true, false);\n                    start = startBoundary.boundaryPosition;\n\n                    // An optimization used here is that if the start and end boundaries have the same parent element, the\n                    // search scope for the end boundary can be limited to exclude the portion of the element that precedes\n                    // the start boundary\n                    end = getTextRangeBoundaryPosition(this.textRange, rangeContainerElement, false, false,\n                        startBoundary.nodeInfo).boundaryPosition;\n                }\n\n                this.setStart(start.node, start.offset);\n                this.setEnd(end.node, end.offset);\n            };\n\n            WrappedTextRange.prototype.getName = function() {\n                return \"WrappedTextRange\";\n            };\n\n            DomRange.copyComparisonConstants(WrappedTextRange);\n\n            var rangeToTextRange = function(range) {\n                if (range.collapsed) {\n                    return createBoundaryTextRange(new DomPosition(range.startContainer, range.startOffset), true);\n                } else {\n                    var startRange = createBoundaryTextRange(new DomPosition(range.startContainer, range.startOffset), true);\n                    var endRange = createBoundaryTextRange(new DomPosition(range.endContainer, range.endOffset), false);\n                    var textRange = getBody( DomRange.getRangeDocument(range) ).createTextRange();\n                    textRange.setEndPoint(\"StartToStart\", startRange);\n                    textRange.setEndPoint(\"EndToEnd\", endRange);\n                    return textRange;\n                }\n            };\n\n            WrappedTextRange.rangeToTextRange = rangeToTextRange;\n\n            WrappedTextRange.prototype.toTextRange = function() {\n                return rangeToTextRange(this);\n            };\n\n            api.WrappedTextRange = WrappedTextRange;\n\n            // IE 9 and above have both implementations and Rangy makes both available. The next few lines sets which\n            // implementation to use by default.\n            if (!api.features.implementsDomRange || api.config.preferTextRange) {\n                // Add WrappedTextRange as the Range property of the global object to allow expression like Range.END_TO_END to work\n                var globalObj = (function() { return this; })();\n                if (typeof globalObj.Range == \"undefined\") {\n                    globalObj.Range = WrappedTextRange;\n                }\n\n                api.createNativeRange = function(doc) {\n                    doc = getContentDocument(doc, module, \"createNativeRange\");\n                    return getBody(doc).createTextRange();\n                };\n\n                api.WrappedRange = WrappedTextRange;\n            }\n        }\n\n        api.createRange = function(doc) {\n            doc = getContentDocument(doc, module, \"createRange\");\n            return new api.WrappedRange(api.createNativeRange(doc));\n        };\n\n        api.createRangyRange = function(doc) {\n            doc = getContentDocument(doc, module, \"createRangyRange\");\n            return new DomRange(doc);\n        };\n\n        api.createIframeRange = function(iframeEl) {\n            module.deprecationNotice(\"createIframeRange()\", \"createRange(iframeEl)\");\n            return api.createRange(iframeEl);\n        };\n\n        api.createIframeRangyRange = function(iframeEl) {\n            module.deprecationNotice(\"createIframeRangyRange()\", \"createRangyRange(iframeEl)\");\n            return api.createRangyRange(iframeEl);\n        };\n\n        api.addShimListener(function(win) {\n            var doc = win.document;\n            if (typeof doc.createRange == \"undefined\") {\n                doc.createRange = function() {\n                    return api.createRange(doc);\n                };\n            }\n            doc = win = null;\n        });\n    });\n\n    /*----------------------------------------------------------------------------------------------------------------*/\n\n    // This module creates a selection object wrapper that conforms as closely as possible to the Selection specification\n    // in the HTML Editing spec (http://dvcs.w3.org/hg/editing/raw-file/tip/editing.html#selections)\n    api.createCoreModule(\"WrappedSelection\", [\"DomRange\", \"WrappedRange\"], function(api, module) {\n        api.config.checkSelectionRanges = true;\n\n        var BOOLEAN = \"boolean\";\n        var NUMBER = \"number\";\n        var dom = api.dom;\n        var util = api.util;\n        var isHostMethod = util.isHostMethod;\n        var DomRange = api.DomRange;\n        var WrappedRange = api.WrappedRange;\n        var DOMException = api.DOMException;\n        var DomPosition = dom.DomPosition;\n        var getNativeSelection;\n        var selectionIsCollapsed;\n        var features = api.features;\n        var CONTROL = \"Control\";\n        var getDocument = dom.getDocument;\n        var getBody = dom.getBody;\n        var rangesEqual = DomRange.rangesEqual;\n\n\n        // Utility function to support direction parameters in the API that may be a string (\"backward\" or \"forward\") or a\n        // Boolean (true for backwards).\n        function isDirectionBackward(dir) {\n            return (typeof dir == \"string\") ? /^backward(s)?$/i.test(dir) : !!dir;\n        }\n\n        function getWindow(win, methodName) {\n            if (!win) {\n                return window;\n            } else if (dom.isWindow(win)) {\n                return win;\n            } else if (win instanceof WrappedSelection) {\n                return win.win;\n            } else {\n                var doc = dom.getContentDocument(win, module, methodName);\n                return dom.getWindow(doc);\n            }\n        }\n\n        function getWinSelection(winParam) {\n            return getWindow(winParam, \"getWinSelection\").getSelection();\n        }\n\n        function getDocSelection(winParam) {\n            return getWindow(winParam, \"getDocSelection\").document.selection;\n        }\n        \n        function winSelectionIsBackward(sel) {\n            var backward = false;\n            if (sel.anchorNode) {\n                backward = (dom.comparePoints(sel.anchorNode, sel.anchorOffset, sel.focusNode, sel.focusOffset) == 1);\n            }\n            return backward;\n        }\n\n        // Test for the Range/TextRange and Selection features required\n        // Test for ability to retrieve selection\n        var implementsWinGetSelection = isHostMethod(window, \"getSelection\"),\n            implementsDocSelection = util.isHostObject(document, \"selection\");\n\n        features.implementsWinGetSelection = implementsWinGetSelection;\n        features.implementsDocSelection = implementsDocSelection;\n\n        var useDocumentSelection = implementsDocSelection && (!implementsWinGetSelection || api.config.preferTextRange);\n\n        if (useDocumentSelection) {\n            getNativeSelection = getDocSelection;\n            api.isSelectionValid = function(winParam) {\n                var doc = getWindow(winParam, \"isSelectionValid\").document, nativeSel = doc.selection;\n\n                // Check whether the selection TextRange is actually contained within the correct document\n                return (nativeSel.type != \"None\" || getDocument(nativeSel.createRange().parentElement()) == doc);\n            };\n        } else if (implementsWinGetSelection) {\n            getNativeSelection = getWinSelection;\n            api.isSelectionValid = function() {\n                return true;\n            };\n        } else {\n            module.fail(\"Neither document.selection or window.getSelection() detected.\");\n        }\n\n        api.getNativeSelection = getNativeSelection;\n\n        var testSelection = getNativeSelection();\n        var testRange = api.createNativeRange(document);\n        var body = getBody(document);\n\n        // Obtaining a range from a selection\n        var selectionHasAnchorAndFocus = util.areHostProperties(testSelection,\n            [\"anchorNode\", \"focusNode\", \"anchorOffset\", \"focusOffset\"]);\n\n        features.selectionHasAnchorAndFocus = selectionHasAnchorAndFocus;\n\n        // Test for existence of native selection extend() method\n        var selectionHasExtend = isHostMethod(testSelection, \"extend\");\n        features.selectionHasExtend = selectionHasExtend;\n        \n        // Test if rangeCount exists\n        var selectionHasRangeCount = (typeof testSelection.rangeCount == NUMBER);\n        features.selectionHasRangeCount = selectionHasRangeCount;\n\n        var selectionSupportsMultipleRanges = false;\n        var collapsedNonEditableSelectionsSupported = true;\n\n        var addRangeBackwardToNative = selectionHasExtend ?\n            function(nativeSelection, range) {\n                var doc = DomRange.getRangeDocument(range);\n                var endRange = api.createRange(doc);\n                endRange.collapseToPoint(range.endContainer, range.endOffset);\n                nativeSelection.addRange(getNativeRange(endRange));\n                nativeSelection.extend(range.startContainer, range.startOffset);\n            } : null;\n\n        if (util.areHostMethods(testSelection, [\"addRange\", \"getRangeAt\", \"removeAllRanges\"]) &&\n                typeof testSelection.rangeCount == NUMBER && features.implementsDomRange) {\n\n            (function() {\n                // Previously an iframe was used but this caused problems in some circumstances in IE, so tests are\n                // performed on the current document's selection. See issue 109.\n\n                // Note also that if a selection previously existed, it is wiped by these tests. This should usually be fine\n                // because initialization usually happens when the document loads, but could be a problem for a script that\n                // loads and initializes Rangy later. If anyone complains, code could be added to save and restore the\n                // selection.\n                var sel = window.getSelection();\n                if (sel) {\n                    // Store the current selection\n                    var originalSelectionRangeCount = sel.rangeCount;\n                    var selectionHasMultipleRanges = (originalSelectionRangeCount > 1);\n                    var originalSelectionRanges = [];\n                    var originalSelectionBackward = winSelectionIsBackward(sel); \n                    for (var i = 0; i < originalSelectionRangeCount; ++i) {\n                        originalSelectionRanges[i] = sel.getRangeAt(i);\n                    }\n                    \n                    // Create some test elements\n                    var body = getBody(document);\n                    var testEl = body.appendChild( document.createElement(\"div\") );\n                    testEl.contentEditable = \"false\";\n                    var textNode = testEl.appendChild( document.createTextNode(\"\\u00a0\\u00a0\\u00a0\") );\n\n                    // Test whether the native selection will allow a collapsed selection within a non-editable element\n                    var r1 = document.createRange();\n\n                    r1.setStart(textNode, 1);\n                    r1.collapse(true);\n                    sel.addRange(r1);\n                    collapsedNonEditableSelectionsSupported = (sel.rangeCount == 1);\n                    sel.removeAllRanges();\n\n                    // Test whether the native selection is capable of supporting multiple ranges.\n                    if (!selectionHasMultipleRanges) {\n                        // Doing the original feature test here in Chrome 36 (and presumably later versions) prints a\n                        // console error of \"Discontiguous selection is not supported.\" that cannot be suppressed. There's\n                        // nothing we can do about this while retaining the feature test so we have to resort to a browser\n                        // sniff. I'm not happy about it. See\n                        // https://code.google.com/p/chromium/issues/detail?id=399791\n                        var chromeMatch = window.navigator.appVersion.match(/Chrome\\/(.*?) /);\n                        if (chromeMatch && parseInt(chromeMatch[1]) >= 36) {\n                            selectionSupportsMultipleRanges = false;\n                        } else {\n                            var r2 = r1.cloneRange();\n                            r1.setStart(textNode, 0);\n                            r2.setEnd(textNode, 3);\n                            r2.setStart(textNode, 2);\n                            sel.addRange(r1);\n                            sel.addRange(r2);\n                            selectionSupportsMultipleRanges = (sel.rangeCount == 2);\n                        }\n                    }\n\n                    // Clean up\n                    body.removeChild(testEl);\n                    sel.removeAllRanges();\n\n                    for (i = 0; i < originalSelectionRangeCount; ++i) {\n                        if (i == 0 && originalSelectionBackward) {\n                            if (addRangeBackwardToNative) {\n                                addRangeBackwardToNative(sel, originalSelectionRanges[i]);\n                            } else {\n                                api.warn(\"Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend\");\n                                sel.addRange(originalSelectionRanges[i]);\n                            }\n                        } else {\n                            sel.addRange(originalSelectionRanges[i]);\n                        }\n                    }\n                }\n            })();\n        }\n\n        features.selectionSupportsMultipleRanges = selectionSupportsMultipleRanges;\n        features.collapsedNonEditableSelectionsSupported = collapsedNonEditableSelectionsSupported;\n\n        // ControlRanges\n        var implementsControlRange = false, testControlRange;\n\n        if (body && isHostMethod(body, \"createControlRange\")) {\n            testControlRange = body.createControlRange();\n            if (util.areHostProperties(testControlRange, [\"item\", \"add\"])) {\n                implementsControlRange = true;\n            }\n        }\n        features.implementsControlRange = implementsControlRange;\n\n        // Selection collapsedness\n        if (selectionHasAnchorAndFocus) {\n            selectionIsCollapsed = function(sel) {\n                return sel.anchorNode === sel.focusNode && sel.anchorOffset === sel.focusOffset;\n            };\n        } else {\n            selectionIsCollapsed = function(sel) {\n                return sel.rangeCount ? sel.getRangeAt(sel.rangeCount - 1).collapsed : false;\n            };\n        }\n\n        function updateAnchorAndFocusFromRange(sel, range, backward) {\n            var anchorPrefix = backward ? \"end\" : \"start\", focusPrefix = backward ? \"start\" : \"end\";\n            sel.anchorNode = range[anchorPrefix + \"Container\"];\n            sel.anchorOffset = range[anchorPrefix + \"Offset\"];\n            sel.focusNode = range[focusPrefix + \"Container\"];\n            sel.focusOffset = range[focusPrefix + \"Offset\"];\n        }\n\n        function updateAnchorAndFocusFromNativeSelection(sel) {\n            var nativeSel = sel.nativeSelection;\n            sel.anchorNode = nativeSel.anchorNode;\n            sel.anchorOffset = nativeSel.anchorOffset;\n            sel.focusNode = nativeSel.focusNode;\n            sel.focusOffset = nativeSel.focusOffset;\n        }\n\n        function updateEmptySelection(sel) {\n            sel.anchorNode = sel.focusNode = null;\n            sel.anchorOffset = sel.focusOffset = 0;\n            sel.rangeCount = 0;\n            sel.isCollapsed = true;\n            sel._ranges.length = 0;\n        }\n\n        function getNativeRange(range) {\n            var nativeRange;\n            if (range instanceof DomRange) {\n                nativeRange = api.createNativeRange(range.getDocument());\n                nativeRange.setEnd(range.endContainer, range.endOffset);\n                nativeRange.setStart(range.startContainer, range.startOffset);\n            } else if (range instanceof WrappedRange) {\n                nativeRange = range.nativeRange;\n            } else if (features.implementsDomRange && (range instanceof dom.getWindow(range.startContainer).Range)) {\n                nativeRange = range;\n            }\n            return nativeRange;\n        }\n\n        function rangeContainsSingleElement(rangeNodes) {\n            if (!rangeNodes.length || rangeNodes[0].nodeType != 1) {\n                return false;\n            }\n            for (var i = 1, len = rangeNodes.length; i < len; ++i) {\n                if (!dom.isAncestorOf(rangeNodes[0], rangeNodes[i])) {\n                    return false;\n                }\n            }\n            return true;\n        }\n\n        function getSingleElementFromRange(range) {\n            var nodes = range.getNodes();\n            if (!rangeContainsSingleElement(nodes)) {\n                throw module.createError(\"getSingleElementFromRange: range \" + range.inspect() + \" did not consist of a single element\");\n            }\n            return nodes[0];\n        }\n\n        // Simple, quick test which only needs to distinguish between a TextRange and a ControlRange\n        function isTextRange(range) {\n            return !!range && typeof range.text != \"undefined\";\n        }\n\n        function updateFromTextRange(sel, range) {\n            // Create a Range from the selected TextRange\n            var wrappedRange = new WrappedRange(range);\n            sel._ranges = [wrappedRange];\n\n            updateAnchorAndFocusFromRange(sel, wrappedRange, false);\n            sel.rangeCount = 1;\n            sel.isCollapsed = wrappedRange.collapsed;\n        }\n\n        function updateControlSelection(sel) {\n            // Update the wrapped selection based on what's now in the native selection\n            sel._ranges.length = 0;\n            if (sel.docSelection.type == \"None\") {\n                updateEmptySelection(sel);\n            } else {\n                var controlRange = sel.docSelection.createRange();\n                if (isTextRange(controlRange)) {\n                    // This case (where the selection type is \"Control\" and calling createRange() on the selection returns\n                    // a TextRange) can happen in IE 9. It happens, for example, when all elements in the selected\n                    // ControlRange have been removed from the ControlRange and removed from the document.\n                    updateFromTextRange(sel, controlRange);\n                } else {\n                    sel.rangeCount = controlRange.length;\n                    var range, doc = getDocument(controlRange.item(0));\n                    for (var i = 0; i < sel.rangeCount; ++i) {\n                        range = api.createRange(doc);\n                        range.selectNode(controlRange.item(i));\n                        sel._ranges.push(range);\n                    }\n                    sel.isCollapsed = sel.rangeCount == 1 && sel._ranges[0].collapsed;\n                    updateAnchorAndFocusFromRange(sel, sel._ranges[sel.rangeCount - 1], false);\n                }\n            }\n        }\n\n        function addRangeToControlSelection(sel, range) {\n            var controlRange = sel.docSelection.createRange();\n            var rangeElement = getSingleElementFromRange(range);\n\n            // Create a new ControlRange containing all the elements in the selected ControlRange plus the element\n            // contained by the supplied range\n            var doc = getDocument(controlRange.item(0));\n            var newControlRange = getBody(doc).createControlRange();\n            for (var i = 0, len = controlRange.length; i < len; ++i) {\n                newControlRange.add(controlRange.item(i));\n            }\n            try {\n                newControlRange.add(rangeElement);\n            } catch (ex) {\n                throw module.createError(\"addRange(): Element within the specified Range could not be added to control selection (does it have layout?)\");\n            }\n            newControlRange.select();\n\n            // Update the wrapped selection based on what's now in the native selection\n            updateControlSelection(sel);\n        }\n\n        var getSelectionRangeAt;\n\n        if (isHostMethod(testSelection, \"getRangeAt\")) {\n            // try/catch is present because getRangeAt() must have thrown an error in some browser and some situation.\n            // Unfortunately, I didn't write a comment about the specifics and am now scared to take it out. Let that be a\n            // lesson to us all, especially me.\n            getSelectionRangeAt = function(sel, index) {\n                try {\n                    return sel.getRangeAt(index);\n                } catch (ex) {\n                    return null;\n                }\n            };\n        } else if (selectionHasAnchorAndFocus) {\n            getSelectionRangeAt = function(sel) {\n                var doc = getDocument(sel.anchorNode);\n                var range = api.createRange(doc);\n                range.setStartAndEnd(sel.anchorNode, sel.anchorOffset, sel.focusNode, sel.focusOffset);\n\n                // Handle the case when the selection was selected backwards (from the end to the start in the\n                // document)\n                if (range.collapsed !== this.isCollapsed) {\n                    range.setStartAndEnd(sel.focusNode, sel.focusOffset, sel.anchorNode, sel.anchorOffset);\n                }\n\n                return range;\n            };\n        }\n\n        function WrappedSelection(selection, docSelection, win) {\n            this.nativeSelection = selection;\n            this.docSelection = docSelection;\n            this._ranges = [];\n            this.win = win;\n            this.refresh();\n        }\n\n        WrappedSelection.prototype = api.selectionPrototype;\n\n        function deleteProperties(sel) {\n            sel.win = sel.anchorNode = sel.focusNode = sel._ranges = null;\n            sel.rangeCount = sel.anchorOffset = sel.focusOffset = 0;\n            sel.detached = true;\n        }\n\n        var cachedRangySelections = [];\n\n        function actOnCachedSelection(win, action) {\n            var i = cachedRangySelections.length, cached, sel;\n            while (i--) {\n                cached = cachedRangySelections[i];\n                sel = cached.selection;\n                if (action == \"deleteAll\") {\n                    deleteProperties(sel);\n                } else if (cached.win == win) {\n                    if (action == \"delete\") {\n                        cachedRangySelections.splice(i, 1);\n                        return true;\n                    } else {\n                        return sel;\n                    }\n                }\n            }\n            if (action == \"deleteAll\") {\n                cachedRangySelections.length = 0;\n            }\n            return null;\n        }\n\n        var getSelection = function(win) {\n            // Check if the parameter is a Rangy Selection object\n            if (win && win instanceof WrappedSelection) {\n                win.refresh();\n                return win;\n            }\n\n            win = getWindow(win, \"getNativeSelection\");\n\n            var sel = actOnCachedSelection(win);\n            var nativeSel = getNativeSelection(win), docSel = implementsDocSelection ? getDocSelection(win) : null;\n            if (sel) {\n                sel.nativeSelection = nativeSel;\n                sel.docSelection = docSel;\n                sel.refresh();\n            } else {\n                sel = new WrappedSelection(nativeSel, docSel, win);\n                cachedRangySelections.push( { win: win, selection: sel } );\n            }\n            return sel;\n        };\n\n        api.getSelection = getSelection;\n\n        api.getIframeSelection = function(iframeEl) {\n            module.deprecationNotice(\"getIframeSelection()\", \"getSelection(iframeEl)\");\n            return api.getSelection(dom.getIframeWindow(iframeEl));\n        };\n\n        var selProto = WrappedSelection.prototype;\n\n        function createControlSelection(sel, ranges) {\n            // Ensure that the selection becomes of type \"Control\"\n            var doc = getDocument(ranges[0].startContainer);\n            var controlRange = getBody(doc).createControlRange();\n            for (var i = 0, el, len = ranges.length; i < len; ++i) {\n                el = getSingleElementFromRange(ranges[i]);\n                try {\n                    controlRange.add(el);\n                } catch (ex) {\n                    throw module.createError(\"setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)\");\n                }\n            }\n            controlRange.select();\n\n            // Update the wrapped selection based on what's now in the native selection\n            updateControlSelection(sel);\n        }\n\n        // Selecting a range\n        if (!useDocumentSelection && selectionHasAnchorAndFocus && util.areHostMethods(testSelection, [\"removeAllRanges\", \"addRange\"])) {\n            selProto.removeAllRanges = function() {\n                this.nativeSelection.removeAllRanges();\n                updateEmptySelection(this);\n            };\n\n            var addRangeBackward = function(sel, range) {\n                addRangeBackwardToNative(sel.nativeSelection, range);\n                sel.refresh();\n            };\n\n            if (selectionHasRangeCount) {\n                selProto.addRange = function(range, direction) {\n                    if (implementsControlRange && implementsDocSelection && this.docSelection.type == CONTROL) {\n                        addRangeToControlSelection(this, range);\n                    } else {\n                        if (isDirectionBackward(direction) && selectionHasExtend) {\n                            addRangeBackward(this, range);\n                        } else {\n                            var previousRangeCount;\n                            if (selectionSupportsMultipleRanges) {\n                                previousRangeCount = this.rangeCount;\n                            } else {\n                                this.removeAllRanges();\n                                previousRangeCount = 0;\n                            }\n                            // Clone the native range so that changing the selected range does not affect the selection.\n                            // This is contrary to the spec but is the only way to achieve consistency between browsers. See\n                            // issue 80.\n                            this.nativeSelection.addRange(getNativeRange(range).cloneRange());\n\n                            // Check whether adding the range was successful\n                            this.rangeCount = this.nativeSelection.rangeCount;\n\n                            if (this.rangeCount == previousRangeCount + 1) {\n                                // The range was added successfully\n\n                                // Check whether the range that we added to the selection is reflected in the last range extracted from\n                                // the selection\n                                if (api.config.checkSelectionRanges) {\n                                    var nativeRange = getSelectionRangeAt(this.nativeSelection, this.rangeCount - 1);\n                                    if (nativeRange && !rangesEqual(nativeRange, range)) {\n                                        // Happens in WebKit with, for example, a selection placed at the start of a text node\n                                        range = new WrappedRange(nativeRange);\n                                    }\n                                }\n                                this._ranges[this.rangeCount - 1] = range;\n                                updateAnchorAndFocusFromRange(this, range, selectionIsBackward(this.nativeSelection));\n                                this.isCollapsed = selectionIsCollapsed(this);\n                            } else {\n                                // The range was not added successfully. The simplest thing is to refresh\n                                this.refresh();\n                            }\n                        }\n                    }\n                };\n            } else {\n                selProto.addRange = function(range, direction) {\n                    if (isDirectionBackward(direction) && selectionHasExtend) {\n                        addRangeBackward(this, range);\n                    } else {\n                        this.nativeSelection.addRange(getNativeRange(range));\n                        this.refresh();\n                    }\n                };\n            }\n\n            selProto.setRanges = function(ranges) {\n                if (implementsControlRange && implementsDocSelection && ranges.length > 1) {\n                    createControlSelection(this, ranges);\n                } else {\n                    this.removeAllRanges();\n                    for (var i = 0, len = ranges.length; i < len; ++i) {\n                        this.addRange(ranges[i]);\n                    }\n                }\n            };\n        } else if (isHostMethod(testSelection, \"empty\") && isHostMethod(testRange, \"select\") &&\n                   implementsControlRange && useDocumentSelection) {\n\n            selProto.removeAllRanges = function() {\n                // Added try/catch as fix for issue #21\n                try {\n                    this.docSelection.empty();\n\n                    // Check for empty() not working (issue #24)\n                    if (this.docSelection.type != \"None\") {\n                        // Work around failure to empty a control selection by instead selecting a TextRange and then\n                        // calling empty()\n                        var doc;\n                        if (this.anchorNode) {\n                            doc = getDocument(this.anchorNode);\n                        } else if (this.docSelection.type == CONTROL) {\n                            var controlRange = this.docSelection.createRange();\n                            if (controlRange.length) {\n                                doc = getDocument( controlRange.item(0) );\n                            }\n                        }\n                        if (doc) {\n                            var textRange = getBody(doc).createTextRange();\n                            textRange.select();\n                            this.docSelection.empty();\n                        }\n                    }\n                } catch(ex) {}\n                updateEmptySelection(this);\n            };\n\n            selProto.addRange = function(range) {\n                if (this.docSelection.type == CONTROL) {\n                    addRangeToControlSelection(this, range);\n                } else {\n                    api.WrappedTextRange.rangeToTextRange(range).select();\n                    this._ranges[0] = range;\n                    this.rangeCount = 1;\n                    this.isCollapsed = this._ranges[0].collapsed;\n                    updateAnchorAndFocusFromRange(this, range, false);\n                }\n            };\n\n            selProto.setRanges = function(ranges) {\n                this.removeAllRanges();\n                var rangeCount = ranges.length;\n                if (rangeCount > 1) {\n                    createControlSelection(this, ranges);\n                } else if (rangeCount) {\n                    this.addRange(ranges[0]);\n                }\n            };\n        } else {\n            module.fail(\"No means of selecting a Range or TextRange was found\");\n            return false;\n        }\n\n        selProto.getRangeAt = function(index) {\n            if (index < 0 || index >= this.rangeCount) {\n                throw new DOMException(\"INDEX_SIZE_ERR\");\n            } else {\n                // Clone the range to preserve selection-range independence. See issue 80.\n                return this._ranges[index].cloneRange();\n            }\n        };\n\n        var refreshSelection;\n\n        if (useDocumentSelection) {\n            refreshSelection = function(sel) {\n                var range;\n                if (api.isSelectionValid(sel.win)) {\n                    range = sel.docSelection.createRange();\n                } else {\n                    range = getBody(sel.win.document).createTextRange();\n                    range.collapse(true);\n                }\n\n                if (sel.docSelection.type == CONTROL) {\n                    updateControlSelection(sel);\n                } else if (isTextRange(range)) {\n                    updateFromTextRange(sel, range);\n                } else {\n                    updateEmptySelection(sel);\n                }\n            };\n        } else if (isHostMethod(testSelection, \"getRangeAt\") && typeof testSelection.rangeCount == NUMBER) {\n            refreshSelection = function(sel) {\n                if (implementsControlRange && implementsDocSelection && sel.docSelection.type == CONTROL) {\n                    updateControlSelection(sel);\n                } else {\n                    sel._ranges.length = sel.rangeCount = sel.nativeSelection.rangeCount;\n                    if (sel.rangeCount) {\n                        for (var i = 0, len = sel.rangeCount; i < len; ++i) {\n                            sel._ranges[i] = new api.WrappedRange(sel.nativeSelection.getRangeAt(i));\n                        }\n                        updateAnchorAndFocusFromRange(sel, sel._ranges[sel.rangeCount - 1], selectionIsBackward(sel.nativeSelection));\n                        sel.isCollapsed = selectionIsCollapsed(sel);\n                    } else {\n                        updateEmptySelection(sel);\n                    }\n                }\n            };\n        } else if (selectionHasAnchorAndFocus && typeof testSelection.isCollapsed == BOOLEAN && typeof testRange.collapsed == BOOLEAN && features.implementsDomRange) {\n            refreshSelection = function(sel) {\n                var range, nativeSel = sel.nativeSelection;\n                if (nativeSel.anchorNode) {\n                    range = getSelectionRangeAt(nativeSel, 0);\n                    sel._ranges = [range];\n                    sel.rangeCount = 1;\n                    updateAnchorAndFocusFromNativeSelection(sel);\n                    sel.isCollapsed = selectionIsCollapsed(sel);\n                } else {\n                    updateEmptySelection(sel);\n                }\n            };\n        } else {\n            module.fail(\"No means of obtaining a Range or TextRange from the user's selection was found\");\n            return false;\n        }\n\n        selProto.refresh = function(checkForChanges) {\n            var oldRanges = checkForChanges ? this._ranges.slice(0) : null;\n            var oldAnchorNode = this.anchorNode, oldAnchorOffset = this.anchorOffset;\n\n            refreshSelection(this);\n            if (checkForChanges) {\n                // Check the range count first\n                var i = oldRanges.length;\n                if (i != this._ranges.length) {\n                    return true;\n                }\n\n                // Now check the direction. Checking the anchor position is the same is enough since we're checking all the\n                // ranges after this\n                if (this.anchorNode != oldAnchorNode || this.anchorOffset != oldAnchorOffset) {\n                    return true;\n                }\n\n                // Finally, compare each range in turn\n                while (i--) {\n                    if (!rangesEqual(oldRanges[i], this._ranges[i])) {\n                        return true;\n                    }\n                }\n                return false;\n            }\n        };\n\n        // Removal of a single range\n        var removeRangeManually = function(sel, range) {\n            var ranges = sel.getAllRanges();\n            sel.removeAllRanges();\n            for (var i = 0, len = ranges.length; i < len; ++i) {\n                if (!rangesEqual(range, ranges[i])) {\n                    sel.addRange(ranges[i]);\n                }\n            }\n            if (!sel.rangeCount) {\n                updateEmptySelection(sel);\n            }\n        };\n\n        if (implementsControlRange && implementsDocSelection) {\n            selProto.removeRange = function(range) {\n                if (this.docSelection.type == CONTROL) {\n                    var controlRange = this.docSelection.createRange();\n                    var rangeElement = getSingleElementFromRange(range);\n\n                    // Create a new ControlRange containing all the elements in the selected ControlRange minus the\n                    // element contained by the supplied range\n                    var doc = getDocument(controlRange.item(0));\n                    var newControlRange = getBody(doc).createControlRange();\n                    var el, removed = false;\n                    for (var i = 0, len = controlRange.length; i < len; ++i) {\n                        el = controlRange.item(i);\n                        if (el !== rangeElement || removed) {\n                            newControlRange.add(controlRange.item(i));\n                        } else {\n                            removed = true;\n                        }\n                    }\n                    newControlRange.select();\n\n                    // Update the wrapped selection based on what's now in the native selection\n                    updateControlSelection(this);\n                } else {\n                    removeRangeManually(this, range);\n                }\n            };\n        } else {\n            selProto.removeRange = function(range) {\n                removeRangeManually(this, range);\n            };\n        }\n\n        // Detecting if a selection is backward\n        var selectionIsBackward;\n        if (!useDocumentSelection && selectionHasAnchorAndFocus && features.implementsDomRange) {\n            selectionIsBackward = winSelectionIsBackward;\n\n            selProto.isBackward = function() {\n                return selectionIsBackward(this);\n            };\n        } else {\n            selectionIsBackward = selProto.isBackward = function() {\n                return false;\n            };\n        }\n\n        // Create an alias for backwards compatibility. From 1.3, everything is \"backward\" rather than \"backwards\"\n        selProto.isBackwards = selProto.isBackward;\n\n        // Selection stringifier\n        // This is conformant to the old HTML5 selections draft spec but differs from WebKit and Mozilla's implementation.\n        // The current spec does not yet define this method.\n        selProto.toString = function() {\n            var rangeTexts = [];\n            for (var i = 0, len = this.rangeCount; i < len; ++i) {\n                rangeTexts[i] = \"\" + this._ranges[i];\n            }\n            return rangeTexts.join(\"\");\n        };\n\n        function assertNodeInSameDocument(sel, node) {\n            if (sel.win.document != getDocument(node)) {\n                throw new DOMException(\"WRONG_DOCUMENT_ERR\");\n            }\n        }\n\n        // No current browser conforms fully to the spec for this method, so Rangy's own method is always used\n        selProto.collapse = function(node, offset) {\n            assertNodeInSameDocument(this, node);\n            var range = api.createRange(node);\n            range.collapseToPoint(node, offset);\n            this.setSingleRange(range);\n            this.isCollapsed = true;\n        };\n\n        selProto.collapseToStart = function() {\n            if (this.rangeCount) {\n                var range = this._ranges[0];\n                this.collapse(range.startContainer, range.startOffset);\n            } else {\n                throw new DOMException(\"INVALID_STATE_ERR\");\n            }\n        };\n\n        selProto.collapseToEnd = function() {\n            if (this.rangeCount) {\n                var range = this._ranges[this.rangeCount - 1];\n                this.collapse(range.endContainer, range.endOffset);\n            } else {\n                throw new DOMException(\"INVALID_STATE_ERR\");\n            }\n        };\n\n        // The spec is very specific on how selectAllChildren should be implemented so the native implementation is\n        // never used by Rangy.\n        selProto.selectAllChildren = function(node) {\n            assertNodeInSameDocument(this, node);\n            var range = api.createRange(node);\n            range.selectNodeContents(node);\n            this.setSingleRange(range);\n        };\n\n        selProto.deleteFromDocument = function() {\n            // Sepcial behaviour required for IE's control selections\n            if (implementsControlRange && implementsDocSelection && this.docSelection.type == CONTROL) {\n                var controlRange = this.docSelection.createRange();\n                var element;\n                while (controlRange.length) {\n                    element = controlRange.item(0);\n                    controlRange.remove(element);\n                    element.parentNode.removeChild(element);\n                }\n                this.refresh();\n            } else if (this.rangeCount) {\n                var ranges = this.getAllRanges();\n                if (ranges.length) {\n                    this.removeAllRanges();\n                    for (var i = 0, len = ranges.length; i < len; ++i) {\n                        ranges[i].deleteContents();\n                    }\n                    // The spec says nothing about what the selection should contain after calling deleteContents on each\n                    // range. Firefox moves the selection to where the final selected range was, so we emulate that\n                    this.addRange(ranges[len - 1]);\n                }\n            }\n        };\n\n        // The following are non-standard extensions\n        selProto.eachRange = function(func, returnValue) {\n            for (var i = 0, len = this._ranges.length; i < len; ++i) {\n                if ( func( this.getRangeAt(i) ) ) {\n                    return returnValue;\n                }\n            }\n        };\n\n        selProto.getAllRanges = function() {\n            var ranges = [];\n            this.eachRange(function(range) {\n                ranges.push(range);\n            });\n            return ranges;\n        };\n\n        selProto.setSingleRange = function(range, direction) {\n            this.removeAllRanges();\n            this.addRange(range, direction);\n        };\n\n        selProto.callMethodOnEachRange = function(methodName, params) {\n            var results = [];\n            this.eachRange( function(range) {\n                results.push( range[methodName].apply(range, params) );\n            } );\n            return results;\n        };\n        \n        function createStartOrEndSetter(isStart) {\n            return function(node, offset) {\n                var range;\n                if (this.rangeCount) {\n                    range = this.getRangeAt(0);\n                    range[\"set\" + (isStart ? \"Start\" : \"End\")](node, offset);\n                } else {\n                    range = api.createRange(this.win.document);\n                    range.setStartAndEnd(node, offset);\n                }\n                this.setSingleRange(range, this.isBackward());\n            };\n        }\n\n        selProto.setStart = createStartOrEndSetter(true);\n        selProto.setEnd = createStartOrEndSetter(false);\n        \n        // Add select() method to Range prototype. Any existing selection will be removed.\n        api.rangePrototype.select = function(direction) {\n            getSelection( this.getDocument() ).setSingleRange(this, direction);\n        };\n\n        selProto.changeEachRange = function(func) {\n            var ranges = [];\n            var backward = this.isBackward();\n\n            this.eachRange(function(range) {\n                func(range);\n                ranges.push(range);\n            });\n\n            this.removeAllRanges();\n            if (backward && ranges.length == 1) {\n                this.addRange(ranges[0], \"backward\");\n            } else {\n                this.setRanges(ranges);\n            }\n        };\n\n        selProto.containsNode = function(node, allowPartial) {\n            return this.eachRange( function(range) {\n                return range.containsNode(node, allowPartial);\n            }, true ) || false;\n        };\n\n        selProto.getBookmark = function(containerNode) {\n            return {\n                backward: this.isBackward(),\n                rangeBookmarks: this.callMethodOnEachRange(\"getBookmark\", [containerNode])\n            };\n        };\n\n        selProto.moveToBookmark = function(bookmark) {\n            var selRanges = [];\n            for (var i = 0, rangeBookmark, range; rangeBookmark = bookmark.rangeBookmarks[i++]; ) {\n                range = api.createRange(this.win);\n                range.moveToBookmark(rangeBookmark);\n                selRanges.push(range);\n            }\n            if (bookmark.backward) {\n                this.setSingleRange(selRanges[0], \"backward\");\n            } else {\n                this.setRanges(selRanges);\n            }\n        };\n\n        selProto.toHtml = function() {\n            var rangeHtmls = [];\n            this.eachRange(function(range) {\n                rangeHtmls.push( DomRange.toHtml(range) );\n            });\n            return rangeHtmls.join(\"\");\n        };\n\n        if (features.implementsTextRange) {\n            selProto.getNativeTextRange = function() {\n                var sel, textRange;\n                if ( (sel = this.docSelection) ) {\n                    var range = sel.createRange();\n                    if (isTextRange(range)) {\n                        return range;\n                    } else {\n                        throw module.createError(\"getNativeTextRange: selection is a control selection\"); \n                    }\n                } else if (this.rangeCount > 0) {\n                    return api.WrappedTextRange.rangeToTextRange( this.getRangeAt(0) );\n                } else {\n                    throw module.createError(\"getNativeTextRange: selection contains no range\");\n                }\n            };\n        }\n\n        function inspect(sel) {\n            var rangeInspects = [];\n            var anchor = new DomPosition(sel.anchorNode, sel.anchorOffset);\n            var focus = new DomPosition(sel.focusNode, sel.focusOffset);\n            var name = (typeof sel.getName == \"function\") ? sel.getName() : \"Selection\";\n\n            if (typeof sel.rangeCount != \"undefined\") {\n                for (var i = 0, len = sel.rangeCount; i < len; ++i) {\n                    rangeInspects[i] = DomRange.inspect(sel.getRangeAt(i));\n                }\n            }\n            return \"[\" + name + \"(Ranges: \" + rangeInspects.join(\", \") +\n                    \")(anchor: \" + anchor.inspect() + \", focus: \" + focus.inspect() + \"]\";\n        }\n\n        selProto.getName = function() {\n            return \"WrappedSelection\";\n        };\n\n        selProto.inspect = function() {\n            return inspect(this);\n        };\n\n        selProto.detach = function() {\n            actOnCachedSelection(this.win, \"delete\");\n            deleteProperties(this);\n        };\n\n        WrappedSelection.detachAll = function() {\n            actOnCachedSelection(null, \"deleteAll\");\n        };\n\n        WrappedSelection.inspect = inspect;\n        WrappedSelection.isDirectionBackward = isDirectionBackward;\n\n        api.Selection = WrappedSelection;\n\n        api.selectionPrototype = selProto;\n\n        api.addShimListener(function(win) {\n            if (typeof win.getSelection == \"undefined\") {\n                win.getSelection = function() {\n                    return getSelection(win);\n                };\n            }\n            win = null;\n        });\n    });\n    \n\n    /*----------------------------------------------------------------------------------------------------------------*/\n\n    return api;\n}, this);;/**\n * Selection save and restore module for Rangy.\n * Saves and restores user selections using marker invisible elements in the DOM.\n *\n * Part of Rangy, a cross-browser JavaScript range and selection library\n * http://code.google.com/p/rangy/\n *\n * Depends on Rangy core.\n *\n * Copyright 2014, Tim Down\n * Licensed under the MIT license.\n * Version: 1.3alpha.20140804\n * Build date: 4 August 2014\n */\n(function(factory, global) {\n    if (typeof define == \"function\" && define.amd) {\n        // AMD. Register as an anonymous module with a dependency on Rangy.\n        define([\"rangy\"], factory);\n        /*\n         } else if (typeof exports == \"object\") {\n         // Node/CommonJS style for Browserify\n         module.exports = factory;\n         */\n    } else {\n        // No AMD or CommonJS support so we use the rangy global variable\n        factory(global.rangy);\n    }\n})(function(rangy) {\n    rangy.createModule(\"SaveRestore\", [\"WrappedRange\"], function(api, module) {\n        var dom = api.dom;\n\n        var markerTextChar = \"\\ufeff\";\n\n        function gEBI(id, doc) {\n            return (doc || document).getElementById(id);\n        }\n\n        function insertRangeBoundaryMarker(range, atStart) {\n            var markerId = \"selectionBoundary_\" + (+new Date()) + \"_\" + (\"\" + Math.random()).slice(2);\n            var markerEl;\n            var doc = dom.getDocument(range.startContainer);\n\n            // Clone the Range and collapse to the appropriate boundary point\n            var boundaryRange = range.cloneRange();\n            boundaryRange.collapse(atStart);\n\n            // Create the marker element containing a single invisible character using DOM methods and insert it\n            markerEl = doc.createElement(\"span\");\n            markerEl.id = markerId;\n            markerEl.style.lineHeight = \"0\";\n            markerEl.style.display = \"none\";\n            markerEl.className = \"rangySelectionBoundary\";\n            markerEl.appendChild(doc.createTextNode(markerTextChar));\n\n            boundaryRange.insertNode(markerEl);\n            return markerEl;\n        }\n\n        function setRangeBoundary(doc, range, markerId, atStart) {\n            var markerEl = gEBI(markerId, doc);\n            if (markerEl) {\n                range[atStart ? \"setStartBefore\" : \"setEndBefore\"](markerEl);\n                markerEl.parentNode.removeChild(markerEl);\n            } else {\n                module.warn(\"Marker element has been removed. Cannot restore selection.\");\n            }\n        }\n\n        function compareRanges(r1, r2) {\n            return r2.compareBoundaryPoints(r1.START_TO_START, r1);\n        }\n\n        function saveRange(range, backward) {\n            var startEl, endEl, doc = api.DomRange.getRangeDocument(range), text = range.toString();\n\n            if (range.collapsed) {\n                endEl = insertRangeBoundaryMarker(range, false);\n                return {\n                    document: doc,\n                    markerId: endEl.id,\n                    collapsed: true\n                };\n            } else {\n                endEl = insertRangeBoundaryMarker(range, false);\n                startEl = insertRangeBoundaryMarker(range, true);\n\n                return {\n                    document: doc,\n                    startMarkerId: startEl.id,\n                    endMarkerId: endEl.id,\n                    collapsed: false,\n                    backward: backward,\n                    toString: function() {\n                        return \"original text: '\" + text + \"', new text: '\" + range.toString() + \"'\";\n                    }\n                };\n            }\n        }\n\n        function restoreRange(rangeInfo, normalize) {\n            var doc = rangeInfo.document;\n            if (typeof normalize == \"undefined\") {\n                normalize = true;\n            }\n            var range = api.createRange(doc);\n            if (rangeInfo.collapsed) {\n                var markerEl = gEBI(rangeInfo.markerId, doc);\n                if (markerEl) {\n                    markerEl.style.display = \"inline\";\n                    var previousNode = markerEl.previousSibling;\n\n                    // Workaround for issue 17\n                    if (previousNode && previousNode.nodeType == 3) {\n                        markerEl.parentNode.removeChild(markerEl);\n                        range.collapseToPoint(previousNode, previousNode.length);\n                    } else {\n                        range.collapseBefore(markerEl);\n                        markerEl.parentNode.removeChild(markerEl);\n                    }\n                } else {\n                    module.warn(\"Marker element has been removed. Cannot restore selection.\");\n                }\n            } else {\n                setRangeBoundary(doc, range, rangeInfo.startMarkerId, true);\n                setRangeBoundary(doc, range, rangeInfo.endMarkerId, false);\n            }\n\n            if (normalize) {\n                range.normalizeBoundaries();\n            }\n\n            return range;\n        }\n\n        function saveRanges(ranges, backward) {\n            var rangeInfos = [], range, doc;\n\n            // Order the ranges by position within the DOM, latest first, cloning the array to leave the original untouched\n            ranges = ranges.slice(0);\n            ranges.sort(compareRanges);\n\n            for (var i = 0, len = ranges.length; i < len; ++i) {\n                rangeInfos[i] = saveRange(ranges[i], backward);\n            }\n\n            // Now that all the markers are in place and DOM manipulation over, adjust each range's boundaries to lie\n            // between its markers\n            for (i = len - 1; i >= 0; --i) {\n                range = ranges[i];\n                doc = api.DomRange.getRangeDocument(range);\n                if (range.collapsed) {\n                    range.collapseAfter(gEBI(rangeInfos[i].markerId, doc));\n                } else {\n                    range.setEndBefore(gEBI(rangeInfos[i].endMarkerId, doc));\n                    range.setStartAfter(gEBI(rangeInfos[i].startMarkerId, doc));\n                }\n            }\n\n            return rangeInfos;\n        }\n\n        function saveSelection(win) {\n            if (!api.isSelectionValid(win)) {\n                module.warn(\"Cannot save selection. This usually happens when the selection is collapsed and the selection document has lost focus.\");\n                return null;\n            }\n            var sel = api.getSelection(win);\n            var ranges = sel.getAllRanges();\n            var backward = (ranges.length == 1 && sel.isBackward());\n\n            var rangeInfos = saveRanges(ranges, backward);\n\n            // Ensure current selection is unaffected\n            if (backward) {\n                sel.setSingleRange(ranges[0], \"backward\");\n            } else {\n                sel.setRanges(ranges);\n            }\n\n            return {\n                win: win,\n                rangeInfos: rangeInfos,\n                restored: false\n            };\n        }\n\n        function restoreRanges(rangeInfos) {\n            var ranges = [];\n\n            // Ranges are in reverse order of appearance in the DOM. We want to restore earliest first to avoid\n            // normalization affecting previously restored ranges.\n            var rangeCount = rangeInfos.length;\n\n            for (var i = rangeCount - 1; i >= 0; i--) {\n                ranges[i] = restoreRange(rangeInfos[i], true);\n            }\n\n            return ranges;\n        }\n\n        function restoreSelection(savedSelection, preserveDirection) {\n            if (!savedSelection.restored) {\n                var rangeInfos = savedSelection.rangeInfos;\n                var sel = api.getSelection(savedSelection.win);\n                var ranges = restoreRanges(rangeInfos), rangeCount = rangeInfos.length;\n\n                if (rangeCount == 1 && preserveDirection && api.features.selectionHasExtend && rangeInfos[0].backward) {\n                    sel.removeAllRanges();\n                    sel.addRange(ranges[0], true);\n                } else {\n                    sel.setRanges(ranges);\n                }\n\n                savedSelection.restored = true;\n            }\n        }\n\n        function removeMarkerElement(doc, markerId) {\n            var markerEl = gEBI(markerId, doc);\n            if (markerEl) {\n                markerEl.parentNode.removeChild(markerEl);\n            }\n        }\n\n        function removeMarkers(savedSelection) {\n            var rangeInfos = savedSelection.rangeInfos;\n            for (var i = 0, len = rangeInfos.length, rangeInfo; i < len; ++i) {\n                rangeInfo = rangeInfos[i];\n                if (rangeInfo.collapsed) {\n                    removeMarkerElement(savedSelection.doc, rangeInfo.markerId);\n                } else {\n                    removeMarkerElement(savedSelection.doc, rangeInfo.startMarkerId);\n                    removeMarkerElement(savedSelection.doc, rangeInfo.endMarkerId);\n                }\n            }\n        }\n\n        api.util.extend(api, {\n            saveRange: saveRange,\n            restoreRange: restoreRange,\n            saveRanges: saveRanges,\n            restoreRanges: restoreRanges,\n            saveSelection: saveSelection,\n            restoreSelection: restoreSelection,\n            removeMarkerElement: removeMarkerElement,\n            removeMarkers: removeMarkers\n        });\n    });\n    \n}, this);;/*\n\tBase.js, version 1.1a\n\tCopyright 2006-2010, Dean Edwards\n\tLicense: http://www.opensource.org/licenses/mit-license.php\n*/\n\nvar Base = function() {\n\t// dummy\n};\n\nBase.extend = function(_instance, _static) { // subclass\n\tvar extend = Base.prototype.extend;\n\t\n\t// build the prototype\n\tBase._prototyping = true;\n\tvar proto = new this;\n\textend.call(proto, _instance);\n  proto.base = function() {\n    // call this method from any other method to invoke that method's ancestor\n  };\n\tdelete Base._prototyping;\n\t\n\t// create the wrapper for the constructor function\n\t//var constructor = proto.constructor.valueOf(); //-dean\n\tvar constructor = proto.constructor;\n\tvar klass = proto.constructor = function() {\n\t\tif (!Base._prototyping) {\n\t\t\tif (this._constructing || this.constructor == klass) { // instantiation\n\t\t\t\tthis._constructing = true;\n\t\t\t\tconstructor.apply(this, arguments);\n\t\t\t\tdelete this._constructing;\n\t\t\t} else if (arguments[0] != null) { // casting\n\t\t\t\treturn (arguments[0].extend || extend).call(arguments[0], proto);\n\t\t\t}\n\t\t}\n\t};\n\t\n\t// build the class interface\n\tklass.ancestor = this;\n\tklass.extend = this.extend;\n\tklass.forEach = this.forEach;\n\tklass.implement = this.implement;\n\tklass.prototype = proto;\n\tklass.toString = this.toString;\n\tklass.valueOf = function(type) {\n\t\t//return (type == \"object\") ? klass : constructor; //-dean\n\t\treturn (type == \"object\") ? klass : constructor.valueOf();\n\t};\n\textend.call(klass, _static);\n\t// class initialisation\n\tif (typeof klass.init == \"function\") klass.init();\n\treturn klass;\n};\n\nBase.prototype = {\t\n\textend: function(source, value) {\n\t\tif (arguments.length > 1) { // extending with a name/value pair\n\t\t\tvar ancestor = this[source];\n\t\t\tif (ancestor && (typeof value == \"function\") && // overriding a method?\n\t\t\t\t// the valueOf() comparison is to avoid circular references\n\t\t\t\t(!ancestor.valueOf || ancestor.valueOf() != value.valueOf()) &&\n\t\t\t\t/\\bbase\\b/.test(value)) {\n\t\t\t\t// get the underlying method\n\t\t\t\tvar method = value.valueOf();\n\t\t\t\t// override\n\t\t\t\tvalue = function() {\n\t\t\t\t\tvar previous = this.base || Base.prototype.base;\n\t\t\t\t\tthis.base = ancestor;\n\t\t\t\t\tvar returnValue = method.apply(this, arguments);\n\t\t\t\t\tthis.base = previous;\n\t\t\t\t\treturn returnValue;\n\t\t\t\t};\n\t\t\t\t// point to the underlying method\n\t\t\t\tvalue.valueOf = function(type) {\n\t\t\t\t\treturn (type == \"object\") ? value : method;\n\t\t\t\t};\n\t\t\t\tvalue.toString = Base.toString;\n\t\t\t}\n\t\t\tthis[source] = value;\n\t\t} else if (source) { // extending with an object literal\n\t\t\tvar extend = Base.prototype.extend;\n\t\t\t// if this object has a customised extend method then use it\n\t\t\tif (!Base._prototyping && typeof this != \"function\") {\n\t\t\t\textend = this.extend || extend;\n\t\t\t}\n\t\t\tvar proto = {toSource: null};\n\t\t\t// do the \"toString\" and other methods manually\n\t\t\tvar hidden = [\"constructor\", \"toString\", \"valueOf\"];\n\t\t\t// if we are prototyping then include the constructor\n\t\t\tvar i = Base._prototyping ? 0 : 1;\n\t\t\twhile (key = hidden[i++]) {\n\t\t\t\tif (source[key] != proto[key]) {\n\t\t\t\t\textend.call(this, key, source[key]);\n\n\t\t\t\t}\n\t\t\t}\n\t\t\t// copy each of the source object's properties to this object\n\t\t\tfor (var key in source) {\n\t\t\t\tif (!proto[key]) extend.call(this, key, source[key]);\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n};\n\n// initialise\nBase = Base.extend({\n\tconstructor: function() {\n\t\tthis.extend(arguments[0]);\n\t}\n}, {\n\tancestor: Object,\n\tversion: \"1.1\",\n\t\n\tforEach: function(object, block, context) {\n\t\tfor (var key in object) {\n\t\t\tif (this.prototype[key] === undefined) {\n\t\t\t\tblock.call(context, object[key], key, object);\n\t\t\t}\n\t\t}\n\t},\n\t\t\n\timplement: function() {\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tif (typeof arguments[i] == \"function\") {\n\t\t\t\t// if it's a function, call it\n\t\t\t\targuments[i](this.prototype);\n\t\t\t} else {\n\t\t\t\t// add the interface using the extend method\n\t\t\t\tthis.prototype.extend(arguments[i]);\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t},\n\t\n\ttoString: function() {\n\t\treturn String(this.valueOf());\n\t}\n});;/**\n * Detect browser support for specific features\n */\nwysihtml5.browser = (function() {\n  var userAgent   = navigator.userAgent,\n      testElement = document.createElement(\"div\"),\n      // Browser sniffing is unfortunately needed since some behaviors are impossible to feature detect\n      isGecko     = userAgent.indexOf(\"Gecko\")        !== -1 && userAgent.indexOf(\"KHTML\") === -1,\n      isWebKit    = userAgent.indexOf(\"AppleWebKit/\") !== -1,\n      isChrome    = userAgent.indexOf(\"Chrome/\")      !== -1,\n      isOpera     = userAgent.indexOf(\"Opera/\")       !== -1;\n\n  function iosVersion(userAgent) {\n    return +((/ipad|iphone|ipod/.test(userAgent) && userAgent.match(/ os (\\d+).+? like mac os x/)) || [undefined, 0])[1];\n  }\n\n  function androidVersion(userAgent) {\n    return +(userAgent.match(/android (\\d+)/) || [undefined, 0])[1];\n  }\n\n  function isIE(version, equation) {\n    var rv = -1,\n        re;\n\n    if (navigator.appName == 'Microsoft Internet Explorer') {\n      re = new RegExp(\"MSIE ([0-9]{1,}[\\.0-9]{0,})\");\n    } else if (navigator.appName == 'Netscape') {\n      re = new RegExp(\"Trident/.*rv:([0-9]{1,}[\\.0-9]{0,})\");\n    }\n\n    if (re && re.exec(navigator.userAgent) != null) {\n      rv = parseFloat(RegExp.$1);\n    }\n\n    if (rv === -1) { return false; }\n    if (!version) { return true; }\n    if (!equation) { return version === rv; }\n    if (equation === \"<\") { return version < rv; }\n    if (equation === \">\") { return version > rv; }\n    if (equation === \"<=\") { return version <= rv; }\n    if (equation === \">=\") { return version >= rv; }\n  }\n\n  return {\n    // Static variable needed, publicly accessible, to be able override it in unit tests\n    USER_AGENT: userAgent,\n\n    /**\n     * Exclude browsers that are not capable of displaying and handling\n     * contentEditable as desired:\n     *    - iPhone, iPad (tested iOS 4.2.2) and Android (tested 2.2) refuse to make contentEditables focusable\n     *    - IE < 8 create invalid markup and crash randomly from time to time\n     *\n     * @return {Boolean}\n     */\n    supported: function() {\n      var userAgent                   = this.USER_AGENT.toLowerCase(),\n          // Essential for making html elements editable\n          hasContentEditableSupport   = \"contentEditable\" in testElement,\n          // Following methods are needed in order to interact with the contentEditable area\n          hasEditingApiSupport        = document.execCommand && document.queryCommandSupported && document.queryCommandState,\n          // document selector apis are only supported by IE 8+, Safari 4+, Chrome and Firefox 3.5+\n          hasQuerySelectorSupport     = document.querySelector && document.querySelectorAll,\n          // contentEditable is unusable in mobile browsers (tested iOS 4.2.2, Android 2.2, Opera Mobile, WebOS 3.05)\n          isIncompatibleMobileBrowser = (this.isIos() && iosVersion(userAgent) < 5) || (this.isAndroid() && androidVersion(userAgent) < 4) || userAgent.indexOf(\"opera mobi\") !== -1 || userAgent.indexOf(\"hpwos/\") !== -1;\n      return hasContentEditableSupport\n        && hasEditingApiSupport\n        && hasQuerySelectorSupport\n        && !isIncompatibleMobileBrowser;\n    },\n\n    isTouchDevice: function() {\n      return this.supportsEvent(\"touchmove\");\n    },\n\n    isIos: function() {\n      return (/ipad|iphone|ipod/i).test(this.USER_AGENT);\n    },\n\n    isAndroid: function() {\n      return this.USER_AGENT.indexOf(\"Android\") !== -1;\n    },\n\n    /**\n     * Whether the browser supports sandboxed iframes\n     * Currently only IE 6+ offers such feature <iframe security=\"restricted\">\n     *\n     * http://msdn.microsoft.com/en-us/library/ms534622(v=vs.85).aspx\n     * http://blogs.msdn.com/b/ie/archive/2008/01/18/using-frames-more-securely.aspx\n     *\n     * HTML5 sandboxed iframes are still buggy and their DOM is not reachable from the outside (except when using postMessage)\n     */\n    supportsSandboxedIframes: function() {\n      return isIE();\n    },\n\n    /**\n     * IE6+7 throw a mixed content warning when the src of an iframe\n     * is empty/unset or about:blank\n     * window.querySelector is implemented as of IE8\n     */\n    throwsMixedContentWarningWhenIframeSrcIsEmpty: function() {\n      return !(\"querySelector\" in document);\n    },\n\n    /**\n     * Whether the caret is correctly displayed in contentEditable elements\n     * Firefox sometimes shows a huge caret in the beginning after focusing\n     */\n    displaysCaretInEmptyContentEditableCorrectly: function() {\n      return isIE();\n    },\n\n    /**\n     * Opera and IE are the only browsers who offer the css value\n     * in the original unit, thx to the currentStyle object\n     * All other browsers provide the computed style in px via window.getComputedStyle\n     */\n    hasCurrentStyleProperty: function() {\n      return \"currentStyle\" in testElement;\n    },\n\n    /**\n     * Firefox on OSX navigates through history when hitting CMD + Arrow right/left\n     */\n    hasHistoryIssue: function() {\n      return isGecko && navigator.platform.substr(0, 3) === \"Mac\";\n    },\n\n    /**\n     * Whether the browser inserts a <br> when pressing enter in a contentEditable element\n     */\n    insertsLineBreaksOnReturn: function() {\n      return isGecko;\n    },\n\n    supportsPlaceholderAttributeOn: function(element) {\n      return \"placeholder\" in element;\n    },\n\n    supportsEvent: function(eventName) {\n      return \"on\" + eventName in testElement || (function() {\n        testElement.setAttribute(\"on\" + eventName, \"return;\");\n        return typeof(testElement[\"on\" + eventName]) === \"function\";\n      })();\n    },\n\n    /**\n     * Opera doesn't correctly fire focus/blur events when clicking in- and outside of iframe\n     */\n    supportsEventsInIframeCorrectly: function() {\n      return !isOpera;\n    },\n\n    /**\n     * Everything below IE9 doesn't know how to treat HTML5 tags\n     *\n     * @param {Object} context The document object on which to check HTML5 support\n     *\n     * @example\n     *    wysihtml5.browser.supportsHTML5Tags(document);\n     */\n    supportsHTML5Tags: function(context) {\n      var element = context.createElement(\"div\"),\n          html5   = \"<article>foo</article>\";\n      element.innerHTML = html5;\n      return element.innerHTML.toLowerCase() === html5;\n    },\n\n    /**\n     * Checks whether a document supports a certain queryCommand\n     * In particular, Opera needs a reference to a document that has a contentEditable in it's dom tree\n     * in oder to report correct results\n     *\n     * @param {Object} doc Document object on which to check for a query command\n     * @param {String} command The query command to check for\n     * @return {Boolean}\n     *\n     * @example\n     *    wysihtml5.browser.supportsCommand(document, \"bold\");\n     */\n    supportsCommand: (function() {\n      // Following commands are supported but contain bugs in some browsers\n      var buggyCommands = {\n        // formatBlock fails with some tags (eg. <blockquote>)\n        \"formatBlock\":          isIE(10, \"<=\"),\n         // When inserting unordered or ordered lists in Firefox, Chrome or Safari, the current selection or line gets\n         // converted into a list (<ul><li>...</li></ul>, <ol><li>...</li></ol>)\n         // IE and Opera act a bit different here as they convert the entire content of the current block element into a list\n        \"insertUnorderedList\":  isIE(),\n        \"insertOrderedList\":    isIE()\n      };\n\n      // Firefox throws errors for queryCommandSupported, so we have to build up our own object of supported commands\n      var supported = {\n        \"insertHTML\": isGecko\n      };\n\n      return function(doc, command) {\n        var isBuggy = buggyCommands[command];\n        if (!isBuggy) {\n          // Firefox throws errors when invoking queryCommandSupported or queryCommandEnabled\n          try {\n            return doc.queryCommandSupported(command);\n          } catch(e1) {}\n\n          try {\n            return doc.queryCommandEnabled(command);\n          } catch(e2) {\n            return !!supported[command];\n          }\n        }\n        return false;\n      };\n    })(),\n\n    /**\n     * IE: URLs starting with:\n     *    www., http://, https://, ftp://, gopher://, mailto:, new:, snews:, telnet:, wasis:, file://,\n     *    nntp://, newsrc:, ldap://, ldaps://, outlook:, mic:// and url:\n     * will automatically be auto-linked when either the user inserts them via copy&paste or presses the\n     * space bar when the caret is directly after such an url.\n     * This behavior cannot easily be avoided in IE < 9 since the logic is hardcoded in the mshtml.dll\n     * (related blog post on msdn\n     * http://blogs.msdn.com/b/ieinternals/archive/2009/09/17/prevent-automatic-hyperlinking-in-contenteditable-html.aspx).\n     */\n    doesAutoLinkingInContentEditable: function() {\n      return isIE();\n    },\n\n    /**\n     * As stated above, IE auto links urls typed into contentEditable elements\n     * Since IE9 it's possible to prevent this behavior\n     */\n    canDisableAutoLinking: function() {\n      return this.supportsCommand(document, \"AutoUrlDetect\");\n    },\n\n    /**\n     * IE leaves an empty paragraph in the contentEditable element after clearing it\n     * Chrome/Safari sometimes an empty <div>\n     */\n    clearsContentEditableCorrectly: function() {\n      return isGecko || isOpera || isWebKit;\n    },\n\n    /**\n     * IE gives wrong results for getAttribute\n     */\n    supportsGetAttributeCorrectly: function() {\n      var td = document.createElement(\"td\");\n      return td.getAttribute(\"rowspan\") != \"1\";\n    },\n\n    /**\n     * When clicking on images in IE, Opera and Firefox, they are selected, which makes it easy to interact with them.\n     * Chrome and Safari both don't support this\n     */\n    canSelectImagesInContentEditable: function() {\n      return isGecko || isIE() || isOpera;\n    },\n\n    /**\n     * All browsers except Safari and Chrome automatically scroll the range/caret position into view\n     */\n    autoScrollsToCaret: function() {\n      return !isWebKit;\n    },\n\n    /**\n     * Check whether the browser automatically closes tags that don't need to be opened\n     */\n    autoClosesUnclosedTags: function() {\n      var clonedTestElement = testElement.cloneNode(false),\n          returnValue,\n          innerHTML;\n\n      clonedTestElement.innerHTML = \"<p><div></div>\";\n      innerHTML                   = clonedTestElement.innerHTML.toLowerCase();\n      returnValue                 = innerHTML === \"<p></p><div></div>\" || innerHTML === \"<p><div></div></p>\";\n\n      // Cache result by overwriting current function\n      this.autoClosesUnclosedTags = function() { return returnValue; };\n\n      return returnValue;\n    },\n\n    /**\n     * Whether the browser supports the native document.getElementsByClassName which returns live NodeLists\n     */\n    supportsNativeGetElementsByClassName: function() {\n      return String(document.getElementsByClassName).indexOf(\"[native code]\") !== -1;\n    },\n\n    /**\n     * As of now (19.04.2011) only supported by Firefox 4 and Chrome\n     * See https://developer.mozilla.org/en/DOM/Selection/modify\n     */\n    supportsSelectionModify: function() {\n      return \"getSelection\" in window && \"modify\" in window.getSelection();\n    },\n\n    /**\n     * Opera needs a white space after a <br> in order to position the caret correctly\n     */\n    needsSpaceAfterLineBreak: function() {\n      return isOpera;\n    },\n\n    /**\n     * Whether the browser supports the speech api on the given element\n     * See http://mikepultz.com/2011/03/accessing-google-speech-api-chrome-11/\n     *\n     * @example\n     *    var input = document.createElement(\"input\");\n     *    if (wysihtml5.browser.supportsSpeechApiOn(input)) {\n     *      // ...\n     *    }\n     */\n    supportsSpeechApiOn: function(input) {\n      var chromeVersion = userAgent.match(/Chrome\\/(\\d+)/) || [undefined, 0];\n      return chromeVersion[1] >= 11 && (\"onwebkitspeechchange\" in input || \"speech\" in input);\n    },\n\n    /**\n     * IE9 crashes when setting a getter via Object.defineProperty on XMLHttpRequest or XDomainRequest\n     * See https://connect.microsoft.com/ie/feedback/details/650112\n     * or try the POC http://tifftiff.de/ie9_crash/\n     */\n    crashesWhenDefineProperty: function(property) {\n      return isIE(9) && (property === \"XMLHttpRequest\" || property === \"XDomainRequest\");\n    },\n\n    /**\n     * IE is the only browser who fires the \"focus\" event not immediately when .focus() is called on an element\n     */\n    doesAsyncFocus: function() {\n      return isIE();\n    },\n\n    /**\n     * In IE it's impssible for the user and for the selection library to set the caret after an <img> when it's the lastChild in the document\n     */\n    hasProblemsSettingCaretAfterImg: function() {\n      return isIE();\n    },\n\n    hasUndoInContextMenu: function() {\n      return isGecko || isChrome || isOpera;\n    },\n\n    /**\n     * Opera sometimes doesn't insert the node at the right position when range.insertNode(someNode)\n     * is used (regardless if rangy or native)\n     * This especially happens when the caret is positioned right after a <br> because then\n     * insertNode() will insert the node right before the <br>\n     */\n    hasInsertNodeIssue: function() {\n      return isOpera;\n    },\n\n    /**\n     * IE 8+9 don't fire the focus event of the <body> when the iframe gets focused (even though the caret gets set into the <body>)\n     */\n    hasIframeFocusIssue: function() {\n      return isIE();\n    },\n\n    /**\n     * Chrome + Safari create invalid nested markup after paste\n     *\n     *  <p>\n     *    foo\n     *    <p>bar</p> <!-- BOO! -->\n     *  </p>\n     */\n    createsNestedInvalidMarkupAfterPaste: function() {\n      return isWebKit;\n    },\n\n    supportsMutationEvents: function() {\n        return (\"MutationEvent\" in window);\n    },\n\n    /**\n      IE (at least up to 11) does not support clipboardData on event.\n      It is on window but cannot return text/html\n      Should actually check for clipboardData on paste event, but cannot in firefox\n    */\n    supportsModenPaste: function () {\n      return !(\"clipboardData\" in window);\n    }\n  };\n})();\n;wysihtml5.lang.array = function(arr) {\n  return {\n    /**\n     * Check whether a given object exists in an array\n     *\n     * @example\n     *    wysihtml5.lang.array([1, 2]).contains(1);\n     *    // => true\n     *\n     * Can be used to match array with array. If intersection is found true is returned\n     */\n    contains: function(needle) {\n      if (Array.isArray(needle)) {\n        for (var i = needle.length; i--;) {\n          if (wysihtml5.lang.array(arr).indexOf(needle[i]) !== -1) {\n            return true;\n          }\n        }\n        return false;\n      } else {\n        return wysihtml5.lang.array(arr).indexOf(needle) !== -1;\n      }\n    },\n\n    /**\n     * Check whether a given object exists in an array and return index\n     * If no elelemt found returns -1\n     *\n     * @example\n     *    wysihtml5.lang.array([1, 2]).indexOf(2);\n     *    // => 1\n     */\n    indexOf: function(needle) {\n        if (arr.indexOf) {\n          return arr.indexOf(needle);\n        } else {\n          for (var i=0, length=arr.length; i<length; i++) {\n            if (arr[i] === needle) { return i; }\n          }\n          return -1;\n        }\n    },\n\n    /**\n     * Substract one array from another\n     *\n     * @example\n     *    wysihtml5.lang.array([1, 2, 3, 4]).without([3, 4]);\n     *    // => [1, 2]\n     */\n    without: function(arrayToSubstract) {\n      arrayToSubstract = wysihtml5.lang.array(arrayToSubstract);\n      var newArr  = [],\n          i       = 0,\n          length  = arr.length;\n      for (; i<length; i++) {\n        if (!arrayToSubstract.contains(arr[i])) {\n          newArr.push(arr[i]);\n        }\n      }\n      return newArr;\n    },\n\n    /**\n     * Return a clean native array\n     *\n     * Following will convert a Live NodeList to a proper Array\n     * @example\n     *    var childNodes = wysihtml5.lang.array(document.body.childNodes).get();\n     */\n    get: function() {\n      var i        = 0,\n          length   = arr.length,\n          newArray = [];\n      for (; i<length; i++) {\n        newArray.push(arr[i]);\n      }\n      return newArray;\n    },\n\n    /**\n     * Creates a new array with the results of calling a provided function on every element in this array.\n     * optionally this can be provided as second argument\n     *\n     * @example\n     *    var childNodes = wysihtml5.lang.array([1,2,3,4]).map(function (value, index, array) {\n            return value * 2;\n     *    });\n     *    // => [2,4,6,8]\n     */\n    map: function(callback, thisArg) {\n      if (Array.prototype.map) {\n        return arr.map(callback, thisArg);\n      } else {\n        var len = arr.length >>> 0,\n            A = new Array(len),\n            i = 0;\n        for (; i < len; i++) {\n           A[i] = callback.call(thisArg, arr[i], i, arr);\n        }\n        return A;\n      }\n    },\n\n    /* ReturnS new array without duplicate entries\n     *\n     * @example\n     *    var uniq = wysihtml5.lang.array([1,2,3,2,1,4]).unique();\n     *    // => [1,2,3,4]\n     */\n    unique: function() {\n      var vals = [],\n          max = arr.length,\n          idx = 0;\n\n      while (idx < max) {\n        if (!wysihtml5.lang.array(vals).contains(arr[idx])) {\n          vals.push(arr[idx]);\n        }\n        idx++;\n      }\n      return vals;\n    }\n\n  };\n};\n;wysihtml5.lang.Dispatcher = Base.extend(\n  /** @scope wysihtml5.lang.Dialog.prototype */ {\n  on: function(eventName, handler) {\n    this.events = this.events || {};\n    this.events[eventName] = this.events[eventName] || [];\n    this.events[eventName].push(handler);\n    return this;\n  },\n\n  off: function(eventName, handler) {\n    this.events = this.events || {};\n    var i = 0,\n        handlers,\n        newHandlers;\n    if (eventName) {\n      handlers    = this.events[eventName] || [],\n      newHandlers = [];\n      for (; i<handlers.length; i++) {\n        if (handlers[i] !== handler && handler) {\n          newHandlers.push(handlers[i]);\n        }\n      }\n      this.events[eventName] = newHandlers;\n    } else {\n      // Clean up all events\n      this.events = {};\n    }\n    return this;\n  },\n\n  fire: function(eventName, payload) {\n    this.events = this.events || {};\n    var handlers = this.events[eventName] || [],\n        i        = 0;\n    for (; i<handlers.length; i++) {\n      handlers[i].call(this, payload);\n    }\n    return this;\n  },\n\n  // deprecated, use .on()\n  observe: function() {\n    return this.on.apply(this, arguments);\n  },\n\n  // deprecated, use .off()\n  stopObserving: function() {\n    return this.off.apply(this, arguments);\n  }\n});\n;wysihtml5.lang.object = function(obj) {\n  return {\n    /**\n     * @example\n     *    wysihtml5.lang.object({ foo: 1, bar: 1 }).merge({ bar: 2, baz: 3 }).get();\n     *    // => { foo: 1, bar: 2, baz: 3 }\n     */\n    merge: function(otherObj) {\n      for (var i in otherObj) {\n        obj[i] = otherObj[i];\n      }\n      return this;\n    },\n\n    get: function() {\n      return obj;\n    },\n\n    /**\n     * @example\n     *    wysihtml5.lang.object({ foo: 1 }).clone();\n     *    // => { foo: 1 }\n     *\n     *    v0.4.14 adds options for deep clone : wysihtml5.lang.object({ foo: 1 }).clone(true);\n     */\n    clone: function(deep) {\n      var newObj = {},\n          i;\n\n      if (obj === null || !wysihtml5.lang.object(obj).isPlainObject()) {\n        return obj;\n      }\n\n      for (i in obj) {\n        if(obj.hasOwnProperty(i)) {\n          if (deep) {\n            newObj[i] = wysihtml5.lang.object(obj[i]).clone(deep);\n          } else {\n            newObj[i] = obj[i];\n          }\n        }\n      }\n      return newObj;\n    },\n\n    /**\n     * @example\n     *    wysihtml5.lang.object([]).isArray();\n     *    // => true\n     */\n    isArray: function() {\n      return Object.prototype.toString.call(obj) === \"[object Array]\";\n    },\n\n    /**\n     * @example\n     *    wysihtml5.lang.object(function() {}).isFunction();\n     *    // => true\n     */\n    isFunction: function() {\n      return Object.prototype.toString.call(obj) === '[object Function]';\n    },\n\n    isPlainObject: function () {\n      return Object.prototype.toString.call(obj) === '[object Object]';\n    }\n  };\n};\n;(function() {\n  var WHITE_SPACE_START = /^\\s+/,\n      WHITE_SPACE_END   = /\\s+$/,\n      ENTITY_REG_EXP    = /[&<>\\t\"]/g,\n      ENTITY_MAP = {\n        '&': '&amp;',\n        '<': '&lt;',\n        '>': '&gt;',\n        '\"': \"&quot;\",\n        '\\t':\"&nbsp; \"\n      };\n  wysihtml5.lang.string = function(str) {\n    str = String(str);\n    return {\n      /**\n       * @example\n       *    wysihtml5.lang.string(\"   foo   \").trim();\n       *    // => \"foo\"\n       */\n      trim: function() {\n        return str.replace(WHITE_SPACE_START, \"\").replace(WHITE_SPACE_END, \"\");\n      },\n\n      /**\n       * @example\n       *    wysihtml5.lang.string(\"Hello #{name}\").interpolate({ name: \"Christopher\" });\n       *    // => \"Hello Christopher\"\n       */\n      interpolate: function(vars) {\n        for (var i in vars) {\n          str = this.replace(\"#{\" + i + \"}\").by(vars[i]);\n        }\n        return str;\n      },\n\n      /**\n       * @example\n       *    wysihtml5.lang.string(\"Hello Tom\").replace(\"Tom\").with(\"Hans\");\n       *    // => \"Hello Hans\"\n       */\n      replace: function(search) {\n        return {\n          by: function(replace) {\n            return str.split(search).join(replace);\n          }\n        };\n      },\n\n      /**\n       * @example\n       *    wysihtml5.lang.string(\"hello<br>\").escapeHTML();\n       *    // => \"hello&lt;br&gt;\"\n       */\n      escapeHTML: function(linebreaks, convertSpaces) {\n        var html = str.replace(ENTITY_REG_EXP, function(c) { return ENTITY_MAP[c]; });\n        if (linebreaks) {\n          html = html.replace(/(?:\\r\\n|\\r|\\n)/g, '<br />');\n        }\n        if (convertSpaces) {\n          html = html.replace(/  /gi, \"&nbsp; \");\n        }\n        return html;\n      }\n    };\n  };\n})();\n;/**\n * Find urls in descendant text nodes of an element and auto-links them\n * Inspired by http://james.padolsey.com/javascript/find-and-replace-text-with-javascript/\n *\n * @param {Element} element Container element in which to search for urls\n *\n * @example\n *    <div id=\"text-container\">Please click here: www.google.com</div>\n *    <script>wysihtml5.dom.autoLink(document.getElementById(\"text-container\"));</script>\n */\n(function(wysihtml5) {\n  var /**\n       * Don't auto-link urls that are contained in the following elements:\n       */\n      IGNORE_URLS_IN        = wysihtml5.lang.array([\"CODE\", \"PRE\", \"A\", \"SCRIPT\", \"HEAD\", \"TITLE\", \"STYLE\"]),\n      /**\n       * revision 1:\n       *    /(\\S+\\.{1}[^\\s\\,\\.\\!]+)/g\n       *\n       * revision 2:\n       *    /(\\b(((https?|ftp):\\/\\/)|(www\\.))[-A-Z0-9+&@#\\/%?=~_|!:,.;\\[\\]]*[-A-Z0-9+&@#\\/%=~_|])/gim\n       *\n       * put this in the beginning if you don't wan't to match within a word\n       *    (^|[\\>\\(\\{\\[\\s\\>])\n       */\n      URL_REG_EXP           = /((https?:\\/\\/|www\\.)[^\\s<]{3,})/gi,\n      TRAILING_CHAR_REG_EXP = /([^\\w\\/\\-](,?))$/i,\n      MAX_DISPLAY_LENGTH    = 100,\n      BRACKETS              = { \")\": \"(\", \"]\": \"[\", \"}\": \"{\" };\n\n  function autoLink(element, ignoreInClasses) {\n    if (_hasParentThatShouldBeIgnored(element, ignoreInClasses)) {\n      return element;\n    }\n\n    if (element === element.ownerDocument.documentElement) {\n      element = element.ownerDocument.body;\n    }\n\n    return _parseNode(element, ignoreInClasses);\n  }\n\n  /**\n   * This is basically a rebuild of\n   * the rails auto_link_urls text helper\n   */\n  function _convertUrlsToLinks(str) {\n    return str.replace(URL_REG_EXP, function(match, url) {\n      var punctuation = (url.match(TRAILING_CHAR_REG_EXP) || [])[1] || \"\",\n          opening     = BRACKETS[punctuation];\n      url = url.replace(TRAILING_CHAR_REG_EXP, \"\");\n\n      if (url.split(opening).length > url.split(punctuation).length) {\n        url = url + punctuation;\n        punctuation = \"\";\n      }\n      var realUrl    = url,\n          displayUrl = url;\n      if (url.length > MAX_DISPLAY_LENGTH) {\n        displayUrl = displayUrl.substr(0, MAX_DISPLAY_LENGTH) + \"...\";\n      }\n      // Add http prefix if necessary\n      if (realUrl.substr(0, 4) === \"www.\") {\n        realUrl = \"http://\" + realUrl;\n      }\n\n      return '<a href=\"' + realUrl + '\">' + displayUrl + '</a>' + punctuation;\n    });\n  }\n\n  /**\n   * Creates or (if already cached) returns a temp element\n   * for the given document object\n   */\n  function _getTempElement(context) {\n    var tempElement = context._wysihtml5_tempElement;\n    if (!tempElement) {\n      tempElement = context._wysihtml5_tempElement = context.createElement(\"div\");\n    }\n    return tempElement;\n  }\n\n  /**\n   * Replaces the original text nodes with the newly auto-linked dom tree\n   */\n  function _wrapMatchesInNode(textNode) {\n    var parentNode  = textNode.parentNode,\n        nodeValue   = wysihtml5.lang.string(textNode.data).escapeHTML(),\n        tempElement = _getTempElement(parentNode.ownerDocument);\n\n    // We need to insert an empty/temporary <span /> to fix IE quirks\n    // Elsewise IE would strip white space in the beginning\n    tempElement.innerHTML = \"<span></span>\" + _convertUrlsToLinks(nodeValue);\n    tempElement.removeChild(tempElement.firstChild);\n\n    while (tempElement.firstChild) {\n      // inserts tempElement.firstChild before textNode\n      parentNode.insertBefore(tempElement.firstChild, textNode);\n    }\n    parentNode.removeChild(textNode);\n  }\n\n  function _hasParentThatShouldBeIgnored(node, ignoreInClasses) {\n    var nodeName;\n    while (node.parentNode) {\n      node = node.parentNode;\n      nodeName = node.nodeName;\n      if (node.className && wysihtml5.lang.array(node.className.split(' ')).contains(ignoreInClasses)) {\n        return true;\n      }\n      if (IGNORE_URLS_IN.contains(nodeName)) {\n        return true;\n      } else if (nodeName === \"body\") {\n        return false;\n      }\n    }\n    return false;\n  }\n\n  function _parseNode(element, ignoreInClasses) {\n    if (IGNORE_URLS_IN.contains(element.nodeName)) {\n      return;\n    }\n\n    if (element.className && wysihtml5.lang.array(element.className.split(' ')).contains(ignoreInClasses)) {\n      return;\n    }\n\n    if (element.nodeType === wysihtml5.TEXT_NODE && element.data.match(URL_REG_EXP)) {\n      _wrapMatchesInNode(element);\n      return;\n    }\n\n    var childNodes        = wysihtml5.lang.array(element.childNodes).get(),\n        childNodesLength  = childNodes.length,\n        i                 = 0;\n\n    for (; i<childNodesLength; i++) {\n      _parseNode(childNodes[i], ignoreInClasses);\n    }\n\n    return element;\n  }\n\n  wysihtml5.dom.autoLink = autoLink;\n\n  // Reveal url reg exp to the outside\n  wysihtml5.dom.autoLink.URL_REG_EXP = URL_REG_EXP;\n})(wysihtml5);\n;(function(wysihtml5) {\n  var api = wysihtml5.dom;\n\n  api.addClass = function(element, className) {\n    var classList = element.classList;\n    if (classList) {\n      return classList.add(className);\n    }\n    if (api.hasClass(element, className)) {\n      return;\n    }\n    element.className += \" \" + className;\n  };\n\n  api.removeClass = function(element, className) {\n    var classList = element.classList;\n    if (classList) {\n      return classList.remove(className);\n    }\n\n    element.className = element.className.replace(new RegExp(\"(^|\\\\s+)\" + className + \"(\\\\s+|$)\"), \" \");\n  };\n\n  api.hasClass = function(element, className) {\n    var classList = element.classList;\n    if (classList) {\n      return classList.contains(className);\n    }\n\n    var elementClassName = element.className;\n    return (elementClassName.length > 0 && (elementClassName == className || new RegExp(\"(^|\\\\s)\" + className + \"(\\\\s|$)\").test(elementClassName)));\n  };\n})(wysihtml5);\n;wysihtml5.dom.contains = (function() {\n  var documentElement = document.documentElement;\n  if (documentElement.contains) {\n    return function(container, element) {\n      if (element.nodeType !== wysihtml5.ELEMENT_NODE) {\n        element = element.parentNode;\n      }\n      return container !== element && container.contains(element);\n    };\n  } else if (documentElement.compareDocumentPosition) {\n    return function(container, element) {\n      // https://developer.mozilla.org/en/DOM/Node.compareDocumentPosition\n      return !!(container.compareDocumentPosition(element) & 16);\n    };\n  }\n})();\n;/**\n * Converts an HTML fragment/element into a unordered/ordered list\n *\n * @param {Element} element The element which should be turned into a list\n * @param {String} listType The list type in which to convert the tree (either \"ul\" or \"ol\")\n * @return {Element} The created list\n *\n * @example\n *    <!-- Assume the following dom: -->\n *    <span id=\"pseudo-list\">\n *      eminem<br>\n *      dr. dre\n *      <div>50 Cent</div>\n *    </span>\n *\n *    <script>\n *      wysihtml5.dom.convertToList(document.getElementById(\"pseudo-list\"), \"ul\");\n *    </script>\n *\n *    <!-- Will result in: -->\n *    <ul>\n *      <li>eminem</li>\n *      <li>dr. dre</li>\n *      <li>50 Cent</li>\n *    </ul>\n */\nwysihtml5.dom.convertToList = (function() {\n  function _createListItem(doc, list) {\n    var listItem = doc.createElement(\"li\");\n    list.appendChild(listItem);\n    return listItem;\n  }\n\n  function _createList(doc, type) {\n    return doc.createElement(type);\n  }\n\n  function convertToList(element, listType, uneditableClass) {\n    if (element.nodeName === \"UL\" || element.nodeName === \"OL\" || element.nodeName === \"MENU\") {\n      // Already a list\n      return element;\n    }\n\n    var doc               = element.ownerDocument,\n        list              = _createList(doc, listType),\n        lineBreaks        = element.querySelectorAll(\"br\"),\n        lineBreaksLength  = lineBreaks.length,\n        childNodes,\n        childNodesLength,\n        childNode,\n        lineBreak,\n        parentNode,\n        isBlockElement,\n        isLineBreak,\n        currentListItem,\n        i;\n\n    // First find <br> at the end of inline elements and move them behind them\n    for (i=0; i<lineBreaksLength; i++) {\n      lineBreak = lineBreaks[i];\n      while ((parentNode = lineBreak.parentNode) && parentNode !== element && parentNode.lastChild === lineBreak) {\n        if (wysihtml5.dom.getStyle(\"display\").from(parentNode) === \"block\") {\n          parentNode.removeChild(lineBreak);\n          break;\n        }\n        wysihtml5.dom.insert(lineBreak).after(lineBreak.parentNode);\n      }\n    }\n\n    childNodes        = wysihtml5.lang.array(element.childNodes).get();\n    childNodesLength  = childNodes.length;\n\n    for (i=0; i<childNodesLength; i++) {\n      currentListItem   = currentListItem || _createListItem(doc, list);\n      childNode         = childNodes[i];\n      isBlockElement    = wysihtml5.dom.getStyle(\"display\").from(childNode) === \"block\";\n      isLineBreak       = childNode.nodeName === \"BR\";\n\n      // consider uneditable as an inline element\n      if (isBlockElement && (!uneditableClass || !wysihtml5.dom.hasClass(childNode, uneditableClass))) {\n        // Append blockElement to current <li> if empty, otherwise create a new one\n        currentListItem = currentListItem.firstChild ? _createListItem(doc, list) : currentListItem;\n        currentListItem.appendChild(childNode);\n        currentListItem = null;\n        continue;\n      }\n\n      if (isLineBreak) {\n        // Only create a new list item in the next iteration when the current one has already content\n        currentListItem = currentListItem.firstChild ? null : currentListItem;\n        continue;\n      }\n\n      currentListItem.appendChild(childNode);\n    }\n\n    if (childNodes.length === 0) {\n      _createListItem(doc, list);\n    }\n\n    element.parentNode.replaceChild(list, element);\n    return list;\n  }\n\n  return convertToList;\n})();\n;/**\n * Copy a set of attributes from one element to another\n *\n * @param {Array} attributesToCopy List of attributes which should be copied\n * @return {Object} Returns an object which offers the \"from\" method which can be invoked with the element where to\n *    copy the attributes from., this again returns an object which provides a method named \"to\" which can be invoked\n *    with the element where to copy the attributes to (see example)\n *\n * @example\n *    var textarea    = document.querySelector(\"textarea\"),\n *        div         = document.querySelector(\"div[contenteditable=true]\"),\n *        anotherDiv  = document.querySelector(\"div.preview\");\n *    wysihtml5.dom.copyAttributes([\"spellcheck\", \"value\", \"placeholder\"]).from(textarea).to(div).andTo(anotherDiv);\n *\n */\nwysihtml5.dom.copyAttributes = function(attributesToCopy) {\n  return {\n    from: function(elementToCopyFrom) {\n      return {\n        to: function(elementToCopyTo) {\n          var attribute,\n              i         = 0,\n              length    = attributesToCopy.length;\n          for (; i<length; i++) {\n            attribute = attributesToCopy[i];\n            if (typeof(elementToCopyFrom[attribute]) !== \"undefined\" && elementToCopyFrom[attribute] !== \"\") {\n              elementToCopyTo[attribute] = elementToCopyFrom[attribute];\n            }\n          }\n          return { andTo: arguments.callee };\n        }\n      };\n    }\n  };\n};\n;/**\n * Copy a set of styles from one element to another\n * Please note that this only works properly across browsers when the element from which to copy the styles\n * is in the dom\n *\n * Interesting article on how to copy styles\n *\n * @param {Array} stylesToCopy List of styles which should be copied\n * @return {Object} Returns an object which offers the \"from\" method which can be invoked with the element where to\n *    copy the styles from., this again returns an object which provides a method named \"to\" which can be invoked\n *    with the element where to copy the styles to (see example)\n *\n * @example\n *    var textarea    = document.querySelector(\"textarea\"),\n *        div         = document.querySelector(\"div[contenteditable=true]\"),\n *        anotherDiv  = document.querySelector(\"div.preview\");\n *    wysihtml5.dom.copyStyles([\"overflow-y\", \"width\", \"height\"]).from(textarea).to(div).andTo(anotherDiv);\n *\n */\n(function(dom) {\n\n  /**\n   * Mozilla, WebKit and Opera recalculate the computed width when box-sizing: boder-box; is set\n   * So if an element has \"width: 200px; -moz-box-sizing: border-box; border: 1px;\" then\n   * its computed css width will be 198px\n   *\n   * See https://bugzilla.mozilla.org/show_bug.cgi?id=520992\n   */\n  var BOX_SIZING_PROPERTIES = [\"-webkit-box-sizing\", \"-moz-box-sizing\", \"-ms-box-sizing\", \"box-sizing\"];\n\n  var shouldIgnoreBoxSizingBorderBox = function(element) {\n    if (hasBoxSizingBorderBox(element)) {\n       return parseInt(dom.getStyle(\"width\").from(element), 10) < element.offsetWidth;\n    }\n    return false;\n  };\n\n  var hasBoxSizingBorderBox = function(element) {\n    var i       = 0,\n        length  = BOX_SIZING_PROPERTIES.length;\n    for (; i<length; i++) {\n      if (dom.getStyle(BOX_SIZING_PROPERTIES[i]).from(element) === \"border-box\") {\n        return BOX_SIZING_PROPERTIES[i];\n      }\n    }\n  };\n\n  dom.copyStyles = function(stylesToCopy) {\n    return {\n      from: function(element) {\n        if (shouldIgnoreBoxSizingBorderBox(element)) {\n          stylesToCopy = wysihtml5.lang.array(stylesToCopy).without(BOX_SIZING_PROPERTIES);\n        }\n\n        var cssText = \"\",\n            length  = stylesToCopy.length,\n            i       = 0,\n            property;\n        for (; i<length; i++) {\n          property = stylesToCopy[i];\n          cssText += property + \":\" + dom.getStyle(property).from(element) + \";\";\n        }\n\n        return {\n          to: function(element) {\n            dom.setStyles(cssText).on(element);\n            return { andTo: arguments.callee };\n          }\n        };\n      }\n    };\n  };\n})(wysihtml5.dom);\n;/**\n * Event Delegation\n *\n * @example\n *    wysihtml5.dom.delegate(document.body, \"a\", \"click\", function() {\n *      // foo\n *    });\n */\n(function(wysihtml5) {\n\n  wysihtml5.dom.delegate = function(container, selector, eventName, handler) {\n    return wysihtml5.dom.observe(container, eventName, function(event) {\n      var target    = event.target,\n          match     = wysihtml5.lang.array(container.querySelectorAll(selector));\n\n      while (target && target !== container) {\n        if (match.contains(target)) {\n          handler.call(target, event);\n          break;\n        }\n        target = target.parentNode;\n      }\n    });\n  };\n\n})(wysihtml5);\n;// TODO: Refactor dom tree traversing here\n(function(wysihtml5) {\n  wysihtml5.dom.domNode = function(node) {\n    var defaultNodeTypes = [wysihtml5.ELEMENT_NODE, wysihtml5.TEXT_NODE];\n\n    var _isBlankText = function(node) {\n      return node.nodeType === wysihtml5.TEXT_NODE && (/^\\s*$/g).test(node.data);\n    };\n\n    return {\n\n      // var node = wysihtml5.dom.domNode(element).prev({nodeTypes: [1,3], ignoreBlankTexts: true});\n      prev: function(options) {\n        var prevNode = node.previousSibling,\n            types = (options && options.nodeTypes) ? options.nodeTypes : defaultNodeTypes;\n        \n        if (!prevNode) {\n          return null;\n        }\n\n        if (\n          (!wysihtml5.lang.array(types).contains(prevNode.nodeType)) || // nodeTypes check.\n          (options && options.ignoreBlankTexts && _isBlankText(prevNode)) // Blank text nodes bypassed if set\n        ) {\n          return wysihtml5.dom.domNode(prevNode).prev(options);\n        }\n        \n        return prevNode;\n      },\n\n      // var node = wysihtml5.dom.domNode(element).next({nodeTypes: [1,3], ignoreBlankTexts: true});\n      next: function(options) {\n        var nextNode = node.nextSibling,\n            types = (options && options.nodeTypes) ? options.nodeTypes : defaultNodeTypes;\n        \n        if (!nextNode) {\n          return null;\n        }\n\n        if (\n          (!wysihtml5.lang.array(types).contains(nextNode.nodeType)) || // nodeTypes check.\n          (options && options.ignoreBlankTexts && _isBlankText(nextNode)) // blank text nodes bypassed if set\n        ) {\n          return wysihtml5.dom.domNode(nextNode).next(options);\n        }\n        \n        return nextNode;\n      }\n\n\n\n    };\n  };\n})(wysihtml5);;/**\n * Returns the given html wrapped in a div element\n *\n * Fixing IE's inability to treat unknown elements (HTML5 section, article, ...) correctly\n * when inserted via innerHTML\n *\n * @param {String} html The html which should be wrapped in a dom element\n * @param {Obejct} [context] Document object of the context the html belongs to\n *\n * @example\n *    wysihtml5.dom.getAsDom(\"<article>foo</article>\");\n */\nwysihtml5.dom.getAsDom = (function() {\n\n  var _innerHTMLShiv = function(html, context) {\n    var tempElement = context.createElement(\"div\");\n    tempElement.style.display = \"none\";\n    context.body.appendChild(tempElement);\n    // IE throws an exception when trying to insert <frameset></frameset> via innerHTML\n    try { tempElement.innerHTML = html; } catch(e) {}\n    context.body.removeChild(tempElement);\n    return tempElement;\n  };\n\n  /**\n   * Make sure IE supports HTML5 tags, which is accomplished by simply creating one instance of each element\n   */\n  var _ensureHTML5Compatibility = function(context) {\n    if (context._wysihtml5_supportsHTML5Tags) {\n      return;\n    }\n    for (var i=0, length=HTML5_ELEMENTS.length; i<length; i++) {\n      context.createElement(HTML5_ELEMENTS[i]);\n    }\n    context._wysihtml5_supportsHTML5Tags = true;\n  };\n\n\n  /**\n   * List of html5 tags\n   * taken from http://simon.html5.org/html5-elements\n   */\n  var HTML5_ELEMENTS = [\n    \"abbr\", \"article\", \"aside\", \"audio\", \"bdi\", \"canvas\", \"command\", \"datalist\", \"details\", \"figcaption\",\n    \"figure\", \"footer\", \"header\", \"hgroup\", \"keygen\", \"mark\", \"meter\", \"nav\", \"output\", \"progress\",\n    \"rp\", \"rt\", \"ruby\", \"svg\", \"section\", \"source\", \"summary\", \"time\", \"track\", \"video\", \"wbr\"\n  ];\n\n  return function(html, context) {\n    context = context || document;\n    var tempElement;\n    if (typeof(html) === \"object\" && html.nodeType) {\n      tempElement = context.createElement(\"div\");\n      tempElement.appendChild(html);\n    } else if (wysihtml5.browser.supportsHTML5Tags(context)) {\n      tempElement = context.createElement(\"div\");\n      tempElement.innerHTML = html;\n    } else {\n      _ensureHTML5Compatibility(context);\n      tempElement = _innerHTMLShiv(html, context);\n    }\n    return tempElement;\n  };\n})();\n;/**\n * Walks the dom tree from the given node up until it finds a match\n * Designed for optimal performance.\n *\n * @param {Element} node The from which to check the parent nodes\n * @param {Object} matchingSet Object to match against (possible properties: nodeName, className, classRegExp)\n * @param {Number} [levels] How many parents should the function check up from the current node (defaults to 50)\n * @return {null|Element} Returns the first element that matched the desiredNodeName(s)\n * @example\n *    var listElement = wysihtml5.dom.getParentElement(document.querySelector(\"li\"), { nodeName: [\"MENU\", \"UL\", \"OL\"] });\n *    // ... or ...\n *    var unorderedListElement = wysihtml5.dom.getParentElement(document.querySelector(\"li\"), { nodeName: \"UL\" });\n *    // ... or ...\n *    var coloredElement = wysihtml5.dom.getParentElement(myTextNode, { nodeName: \"SPAN\", className: \"wysiwyg-color-red\", classRegExp: /wysiwyg-color-[a-z]/g });\n */\nwysihtml5.dom.getParentElement = (function() {\n\n  function _isSameNodeName(nodeName, desiredNodeNames) {\n    if (!desiredNodeNames || !desiredNodeNames.length) {\n      return true;\n    }\n\n    if (typeof(desiredNodeNames) === \"string\") {\n      return nodeName === desiredNodeNames;\n    } else {\n      return wysihtml5.lang.array(desiredNodeNames).contains(nodeName);\n    }\n  }\n\n  function _isElement(node) {\n    return node.nodeType === wysihtml5.ELEMENT_NODE;\n  }\n\n  function _hasClassName(element, className, classRegExp) {\n    var classNames = (element.className || \"\").match(classRegExp) || [];\n    if (!className) {\n      return !!classNames.length;\n    }\n    return classNames[classNames.length - 1] === className;\n  }\n\n  function _hasStyle(element, cssStyle, styleRegExp) {\n    var styles = (element.getAttribute('style') || \"\").match(styleRegExp) || [];\n    if (!cssStyle) {\n      return !!styles.length;\n    }\n    return styles[styles.length - 1] === cssStyle;\n  }\n\n  return function(node, matchingSet, levels, container) {\n    var findByStyle = (matchingSet.cssStyle || matchingSet.styleRegExp),\n        findByClass = (matchingSet.className || matchingSet.classRegExp);\n\n    levels = levels || 50; // Go max 50 nodes upwards from current node\n\n    while (levels-- && node && node.nodeName !== \"BODY\" && (!container || node !== container)) {\n      if (_isElement(node) && _isSameNodeName(node.nodeName, matchingSet.nodeName) &&\n          (!findByStyle || _hasStyle(node, matchingSet.cssStyle, matchingSet.styleRegExp)) &&\n          (!findByClass || _hasClassName(node, matchingSet.className, matchingSet.classRegExp))\n      ) {\n        return node;\n      }\n      node = node.parentNode;\n    }\n    return null;\n  };\n})();\n;/**\n * Get element's style for a specific css property\n *\n * @param {Element} element The element on which to retrieve the style\n * @param {String} property The CSS property to retrieve (\"float\", \"display\", \"text-align\", ...)\n *\n * @example\n *    wysihtml5.dom.getStyle(\"display\").from(document.body);\n *    // => \"block\"\n */\nwysihtml5.dom.getStyle = (function() {\n  var stylePropertyMapping = {\n        \"float\": (\"styleFloat\" in document.createElement(\"div\").style) ? \"styleFloat\" : \"cssFloat\"\n      },\n      REG_EXP_CAMELIZE = /\\-[a-z]/g;\n\n  function camelize(str) {\n    return str.replace(REG_EXP_CAMELIZE, function(match) {\n      return match.charAt(1).toUpperCase();\n    });\n  }\n\n  return function(property) {\n    return {\n      from: function(element) {\n        if (element.nodeType !== wysihtml5.ELEMENT_NODE) {\n          return;\n        }\n\n        var doc               = element.ownerDocument,\n            camelizedProperty = stylePropertyMapping[property] || camelize(property),\n            style             = element.style,\n            currentStyle      = element.currentStyle,\n            styleValue        = style[camelizedProperty];\n        if (styleValue) {\n          return styleValue;\n        }\n\n        // currentStyle is no standard and only supported by Opera and IE but it has one important advantage over the standard-compliant\n        // window.getComputedStyle, since it returns css property values in their original unit:\n        // If you set an elements width to \"50%\", window.getComputedStyle will give you it's current width in px while currentStyle\n        // gives you the original \"50%\".\n        // Opera supports both, currentStyle and window.getComputedStyle, that's why checking for currentStyle should have higher prio\n        if (currentStyle) {\n          try {\n            return currentStyle[camelizedProperty];\n          } catch(e) {\n            //ie will occasionally fail for unknown reasons. swallowing exception\n          }\n        }\n\n        var win                 = doc.defaultView || doc.parentWindow,\n            needsOverflowReset  = (property === \"height\" || property === \"width\") && element.nodeName === \"TEXTAREA\",\n            originalOverflow,\n            returnValue;\n\n        if (win.getComputedStyle) {\n          // Chrome and Safari both calculate a wrong width and height for textareas when they have scroll bars\n          // therfore we remove and restore the scrollbar and calculate the value in between\n          if (needsOverflowReset) {\n            originalOverflow = style.overflow;\n            style.overflow = \"hidden\";\n          }\n          returnValue = win.getComputedStyle(element, null).getPropertyValue(property);\n          if (needsOverflowReset) {\n            style.overflow = originalOverflow || \"\";\n          }\n          return returnValue;\n        }\n      }\n    };\n  };\n})();\n;wysihtml5.dom.getTextNodes = function(node, ingoreEmpty){\n  var all = [];\n  for (node=node.firstChild;node;node=node.nextSibling){\n    if (node.nodeType == 3) {\n      if (!ingoreEmpty || !(/^\\s*$/).test(node.innerText || node.textContent)) {\n        all.push(node);\n      }\n    } else {\n      all = all.concat(wysihtml5.dom.getTextNodes(node, ingoreEmpty));\n    }\n  }\n  return all;\n};;/**\n * High performant way to check whether an element with a specific tag name is in the given document\n * Optimized for being heavily executed\n * Unleashes the power of live node lists\n *\n * @param {Object} doc The document object of the context where to check\n * @param {String} tagName Upper cased tag name\n * @example\n *    wysihtml5.dom.hasElementWithTagName(document, \"IMG\");\n */\nwysihtml5.dom.hasElementWithTagName = (function() {\n  var LIVE_CACHE          = {},\n      DOCUMENT_IDENTIFIER = 1;\n\n  function _getDocumentIdentifier(doc) {\n    return doc._wysihtml5_identifier || (doc._wysihtml5_identifier = DOCUMENT_IDENTIFIER++);\n  }\n\n  return function(doc, tagName) {\n    var key         = _getDocumentIdentifier(doc) + \":\" + tagName,\n        cacheEntry  = LIVE_CACHE[key];\n    if (!cacheEntry) {\n      cacheEntry = LIVE_CACHE[key] = doc.getElementsByTagName(tagName);\n    }\n\n    return cacheEntry.length > 0;\n  };\n})();\n;/**\n * High performant way to check whether an element with a specific class name is in the given document\n * Optimized for being heavily executed\n * Unleashes the power of live node lists\n *\n * @param {Object} doc The document object of the context where to check\n * @param {String} tagName Upper cased tag name\n * @example\n *    wysihtml5.dom.hasElementWithClassName(document, \"foobar\");\n */\n(function(wysihtml5) {\n  var LIVE_CACHE          = {},\n      DOCUMENT_IDENTIFIER = 1;\n\n  function _getDocumentIdentifier(doc) {\n    return doc._wysihtml5_identifier || (doc._wysihtml5_identifier = DOCUMENT_IDENTIFIER++);\n  }\n\n  wysihtml5.dom.hasElementWithClassName = function(doc, className) {\n    // getElementsByClassName is not supported by IE<9\n    // but is sometimes mocked via library code (which then doesn't return live node lists)\n    if (!wysihtml5.browser.supportsNativeGetElementsByClassName()) {\n      return !!doc.querySelector(\".\" + className);\n    }\n\n    var key         = _getDocumentIdentifier(doc) + \":\" + className,\n        cacheEntry  = LIVE_CACHE[key];\n    if (!cacheEntry) {\n      cacheEntry = LIVE_CACHE[key] = doc.getElementsByClassName(className);\n    }\n\n    return cacheEntry.length > 0;\n  };\n})(wysihtml5);\n;wysihtml5.dom.insert = function(elementToInsert) {\n  return {\n    after: function(element) {\n      element.parentNode.insertBefore(elementToInsert, element.nextSibling);\n    },\n\n    before: function(element) {\n      element.parentNode.insertBefore(elementToInsert, element);\n    },\n\n    into: function(element) {\n      element.appendChild(elementToInsert);\n    }\n  };\n};\n;wysihtml5.dom.insertCSS = function(rules) {\n  rules = rules.join(\"\\n\");\n\n  return {\n    into: function(doc) {\n      var styleElement = doc.createElement(\"style\");\n      styleElement.type = \"text/css\";\n\n      if (styleElement.styleSheet) {\n        styleElement.styleSheet.cssText = rules;\n      } else {\n        styleElement.appendChild(doc.createTextNode(rules));\n      }\n\n      var link = doc.querySelector(\"head link\");\n      if (link) {\n        link.parentNode.insertBefore(styleElement, link);\n        return;\n      } else {\n        var head = doc.querySelector(\"head\");\n        if (head) {\n          head.appendChild(styleElement);\n        }\n      }\n    }\n  };\n};\n;// TODO: Refactor dom tree traversing here\n(function(wysihtml5) {\n  wysihtml5.dom.lineBreaks = function(node) {\n\n    function _isLineBreak(n) {\n      return n.nodeName === \"BR\";\n    }\n\n    /**\n     * Checks whether the elment causes a visual line break\n     * (<br> or block elements)\n     */\n    function _isLineBreakOrBlockElement(element) {\n      if (_isLineBreak(element)) {\n        return true;\n      }\n\n      if (wysihtml5.dom.getStyle(\"display\").from(element) === \"block\") {\n        return true;\n      }\n\n      return false;\n    }\n\n    return {\n\n      /* wysihtml5.dom.lineBreaks(element).add();\n       *\n       * Adds line breaks before and after the given node if the previous and next siblings\n       * aren't already causing a visual line break (block element or <br>)\n       */\n      add: function(options) {\n        var doc             = node.ownerDocument,\n          nextSibling     = wysihtml5.dom.domNode(node).next({ignoreBlankTexts: true}),\n          previousSibling = wysihtml5.dom.domNode(node).prev({ignoreBlankTexts: true});\n\n        if (nextSibling && !_isLineBreakOrBlockElement(nextSibling)) {\n          wysihtml5.dom.insert(doc.createElement(\"br\")).after(node);\n        }\n        if (previousSibling && !_isLineBreakOrBlockElement(previousSibling)) {\n          wysihtml5.dom.insert(doc.createElement(\"br\")).before(node);\n        }\n      },\n\n      /* wysihtml5.dom.lineBreaks(element).remove();\n       *\n       * Removes line breaks before and after the given node\n       */\n      remove: function(options) {\n        var nextSibling     = wysihtml5.dom.domNode(node).next({ignoreBlankTexts: true}),\n            previousSibling = wysihtml5.dom.domNode(node).prev({ignoreBlankTexts: true});\n\n        if (nextSibling && _isLineBreak(nextSibling)) {\n          nextSibling.parentNode.removeChild(nextSibling);\n        }\n        if (previousSibling && _isLineBreak(previousSibling)) {\n          previousSibling.parentNode.removeChild(previousSibling);\n        }\n      }\n    };\n  };\n})(wysihtml5);;/**\n * Method to set dom events\n *\n * @example\n *    wysihtml5.dom.observe(iframe.contentWindow.document.body, [\"focus\", \"blur\"], function() { ... });\n */\nwysihtml5.dom.observe = function(element, eventNames, handler) {\n  eventNames = typeof(eventNames) === \"string\" ? [eventNames] : eventNames;\n\n  var handlerWrapper,\n      eventName,\n      i       = 0,\n      length  = eventNames.length;\n\n  for (; i<length; i++) {\n    eventName = eventNames[i];\n    if (element.addEventListener) {\n      element.addEventListener(eventName, handler, false);\n    } else {\n      handlerWrapper = function(event) {\n        if (!(\"target\" in event)) {\n          event.target = event.srcElement;\n        }\n        event.preventDefault = event.preventDefault || function() {\n          this.returnValue = false;\n        };\n        event.stopPropagation = event.stopPropagation || function() {\n          this.cancelBubble = true;\n        };\n        handler.call(element, event);\n      };\n      element.attachEvent(\"on\" + eventName, handlerWrapper);\n    }\n  }\n\n  return {\n    stop: function() {\n      var eventName,\n          i       = 0,\n          length  = eventNames.length;\n      for (; i<length; i++) {\n        eventName = eventNames[i];\n        if (element.removeEventListener) {\n          element.removeEventListener(eventName, handler, false);\n        } else {\n          element.detachEvent(\"on\" + eventName, handlerWrapper);\n        }\n      }\n    }\n  };\n};\n;/**\n * HTML Sanitizer\n * Rewrites the HTML based on given rules\n *\n * @param {Element|String} elementOrHtml HTML String to be sanitized OR element whose content should be sanitized\n * @param {Object} [rules] List of rules for rewriting the HTML, if there's no rule for an element it will\n *    be converted to a \"span\". Each rule is a key/value pair where key is the tag to convert, and value the\n *    desired substitution.\n * @param {Object} context Document object in which to parse the html, needed to sandbox the parsing\n *\n * @return {Element|String} Depends on the elementOrHtml parameter. When html then the sanitized html as string elsewise the element.\n *\n * @example\n *    var userHTML = '<div id=\"foo\" onclick=\"alert(1);\"><p><font color=\"red\">foo</font><script>alert(1);</script></p></div>';\n *    wysihtml5.dom.parse(userHTML, {\n *      tags {\n *        p:      \"div\",      // Rename p tags to div tags\n *        font:   \"span\"      // Rename font tags to span tags\n *        div:    true,       // Keep them, also possible (same result when passing: \"div\" or true)\n *        script: undefined   // Remove script elements\n *      }\n *    });\n *    // => <div><div><span>foo bar</span></div></div>\n *\n *    var userHTML = '<table><tbody><tr><td>I'm a table!</td></tr></tbody></table>';\n *    wysihtml5.dom.parse(userHTML);\n *    // => '<span><span><span><span>I'm a table!</span></span></span></span>'\n *\n *    var userHTML = '<div>foobar<br>foobar</div>';\n *    wysihtml5.dom.parse(userHTML, {\n *      tags: {\n *        div: undefined,\n *        br:  true\n *      }\n *    });\n *    // => ''\n *\n *    var userHTML = '<div class=\"red\">foo</div><div class=\"pink\">bar</div>';\n *    wysihtml5.dom.parse(userHTML, {\n *      classes: {\n *        red:    1,\n *        green:  1\n *      },\n *      tags: {\n *        div: {\n *          rename_tag:     \"p\"\n *        }\n *      }\n *    });\n *    // => '<p class=\"red\">foo</p><p>bar</p>'\n */\n\nwysihtml5.dom.parse = function(elementOrHtml_current, config_current) {\n  /* TODO: Currently escaped module pattern as otherwise folloowing default swill be shared among multiple editors.\n   * Refactor whole code as this method while workind is kind of awkward too */\n\n  /**\n   * It's not possible to use a XMLParser/DOMParser as HTML5 is not always well-formed XML\n   * new DOMParser().parseFromString('<img src=\"foo.gif\">') will cause a parseError since the\n   * node isn't closed\n   *\n   * Therefore we've to use the browser's ordinary HTML parser invoked by setting innerHTML.\n   */\n  var NODE_TYPE_MAPPING = {\n        \"1\": _handleElement,\n        \"3\": _handleText,\n        \"8\": _handleComment\n      },\n      // Rename unknown tags to this\n      DEFAULT_NODE_NAME   = \"span\",\n      WHITE_SPACE_REG_EXP = /\\s+/,\n      defaultRules        = { tags: {}, classes: {} },\n      currentRules        = {};\n\n  /**\n   * Iterates over all childs of the element, recreates them, appends them into a document fragment\n   * which later replaces the entire body content\n   */\n   function parse(elementOrHtml, config) {\n    wysihtml5.lang.object(currentRules).merge(defaultRules).merge(config.rules).get();\n\n    var context       = config.context || elementOrHtml.ownerDocument || document,\n        fragment      = context.createDocumentFragment(),\n        isString      = typeof(elementOrHtml) === \"string\",\n        clearInternals = false,\n        element,\n        newNode,\n        firstChild;\n\n    if (config.clearInternals === true) {\n      clearInternals = true;\n    }\n\n    if (isString) {\n      element = wysihtml5.dom.getAsDom(elementOrHtml, context);\n    } else {\n      element = elementOrHtml;\n    }\n\n    if (currentRules.selectors) {\n      _applySelectorRules(element, currentRules.selectors);\n    }\n\n    while (element.firstChild) {\n      firstChild = element.firstChild;\n      newNode = _convert(firstChild, config.cleanUp, clearInternals, config.uneditableClass);\n      if (newNode) {\n        fragment.appendChild(newNode);\n      }\n      if (firstChild !== newNode) {\n        element.removeChild(firstChild);\n      }\n    }\n\n    if (config.unjoinNbsps) {\n      // replace joined non-breakable spaces with unjoined\n      var txtnodes = wysihtml5.dom.getTextNodes(fragment);\n      for (var n = txtnodes.length; n--;) {\n        txtnodes[n].nodeValue = txtnodes[n].nodeValue.replace(/([\\S\\u00A0])\\u00A0/gi, \"$1 \");\n      }\n    }\n\n    // Clear element contents\n    element.innerHTML = \"\";\n\n    // Insert new DOM tree\n    element.appendChild(fragment);\n\n    return isString ? wysihtml5.quirks.getCorrectInnerHTML(element) : element;\n  }\n\n  function _convert(oldNode, cleanUp, clearInternals, uneditableClass) {\n    var oldNodeType     = oldNode.nodeType,\n        oldChilds       = oldNode.childNodes,\n        oldChildsLength = oldChilds.length,\n        method          = NODE_TYPE_MAPPING[oldNodeType],\n        i               = 0,\n        fragment,\n        newNode,\n        newChild;\n\n    // Passes directly elemets with uneditable class\n    if (uneditableClass && oldNodeType === 1 && wysihtml5.dom.hasClass(oldNode, uneditableClass)) {\n        return oldNode;\n    }\n\n    newNode = method && method(oldNode, clearInternals);\n\n    // Remove or unwrap node in case of return value null or false\n    if (!newNode) {\n        if (newNode === false) {\n            // false defines that tag should be removed but contents should remain (unwrap)\n            fragment = oldNode.ownerDocument.createDocumentFragment();\n\n            for (i = oldChildsLength; i--;) {\n              if (oldChilds[i]) {\n                newChild = _convert(oldChilds[i], cleanUp, clearInternals, uneditableClass);\n                if (newChild) {\n                  if (oldChilds[i] === newChild) {\n                    i--;\n                  }\n                  fragment.insertBefore(newChild, fragment.firstChild);\n                }\n              }\n            }\n\n            if (wysihtml5.dom.getStyle(\"display\").from(oldNode) === \"block\") {\n              fragment.appendChild(oldNode.ownerDocument.createElement(\"br\"));\n            }\n\n            // TODO: try to minimize surplus spaces\n            if (wysihtml5.lang.array([\n                \"div\", \"pre\", \"p\",\n                \"table\", \"td\", \"th\",\n                \"ul\", \"ol\", \"li\",\n                \"dd\", \"dl\",\n                \"footer\", \"header\", \"section\",\n                \"h1\", \"h2\", \"h3\", \"h4\", \"h5\", \"h6\"\n            ]).contains(oldNode.nodeName.toLowerCase()) && oldNode.parentNode.lastChild !== oldNode) {\n                // add space at first when unwraping non-textflow elements\n                if (!oldNode.nextSibling || oldNode.nextSibling.nodeType !== 3 || !(/^\\s/).test(oldNode.nextSibling.nodeValue)) {\n                  fragment.appendChild(oldNode.ownerDocument.createTextNode(\" \"));\n                }\n            }\n\n            if (fragment.normalize) {\n              fragment.normalize();\n            }\n            return fragment;\n        } else {\n          // Remove\n          return null;\n        }\n    }\n\n    // Converts all childnodes\n    for (i=0; i<oldChildsLength; i++) {\n      if (oldChilds[i]) {\n        newChild = _convert(oldChilds[i], cleanUp, clearInternals, uneditableClass);\n        if (newChild) {\n          if (oldChilds[i] === newChild) {\n            i--;\n          }\n          newNode.appendChild(newChild);\n        }\n      }\n    }\n\n    // Cleanup senseless <span> elements\n    if (cleanUp &&\n        newNode.nodeName.toLowerCase() === DEFAULT_NODE_NAME &&\n        (!newNode.childNodes.length ||\n         ((/^\\s*$/gi).test(newNode.innerHTML) && (clearInternals || (oldNode.className !== \"_wysihtml5-temp-placeholder\" && oldNode.className !== \"rangySelectionBoundary\"))) ||\n         !newNode.attributes.length)\n        ) {\n      fragment = newNode.ownerDocument.createDocumentFragment();\n      while (newNode.firstChild) {\n        fragment.appendChild(newNode.firstChild);\n      }\n      if (fragment.normalize) {\n        fragment.normalize();\n      }\n      return fragment;\n    }\n\n    if (newNode.normalize) {\n      newNode.normalize();\n    }\n    return newNode;\n  }\n\n  function _applySelectorRules (element, selectorRules) {\n    var sel, method, els;\n\n    for (sel in selectorRules) {\n      if (selectorRules.hasOwnProperty(sel)) {\n        if (wysihtml5.lang.object(selectorRules[sel]).isFunction()) {\n          method = selectorRules[sel];\n        } else if (typeof(selectorRules[sel]) === \"string\" && elementHandlingMethods[selectorRules[sel]]) {\n          method = elementHandlingMethods[selectorRules[sel]];\n        }\n        els = element.querySelectorAll(sel);\n        for (var i = els.length; i--;) {\n          method(els[i]);\n        }\n      }\n    }\n  }\n\n  function _handleElement(oldNode, clearInternals) {\n    var rule,\n        newNode,\n        tagRules    = currentRules.tags,\n        nodeName    = oldNode.nodeName.toLowerCase(),\n        scopeName   = oldNode.scopeName,\n        renameTag;\n\n    /**\n     * We already parsed that element\n     * ignore it! (yes, this sometimes happens in IE8 when the html is invalid)\n     */\n    if (oldNode._wysihtml5) {\n      return null;\n    }\n    oldNode._wysihtml5 = 1;\n\n    if (oldNode.className === \"wysihtml5-temp\") {\n      return null;\n    }\n\n    /**\n     * IE is the only browser who doesn't include the namespace in the\n     * nodeName, that's why we have to prepend it by ourselves\n     * scopeName is a proprietary IE feature\n     * read more here http://msdn.microsoft.com/en-us/library/ms534388(v=vs.85).aspx\n     */\n    if (scopeName && scopeName != \"HTML\") {\n      nodeName = scopeName + \":\" + nodeName;\n    }\n    /**\n     * Repair node\n     * IE is a bit bitchy when it comes to invalid nested markup which includes unclosed tags\n     * A <p> doesn't need to be closed according HTML4-5 spec, we simply replace it with a <div> to preserve its content and layout\n     */\n    if (\"outerHTML\" in oldNode) {\n      if (!wysihtml5.browser.autoClosesUnclosedTags() &&\n          oldNode.nodeName === \"P\" &&\n          oldNode.outerHTML.slice(-4).toLowerCase() !== \"</p>\") {\n        nodeName = \"div\";\n      }\n    }\n\n    if (nodeName in tagRules) {\n      rule = tagRules[nodeName];\n      if (!rule || rule.remove) {\n        return null;\n      } else if (rule.unwrap) {\n        return false;\n      }\n      rule = typeof(rule) === \"string\" ? { rename_tag: rule } : rule;\n    } else if (oldNode.firstChild) {\n      rule = { rename_tag: DEFAULT_NODE_NAME };\n    } else {\n      // Remove empty unknown elements\n      return null;\n    }\n\n    // tests if type condition is met or node should be removed/unwrapped/renamed\n    if (rule.one_of_type && !_testTypes(oldNode, currentRules, rule.one_of_type, clearInternals)) {\n      if (rule.remove_action) {\n        if (rule.remove_action === \"unwrap\") {\n          return false;\n        } else if (rule.remove_action === \"rename\") {\n          renameTag = rule.remove_action_rename_to || DEFAULT_NODE_NAME;\n        } else {\n          return null;\n        }\n      } else {\n        return null;\n      }\n    }\n\n    newNode = oldNode.ownerDocument.createElement(renameTag || rule.rename_tag || nodeName);\n    _handleAttributes(oldNode, newNode, rule, clearInternals);\n    _handleStyles(oldNode, newNode, rule);\n\n    oldNode = null;\n\n    if (newNode.normalize) { newNode.normalize(); }\n    return newNode;\n  }\n\n  function _testTypes(oldNode, rules, types, clearInternals) {\n    var definition, type;\n\n    // do not interfere with placeholder span or pasting caret position is not maintained\n    if (oldNode.nodeName === \"SPAN\" && !clearInternals && (oldNode.className === \"_wysihtml5-temp-placeholder\" || oldNode.className === \"rangySelectionBoundary\")) {\n      return true;\n    }\n\n    for (type in types) {\n      if (types.hasOwnProperty(type) && rules.type_definitions && rules.type_definitions[type]) {\n        definition = rules.type_definitions[type];\n        if (_testType(oldNode, definition)) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  function array_contains(a, obj) {\n      var i = a.length;\n      while (i--) {\n         if (a[i] === obj) {\n             return true;\n         }\n      }\n      return false;\n  }\n\n  function _testType(oldNode, definition) {\n\n    var nodeClasses = oldNode.getAttribute(\"class\"),\n        nodeStyles =  oldNode.getAttribute(\"style\"),\n        classesLength, s, s_corrected, a, attr, currentClass, styleProp;\n\n    // test for methods\n    if (definition.methods) {\n      for (var m in definition.methods) {\n        if (definition.methods.hasOwnProperty(m) && typeCeckMethods[m]) {\n\n          if (typeCeckMethods[m](oldNode)) {\n            return true;\n          }\n        }\n      }\n    }\n\n    // test for classes, if one found return true\n    if (nodeClasses && definition.classes) {\n      nodeClasses = nodeClasses.replace(/^\\s+/g, '').replace(/\\s+$/g, '').split(WHITE_SPACE_REG_EXP);\n      classesLength = nodeClasses.length;\n      for (var i = 0; i < classesLength; i++) {\n        if (definition.classes[nodeClasses[i]]) {\n          return true;\n        }\n      }\n    }\n\n    // test for styles, if one found return true\n    if (nodeStyles && definition.styles) {\n\n      nodeStyles = nodeStyles.split(';');\n      for (s in definition.styles) {\n        if (definition.styles.hasOwnProperty(s)) {\n          for (var sp = nodeStyles.length; sp--;) {\n            styleProp = nodeStyles[sp].split(':');\n\n            if (styleProp[0].replace(/\\s/g, '').toLowerCase() === s) {\n              if (definition.styles[s] === true || definition.styles[s] === 1 || wysihtml5.lang.array(definition.styles[s]).contains(styleProp[1].replace(/\\s/g, '').toLowerCase()) ) {\n                return true;\n              }\n            }\n          }\n        }\n      }\n    }\n\n    // test for attributes in general against regex match\n    if (definition.attrs) {\n        for (a in definition.attrs) {\n            if (definition.attrs.hasOwnProperty(a)) {\n                attr = wysihtml5.dom.getAttribute(oldNode, a);\n                if (typeof(attr) === \"string\") {\n                    if (attr.search(definition.attrs[a]) > -1) {\n                        return true;\n                    }\n                }\n            }\n        }\n    }\n    return false;\n  }\n\n  function _handleStyles(oldNode, newNode, rule) {\n    var s, v;\n    if(rule && rule.keep_styles) {\n      for (s in rule.keep_styles) {\n        if (rule.keep_styles.hasOwnProperty(s)) {\n          v = (s === \"float\") ? oldNode.style.styleFloat || oldNode.style.cssFloat : oldNode.style[s];\n          // value can be regex and if so should match or style skipped\n          if (rule.keep_styles[s] instanceof RegExp && !(rule.keep_styles[s].test(v))) {\n            continue;\n          }\n          if (s === \"float\") {\n            // IE compability\n            newNode.style[(oldNode.style.styleFloat) ? 'styleFloat': 'cssFloat'] = v;\n           } else if (oldNode.style[s]) {\n             newNode.style[s] = v;\n           }\n        }\n      }\n    }\n  };\n\n  function _getAttributesBeginningWith(beginning, attributes) {\n    var returnAttributes = [];\n    for (var attr in attributes) {\n      if (attributes.hasOwnProperty(attr) && attr.indexOf(beginning) === 0) {\n        returnAttributes.push(attr);\n      }\n    }\n    return returnAttributes;\n  }\n\n  function _checkAttribute(attributeName, attributeValue, methodName, nodeName) {\n    var method = attributeCheckMethods[methodName],\n        newAttributeValue;\n\n    if (method) {\n      if (attributeValue || (attributeName === \"alt\" && nodeName == \"IMG\")) {\n        newAttributeValue = method(attributeValue);\n        if (typeof(newAttributeValue) === \"string\") {\n          return newAttributeValue;\n        }\n      }\n    }\n\n    return false;\n  }\n\n  function _checkAttributes(oldNode, local_attributes) {\n    var globalAttributes  = wysihtml5.lang.object(currentRules.attributes || {}).clone(), // global values for check/convert values of attributes\n        checkAttributes   = wysihtml5.lang.object(globalAttributes).merge( wysihtml5.lang.object(local_attributes || {}).clone()).get(),\n        attributes        = {},\n        oldAttributes     = wysihtml5.dom.getAttributes(oldNode),\n        attributeName, newValue, matchingAttributes;\n\n    for (attributeName in checkAttributes) {\n      if ((/\\*$/).test(attributeName)) {\n\n        matchingAttributes = _getAttributesBeginningWith(attributeName.slice(0,-1), oldAttributes);\n        for (var i = 0, imax = matchingAttributes.length; i < imax; i++) {\n\n          newValue = _checkAttribute(matchingAttributes[i], oldAttributes[matchingAttributes[i]], checkAttributes[attributeName], oldNode.nodeName);\n          if (newValue !== false) {\n            attributes[matchingAttributes[i]] = newValue;\n          }\n        }\n      } else {\n        newValue = _checkAttribute(attributeName, oldAttributes[attributeName], checkAttributes[attributeName], oldNode.nodeName);\n        if (newValue !== false) {\n          attributes[attributeName] = newValue;\n        }\n      }\n    }\n\n    return attributes;\n  }\n\n  // TODO: refactor. Too long to read\n  function _handleAttributes(oldNode, newNode, rule, clearInternals) {\n    var attributes          = {},                         // fresh new set of attributes to set on newNode\n        setClass            = rule.set_class,             // classes to set\n        addClass            = rule.add_class,             // add classes based on existing attributes\n        addStyle            = rule.add_style,             // add styles based on existing attributes\n        setAttributes       = rule.set_attributes,        // attributes to set on the current node\n        allowedClasses      = currentRules.classes,\n        i                   = 0,\n        classes             = [],\n        styles              = [],\n        newClasses          = [],\n        oldClasses          = [],\n        classesLength,\n        newClassesLength,\n        currentClass,\n        newClass,\n        attributeName,\n        method;\n\n    if (setAttributes) {\n      attributes = wysihtml5.lang.object(setAttributes).clone();\n    }\n\n    // check/convert values of attributes\n    attributes = wysihtml5.lang.object(attributes).merge(_checkAttributes(oldNode,  rule.check_attributes)).get();\n\n    if (setClass) {\n      classes.push(setClass);\n    }\n\n    if (addClass) {\n      for (attributeName in addClass) {\n        method = addClassMethods[addClass[attributeName]];\n        if (!method) {\n          continue;\n        }\n        newClass = method(wysihtml5.dom.getAttribute(oldNode, attributeName));\n        if (typeof(newClass) === \"string\") {\n          classes.push(newClass);\n        }\n      }\n    }\n\n    if (addStyle) {\n      for (attributeName in addStyle) {\n        method = addStyleMethods[addStyle[attributeName]];\n        if (!method) {\n          continue;\n        }\n\n        newStyle = method(wysihtml5.dom.getAttribute(oldNode, attributeName));\n        if (typeof(newStyle) === \"string\") {\n          styles.push(newStyle);\n        }\n      }\n    }\n\n\n    if (typeof(allowedClasses) === \"string\" && allowedClasses === \"any\" && oldNode.getAttribute(\"class\")) {\n      if (currentRules.classes_blacklist) {\n        oldClasses = oldNode.getAttribute(\"class\");\n        if (oldClasses) {\n          classes = classes.concat(oldClasses.split(WHITE_SPACE_REG_EXP));\n        }\n\n        classesLength = classes.length;\n        for (; i<classesLength; i++) {\n          currentClass = classes[i];\n          if (!currentRules.classes_blacklist[currentClass]) {\n            newClasses.push(currentClass);\n          }\n        }\n\n        if (newClasses.length) {\n          attributes[\"class\"] = wysihtml5.lang.array(newClasses).unique().join(\" \");\n        }\n\n      } else {\n        attributes[\"class\"] = oldNode.getAttribute(\"class\");\n      }\n    } else {\n      // make sure that wysihtml5 temp class doesn't get stripped out\n      if (!clearInternals) {\n        allowedClasses[\"_wysihtml5-temp-placeholder\"] = 1;\n        allowedClasses[\"_rangySelectionBoundary\"] = 1;\n        allowedClasses[\"wysiwyg-tmp-selected-cell\"] = 1;\n      }\n\n      // add old classes last\n      oldClasses = oldNode.getAttribute(\"class\");\n      if (oldClasses) {\n        classes = classes.concat(oldClasses.split(WHITE_SPACE_REG_EXP));\n      }\n      classesLength = classes.length;\n      for (; i<classesLength; i++) {\n        currentClass = classes[i];\n        if (allowedClasses[currentClass]) {\n          newClasses.push(currentClass);\n        }\n      }\n\n      if (newClasses.length) {\n        attributes[\"class\"] = wysihtml5.lang.array(newClasses).unique().join(\" \");\n      }\n    }\n\n    // remove table selection class if present\n    if (attributes[\"class\"] && clearInternals) {\n      attributes[\"class\"] = attributes[\"class\"].replace(\"wysiwyg-tmp-selected-cell\", \"\");\n      if ((/^\\s*$/g).test(attributes[\"class\"])) {\n        delete attributes[\"class\"];\n      }\n    }\n\n    if (styles.length) {\n      attributes[\"style\"] = wysihtml5.lang.array(styles).unique().join(\" \");\n    }\n\n    // set attributes on newNode\n    for (attributeName in attributes) {\n      // Setting attributes can cause a js error in IE under certain circumstances\n      // eg. on a <img> under https when it's new attribute value is non-https\n      // TODO: Investigate this further and check for smarter handling\n      try {\n        newNode.setAttribute(attributeName, attributes[attributeName]);\n      } catch(e) {}\n    }\n\n    // IE8 sometimes loses the width/height attributes when those are set before the \"src\"\n    // so we make sure to set them again\n    if (attributes.src) {\n      if (typeof(attributes.width) !== \"undefined\") {\n        newNode.setAttribute(\"width\", attributes.width);\n      }\n      if (typeof(attributes.height) !== \"undefined\") {\n        newNode.setAttribute(\"height\", attributes.height);\n      }\n    }\n  }\n\n  var INVISIBLE_SPACE_REG_EXP = /\\uFEFF/g;\n  function _handleText(oldNode) {\n    var nextSibling = oldNode.nextSibling;\n    if (nextSibling && nextSibling.nodeType === wysihtml5.TEXT_NODE) {\n      // Concatenate text nodes\n      nextSibling.data = oldNode.data.replace(INVISIBLE_SPACE_REG_EXP, \"\") + nextSibling.data.replace(INVISIBLE_SPACE_REG_EXP, \"\");\n    } else {\n      // \\uFEFF = wysihtml5.INVISIBLE_SPACE (used as a hack in certain rich text editing situations)\n      var data = oldNode.data.replace(INVISIBLE_SPACE_REG_EXP, \"\");\n      return oldNode.ownerDocument.createTextNode(data);\n    }\n  }\n\n  function _handleComment(oldNode) {\n    if (currentRules.comments) {\n      return oldNode.ownerDocument.createComment(oldNode.nodeValue);\n    }\n  }\n\n  // ------------ attribute checks ------------ \\\\\n  var attributeCheckMethods = {\n    url: (function() {\n      var REG_EXP = /^https?:\\/\\//i;\n      return function(attributeValue) {\n        if (!attributeValue || !attributeValue.match(REG_EXP)) {\n          return null;\n        }\n        return attributeValue.replace(REG_EXP, function(match) {\n          return match.toLowerCase();\n        });\n      };\n    })(),\n\n    src: (function() {\n      var REG_EXP = /^(\\/|https?:\\/\\/)/i;\n      return function(attributeValue) {\n        if (!attributeValue || !attributeValue.match(REG_EXP)) {\n          return null;\n        }\n        return attributeValue.replace(REG_EXP, function(match) {\n          return match.toLowerCase();\n        });\n      };\n    })(),\n\n    href: (function() {\n      var REG_EXP = /^(#|\\/|https?:\\/\\/|mailto:)/i;\n      return function(attributeValue) {\n        if (!attributeValue || !attributeValue.match(REG_EXP)) {\n          return null;\n        }\n        return attributeValue.replace(REG_EXP, function(match) {\n          return match.toLowerCase();\n        });\n      };\n    })(),\n\n    alt: (function() {\n      var REG_EXP = /[^ a-z0-9_\\-]/gi;\n      return function(attributeValue) {\n        if (!attributeValue) {\n          return \"\";\n        }\n        return attributeValue.replace(REG_EXP, \"\");\n      };\n    })(),\n\n    numbers: (function() {\n      var REG_EXP = /\\D/g;\n      return function(attributeValue) {\n        attributeValue = (attributeValue || \"\").replace(REG_EXP, \"\");\n        return attributeValue || null;\n      };\n    })(),\n\n    any: (function() {\n      return function(attributeValue) {\n        return attributeValue;\n      };\n    })()\n  };\n\n  // ------------ style converter (converts an html attribute to a style) ------------ \\\\\n  var addStyleMethods = {\n    align_text: (function() {\n      var mapping = {\n        left:     \"text-align: left;\",\n        right:    \"text-align: right;\",\n        center:   \"text-align: center;\"\n      };\n      return function(attributeValue) {\n        return mapping[String(attributeValue).toLowerCase()];\n      };\n    })(),\n  };\n\n  // ------------ class converter (converts an html attribute to a class name) ------------ \\\\\n  var addClassMethods = {\n    align_img: (function() {\n      var mapping = {\n        left:   \"wysiwyg-float-left\",\n        right:  \"wysiwyg-float-right\"\n      };\n      return function(attributeValue) {\n        return mapping[String(attributeValue).toLowerCase()];\n      };\n    })(),\n\n    align_text: (function() {\n      var mapping = {\n        left:     \"wysiwyg-text-align-left\",\n        right:    \"wysiwyg-text-align-right\",\n        center:   \"wysiwyg-text-align-center\",\n        justify:  \"wysiwyg-text-align-justify\"\n      };\n      return function(attributeValue) {\n        return mapping[String(attributeValue).toLowerCase()];\n      };\n    })(),\n\n    clear_br: (function() {\n      var mapping = {\n        left:   \"wysiwyg-clear-left\",\n        right:  \"wysiwyg-clear-right\",\n        both:   \"wysiwyg-clear-both\",\n        all:    \"wysiwyg-clear-both\"\n      };\n      return function(attributeValue) {\n        return mapping[String(attributeValue).toLowerCase()];\n      };\n    })(),\n\n    size_font: (function() {\n      var mapping = {\n        \"1\": \"wysiwyg-font-size-xx-small\",\n        \"2\": \"wysiwyg-font-size-small\",\n        \"3\": \"wysiwyg-font-size-medium\",\n        \"4\": \"wysiwyg-font-size-large\",\n        \"5\": \"wysiwyg-font-size-x-large\",\n        \"6\": \"wysiwyg-font-size-xx-large\",\n        \"7\": \"wysiwyg-font-size-xx-large\",\n        \"-\": \"wysiwyg-font-size-smaller\",\n        \"+\": \"wysiwyg-font-size-larger\"\n      };\n      return function(attributeValue) {\n        return mapping[String(attributeValue).charAt(0)];\n      };\n    })()\n  };\n\n  // checks if element is possibly visible\n  var typeCeckMethods = {\n    has_visible_contet: (function() {\n      var txt,\n          isVisible = false,\n          visibleElements = ['img', 'video', 'picture', 'br', 'script', 'noscript',\n                             'style', 'table', 'iframe', 'object', 'embed', 'audio',\n                             'svg', 'input', 'button', 'select','textarea', 'canvas'];\n\n      return function(el) {\n\n        // has visible innertext. so is visible\n        txt = (el.innerText || el.textContent).replace(/\\s/g, '');\n        if (txt && txt.length > 0) {\n          return true;\n        }\n\n        // matches list of visible dimensioned elements\n        for (var i = visibleElements.length; i--;) {\n          if (el.querySelector(visibleElements[i])) {\n            return true;\n          }\n        }\n\n        // try to measure dimesions in last resort. (can find only of elements in dom)\n        if (el.offsetWidth && el.offsetWidth > 0 && el.offsetHeight && el.offsetHeight > 0) {\n          return true;\n        }\n\n        return false;\n      };\n    })()\n  };\n\n  var elementHandlingMethods = {\n    unwrap: function (element) {\n      wysihtml5.dom.unwrap(element);\n    },\n\n    remove: function (element) {\n      element.parentNode.removeChild(element);\n    }\n  };\n\n  return parse(elementOrHtml_current, config_current);\n};\n;/**\n * Checks for empty text node childs and removes them\n *\n * @param {Element} node The element in which to cleanup\n * @example\n *    wysihtml5.dom.removeEmptyTextNodes(element);\n */\nwysihtml5.dom.removeEmptyTextNodes = function(node) {\n  var childNode,\n      childNodes        = wysihtml5.lang.array(node.childNodes).get(),\n      childNodesLength  = childNodes.length,\n      i                 = 0;\n  for (; i<childNodesLength; i++) {\n    childNode = childNodes[i];\n    if (childNode.nodeType === wysihtml5.TEXT_NODE && childNode.data === \"\") {\n      childNode.parentNode.removeChild(childNode);\n    }\n  }\n};\n;/**\n * Renames an element (eg. a <div> to a <p>) and keeps its childs\n *\n * @param {Element} element The list element which should be renamed\n * @param {Element} newNodeName The desired tag name\n *\n * @example\n *    <!-- Assume the following dom: -->\n *    <ul id=\"list\">\n *      <li>eminem</li>\n *      <li>dr. dre</li>\n *      <li>50 Cent</li>\n *    </ul>\n *\n *    <script>\n *      wysihtml5.dom.renameElement(document.getElementById(\"list\"), \"ol\");\n *    </script>\n *\n *    <!-- Will result in: -->\n *    <ol>\n *      <li>eminem</li>\n *      <li>dr. dre</li>\n *      <li>50 Cent</li>\n *    </ol>\n */\nwysihtml5.dom.renameElement = function(element, newNodeName) {\n  var newElement = element.ownerDocument.createElement(newNodeName),\n      firstChild;\n  while (firstChild = element.firstChild) {\n    newElement.appendChild(firstChild);\n  }\n  wysihtml5.dom.copyAttributes([\"align\", \"className\"]).from(element).to(newElement);\n  element.parentNode.replaceChild(newElement, element);\n  return newElement;\n};\n;/**\n * Takes an element, removes it and replaces it with it's childs\n *\n * @param {Object} node The node which to replace with it's child nodes\n * @example\n *    <div id=\"foo\">\n *      <span>hello</span>\n *    </div>\n *    <script>\n *      // Remove #foo and replace with it's children\n *      wysihtml5.dom.replaceWithChildNodes(document.getElementById(\"foo\"));\n *    </script>\n */\nwysihtml5.dom.replaceWithChildNodes = function(node) {\n  if (!node.parentNode) {\n    return;\n  }\n\n  if (!node.firstChild) {\n    node.parentNode.removeChild(node);\n    return;\n  }\n\n  var fragment = node.ownerDocument.createDocumentFragment();\n  while (node.firstChild) {\n    fragment.appendChild(node.firstChild);\n  }\n  node.parentNode.replaceChild(fragment, node);\n  node = fragment = null;\n};\n;/**\n * Unwraps an unordered/ordered list\n *\n * @param {Element} element The list element which should be unwrapped\n *\n * @example\n *    <!-- Assume the following dom: -->\n *    <ul id=\"list\">\n *      <li>eminem</li>\n *      <li>dr. dre</li>\n *      <li>50 Cent</li>\n *    </ul>\n *\n *    <script>\n *      wysihtml5.dom.resolveList(document.getElementById(\"list\"));\n *    </script>\n *\n *    <!-- Will result in: -->\n *    eminem<br>\n *    dr. dre<br>\n *    50 Cent<br>\n */\n(function(dom) {\n  function _isBlockElement(node) {\n    return dom.getStyle(\"display\").from(node) === \"block\";\n  }\n\n  function _isLineBreak(node) {\n    return node.nodeName === \"BR\";\n  }\n\n  function _appendLineBreak(element) {\n    var lineBreak = element.ownerDocument.createElement(\"br\");\n    element.appendChild(lineBreak);\n  }\n\n  function resolveList(list, useLineBreaks) {\n    if (!list.nodeName.match(/^(MENU|UL|OL)$/)) {\n      return;\n    }\n\n    var doc             = list.ownerDocument,\n        fragment        = doc.createDocumentFragment(),\n        previousSibling = wysihtml5.dom.domNode(list).prev({ignoreBlankTexts: true}),\n        firstChild,\n        lastChild,\n        isLastChild,\n        shouldAppendLineBreak,\n        paragraph,\n        listItem;\n\n    if (useLineBreaks) {\n      // Insert line break if list is after a non-block element\n      if (previousSibling && !_isBlockElement(previousSibling) && !_isLineBreak(previousSibling)) {\n        _appendLineBreak(fragment);\n      }\n\n      while (listItem = (list.firstElementChild || list.firstChild)) {\n        lastChild = listItem.lastChild;\n        while (firstChild = listItem.firstChild) {\n          isLastChild           = firstChild === lastChild;\n          // This needs to be done before appending it to the fragment, as it otherwise will lose style information\n          shouldAppendLineBreak = isLastChild && !_isBlockElement(firstChild) && !_isLineBreak(firstChild);\n          fragment.appendChild(firstChild);\n          if (shouldAppendLineBreak) {\n            _appendLineBreak(fragment);\n          }\n        }\n\n        listItem.parentNode.removeChild(listItem);\n      }\n    } else {\n      while (listItem = (list.firstElementChild || list.firstChild)) {\n        if (listItem.querySelector && listItem.querySelector(\"div, p, ul, ol, menu, blockquote, h1, h2, h3, h4, h5, h6\")) {\n          while (firstChild = listItem.firstChild) {\n            fragment.appendChild(firstChild);\n          }\n        } else {\n          paragraph = doc.createElement(\"p\");\n          while (firstChild = listItem.firstChild) {\n            paragraph.appendChild(firstChild);\n          }\n          fragment.appendChild(paragraph);\n        }\n        listItem.parentNode.removeChild(listItem);\n      }\n    }\n\n    list.parentNode.replaceChild(fragment, list);\n  }\n\n  dom.resolveList = resolveList;\n})(wysihtml5.dom);\n;/**\n * Sandbox for executing javascript, parsing css styles and doing dom operations in a secure way\n *\n * Browser Compatibility:\n *  - Secure in MSIE 6+, but only when the user hasn't made changes to his security level \"restricted\"\n *  - Partially secure in other browsers (Firefox, Opera, Safari, Chrome, ...)\n *\n * Please note that this class can't benefit from the HTML5 sandbox attribute for the following reasons:\n *    - sandboxing doesn't work correctly with inlined content (src=\"javascript:'<html>...</html>'\")\n *    - sandboxing of physical documents causes that the dom isn't accessible anymore from the outside (iframe.contentWindow, ...)\n *    - setting the \"allow-same-origin\" flag would fix that, but then still javascript and dom events refuse to fire\n *    - therefore the \"allow-scripts\" flag is needed, which then would deactivate any security, as the js executed inside the iframe\n *      can do anything as if the sandbox attribute wasn't set\n *\n * @param {Function} [readyCallback] Method that gets invoked when the sandbox is ready\n * @param {Object} [config] Optional parameters\n *\n * @example\n *    new wysihtml5.dom.Sandbox(function(sandbox) {\n *      sandbox.getWindow().document.body.innerHTML = '<img src=foo.gif onerror=\"alert(document.cookie)\">';\n *    });\n */\n(function(wysihtml5) {\n  var /**\n       * Default configuration\n       */\n      doc                 = document,\n      /**\n       * Properties to unset/protect on the window object\n       */\n      windowProperties    = [\n        \"parent\", \"top\", \"opener\", \"frameElement\", \"frames\",\n        \"localStorage\", \"globalStorage\", \"sessionStorage\", \"indexedDB\"\n      ],\n      /**\n       * Properties on the window object which are set to an empty function\n       */\n      windowProperties2   = [\n        \"open\", \"close\", \"openDialog\", \"showModalDialog\",\n        \"alert\", \"confirm\", \"prompt\",\n        \"openDatabase\", \"postMessage\",\n        \"XMLHttpRequest\", \"XDomainRequest\"\n      ],\n      /**\n       * Properties to unset/protect on the document object\n       */\n      documentProperties  = [\n        \"referrer\",\n        \"write\", \"open\", \"close\"\n      ];\n\n  wysihtml5.dom.Sandbox = Base.extend(\n    /** @scope wysihtml5.dom.Sandbox.prototype */ {\n\n    constructor: function(readyCallback, config) {\n      this.callback = readyCallback || wysihtml5.EMPTY_FUNCTION;\n      this.config   = wysihtml5.lang.object({}).merge(config).get();\n      this.editableArea   = this._createIframe();\n    },\n\n    insertInto: function(element) {\n      if (typeof(element) === \"string\") {\n        element = doc.getElementById(element);\n      }\n\n      element.appendChild(this.editableArea);\n    },\n\n    getIframe: function() {\n      return this.editableArea;\n    },\n\n    getWindow: function() {\n      this._readyError();\n    },\n\n    getDocument: function() {\n      this._readyError();\n    },\n\n    destroy: function() {\n      var iframe = this.getIframe();\n      iframe.parentNode.removeChild(iframe);\n    },\n\n    _readyError: function() {\n      throw new Error(\"wysihtml5.Sandbox: Sandbox iframe isn't loaded yet\");\n    },\n\n    /**\n     * Creates the sandbox iframe\n     *\n     * Some important notes:\n     *  - We can't use HTML5 sandbox for now:\n     *    setting it causes that the iframe's dom can't be accessed from the outside\n     *    Therefore we need to set the \"allow-same-origin\" flag which enables accessing the iframe's dom\n     *    But then there's another problem, DOM events (focus, blur, change, keypress, ...) aren't fired.\n     *    In order to make this happen we need to set the \"allow-scripts\" flag.\n     *    A combination of allow-scripts and allow-same-origin is almost the same as setting no sandbox attribute at all.\n     *  - Chrome & Safari, doesn't seem to support sandboxing correctly when the iframe's html is inlined (no physical document)\n     *  - IE needs to have the security=\"restricted\" attribute set before the iframe is\n     *    inserted into the dom tree\n     *  - Believe it or not but in IE \"security\" in document.createElement(\"iframe\") is false, even\n     *    though it supports it\n     *  - When an iframe has security=\"restricted\", in IE eval() & execScript() don't work anymore\n     *  - IE doesn't fire the onload event when the content is inlined in the src attribute, therefore we rely\n     *    on the onreadystatechange event\n     */\n    _createIframe: function() {\n      var that   = this,\n          iframe = doc.createElement(\"iframe\");\n      iframe.className = \"wysihtml5-sandbox\";\n      wysihtml5.dom.setAttributes({\n        \"security\":           \"restricted\",\n        \"allowtransparency\":  \"true\",\n        \"frameborder\":        0,\n        \"width\":              0,\n        \"height\":             0,\n        \"marginwidth\":        0,\n        \"marginheight\":       0\n      }).on(iframe);\n\n      // Setting the src like this prevents ssl warnings in IE6\n      if (wysihtml5.browser.throwsMixedContentWarningWhenIframeSrcIsEmpty()) {\n        iframe.src = \"javascript:'<html></html>'\";\n      }\n\n      iframe.onload = function() {\n        iframe.onreadystatechange = iframe.onload = null;\n        that._onLoadIframe(iframe);\n      };\n\n      iframe.onreadystatechange = function() {\n        if (/loaded|complete/.test(iframe.readyState)) {\n          iframe.onreadystatechange = iframe.onload = null;\n          that._onLoadIframe(iframe);\n        }\n      };\n\n      return iframe;\n    },\n\n    /**\n     * Callback for when the iframe has finished loading\n     */\n    _onLoadIframe: function(iframe) {\n      // don't resume when the iframe got unloaded (eg. by removing it from the dom)\n      if (!wysihtml5.dom.contains(doc.documentElement, iframe)) {\n        return;\n      }\n\n      var that           = this,\n          iframeWindow   = iframe.contentWindow,\n          iframeDocument = iframe.contentWindow.document,\n          charset        = doc.characterSet || doc.charset || \"utf-8\",\n          sandboxHtml    = this._getHtml({\n            charset:      charset,\n            stylesheets:  this.config.stylesheets\n          });\n\n      // Create the basic dom tree including proper DOCTYPE and charset\n      iframeDocument.open(\"text/html\", \"replace\");\n      iframeDocument.write(sandboxHtml);\n      iframeDocument.close();\n\n      this.getWindow = function() { return iframe.contentWindow; };\n      this.getDocument = function() { return iframe.contentWindow.document; };\n\n      // Catch js errors and pass them to the parent's onerror event\n      // addEventListener(\"error\") doesn't work properly in some browsers\n      // TODO: apparently this doesn't work in IE9!\n      iframeWindow.onerror = function(errorMessage, fileName, lineNumber) {\n        throw new Error(\"wysihtml5.Sandbox: \" + errorMessage, fileName, lineNumber);\n      };\n\n      if (!wysihtml5.browser.supportsSandboxedIframes()) {\n        // Unset a bunch of sensitive variables\n        // Please note: This isn't hack safe!\n        // It more or less just takes care of basic attacks and prevents accidental theft of sensitive information\n        // IE is secure though, which is the most important thing, since IE is the only browser, who\n        // takes over scripts & styles into contentEditable elements when copied from external websites\n        // or applications (Microsoft Word, ...)\n        var i, length;\n        for (i=0, length=windowProperties.length; i<length; i++) {\n          this._unset(iframeWindow, windowProperties[i]);\n        }\n        for (i=0, length=windowProperties2.length; i<length; i++) {\n          this._unset(iframeWindow, windowProperties2[i], wysihtml5.EMPTY_FUNCTION);\n        }\n        for (i=0, length=documentProperties.length; i<length; i++) {\n          this._unset(iframeDocument, documentProperties[i]);\n        }\n        // This doesn't work in Safari 5\n        // See http://stackoverflow.com/questions/992461/is-it-possible-to-override-document-cookie-in-webkit\n        this._unset(iframeDocument, \"cookie\", \"\", true);\n      }\n\n      this.loaded = true;\n\n      // Trigger the callback\n      setTimeout(function() { that.callback(that); }, 0);\n    },\n\n    _getHtml: function(templateVars) {\n      var stylesheets = templateVars.stylesheets,\n          html        = \"\",\n          i           = 0,\n          length;\n      stylesheets = typeof(stylesheets) === \"string\" ? [stylesheets] : stylesheets;\n      if (stylesheets) {\n        length = stylesheets.length;\n        for (; i<length; i++) {\n          html += '<link rel=\"stylesheet\" href=\"' + stylesheets[i] + '\">';\n        }\n      }\n      templateVars.stylesheets = html;\n\n      return wysihtml5.lang.string(\n        '<!DOCTYPE html><html><head>'\n        + '<meta charset=\"#{charset}\">#{stylesheets}</head>'\n        + '<body></body></html>'\n      ).interpolate(templateVars);\n    },\n\n    /**\n     * Method to unset/override existing variables\n     * @example\n     *    // Make cookie unreadable and unwritable\n     *    this._unset(document, \"cookie\", \"\", true);\n     */\n    _unset: function(object, property, value, setter) {\n      try { object[property] = value; } catch(e) {}\n\n      try { object.__defineGetter__(property, function() { return value; }); } catch(e) {}\n      if (setter) {\n        try { object.__defineSetter__(property, function() {}); } catch(e) {}\n      }\n\n      if (!wysihtml5.browser.crashesWhenDefineProperty(property)) {\n        try {\n          var config = {\n            get: function() { return value; }\n          };\n          if (setter) {\n            config.set = function() {};\n          }\n          Object.defineProperty(object, property, config);\n        } catch(e) {}\n      }\n    }\n  });\n})(wysihtml5);\n;(function(wysihtml5) {\n  var doc = document;\n  wysihtml5.dom.ContentEditableArea = Base.extend({\n      getContentEditable: function() {\n        return this.element;\n      },\n\n      getWindow: function() {\n        return this.element.ownerDocument.defaultView;\n      },\n\n      getDocument: function() {\n        return this.element.ownerDocument;\n      },\n\n      constructor: function(readyCallback, config, contentEditable) {\n        this.callback = readyCallback || wysihtml5.EMPTY_FUNCTION;\n        this.config   = wysihtml5.lang.object({}).merge(config).get();\n        if (contentEditable) {\n            this.element = this._bindElement(contentEditable);\n        } else {\n            this.element = this._createElement();\n        }\n      },\n\n      // creates a new contenteditable and initiates it\n      _createElement: function() {\n        var element = doc.createElement(\"div\");\n        element.className = \"wysihtml5-sandbox\";\n        this._loadElement(element);\n        return element;\n      },\n\n      // initiates an allready existent contenteditable\n      _bindElement: function(contentEditable) {\n        contentEditable.className = (contentEditable.className && contentEditable.className != '') ? contentEditable.className + \" wysihtml5-sandbox\" : \"wysihtml5-sandbox\";\n        this._loadElement(contentEditable, true);\n        return contentEditable;\n      },\n\n      _loadElement: function(element, contentExists) {\n          var that = this;\n        if (!contentExists) {\n            var sandboxHtml = this._getHtml();\n            element.innerHTML = sandboxHtml;\n        }\n\n        this.getWindow = function() { return element.ownerDocument.defaultView; };\n        this.getDocument = function() { return element.ownerDocument; };\n\n        // Catch js errors and pass them to the parent's onerror event\n        // addEventListener(\"error\") doesn't work properly in some browsers\n        // TODO: apparently this doesn't work in IE9!\n        // TODO: figure out and bind the errors logic for contenteditble mode\n        /*iframeWindow.onerror = function(errorMessage, fileName, lineNumber) {\n          throw new Error(\"wysihtml5.Sandbox: \" + errorMessage, fileName, lineNumber);\n        }\n        */\n        this.loaded = true;\n        // Trigger the callback\n        setTimeout(function() { that.callback(that); }, 0);\n      },\n\n      _getHtml: function(templateVars) {\n        return '';\n      }\n\n  });\n})(wysihtml5);\n;(function() {\n  var mapping = {\n    \"className\": \"class\"\n  };\n  wysihtml5.dom.setAttributes = function(attributes) {\n    return {\n      on: function(element) {\n        for (var i in attributes) {\n          element.setAttribute(mapping[i] || i, attributes[i]);\n        }\n      }\n    };\n  };\n})();\n;wysihtml5.dom.setStyles = function(styles) {\n  return {\n    on: function(element) {\n      var style = element.style;\n      if (typeof(styles) === \"string\") {\n        style.cssText += \";\" + styles;\n        return;\n      }\n      for (var i in styles) {\n        if (i === \"float\") {\n          style.cssFloat = styles[i];\n          style.styleFloat = styles[i];\n        } else {\n          style[i] = styles[i];\n        }\n      }\n    }\n  };\n};\n;/**\n * Simulate HTML5 placeholder attribute\n *\n * Needed since\n *    - div[contentEditable] elements don't support it\n *    - older browsers (such as IE8 and Firefox 3.6) don't support it at all\n *\n * @param {Object} parent Instance of main wysihtml5.Editor class\n * @param {Element} view Instance of wysihtml5.views.* class\n * @param {String} placeholderText\n *\n * @example\n *    wysihtml.dom.simulatePlaceholder(this, composer, \"Foobar\");\n */\n(function(dom) {\n  dom.simulatePlaceholder = function(editor, view, placeholderText) {\n    var CLASS_NAME = \"placeholder\",\n        unset = function() {\n          var composerIsVisible   = view.element.offsetWidth > 0 && view.element.offsetHeight > 0;\n          if (view.hasPlaceholderSet()) {\n            view.clear();\n            view.element.focus();\n            if (composerIsVisible ) {\n              setTimeout(function() {\n                var sel = view.selection.getSelection();\n                if (!sel.focusNode || !sel.anchorNode) {\n                  view.selection.selectNode(view.element.firstChild || view.element);\n                }\n              }, 0);\n            }\n          }\n          view.placeholderSet = false;\n          dom.removeClass(view.element, CLASS_NAME);\n        },\n        set = function() {\n          if (view.isEmpty()) {\n            view.placeholderSet = true;\n            view.setValue(placeholderText);\n            dom.addClass(view.element, CLASS_NAME);\n          }\n        };\n\n    editor\n      .on(\"set_placeholder\", set)\n      .on(\"unset_placeholder\", unset)\n      .on(\"focus:composer\", unset)\n      .on(\"paste:composer\", unset)\n      .on(\"blur:composer\", set);\n\n    set();\n  };\n})(wysihtml5.dom);\n;(function(dom) {\n  var documentElement = document.documentElement;\n  if (\"textContent\" in documentElement) {\n    dom.setTextContent = function(element, text) {\n      element.textContent = text;\n    };\n\n    dom.getTextContent = function(element) {\n      return element.textContent;\n    };\n  } else if (\"innerText\" in documentElement) {\n    dom.setTextContent = function(element, text) {\n      element.innerText = text;\n    };\n\n    dom.getTextContent = function(element) {\n      return element.innerText;\n    };\n  } else {\n    dom.setTextContent = function(element, text) {\n      element.nodeValue = text;\n    };\n\n    dom.getTextContent = function(element) {\n      return element.nodeValue;\n    };\n  }\n})(wysihtml5.dom);\n\n;/**\n * Get a set of attribute from one element\n *\n * IE gives wrong results for hasAttribute/getAttribute, for example:\n *    var td = document.createElement(\"td\");\n *    td.getAttribute(\"rowspan\"); // => \"1\" in IE\n *\n * Therefore we have to check the element's outerHTML for the attribute\n*/\n\nwysihtml5.dom.getAttribute = function(node, attributeName) {\n  var HAS_GET_ATTRIBUTE_BUG = !wysihtml5.browser.supportsGetAttributeCorrectly();\n  attributeName = attributeName.toLowerCase();\n  var nodeName = node.nodeName;\n  if (nodeName == \"IMG\" && attributeName == \"src\" && wysihtml5.dom.isLoadedImage(node) === true) {\n    // Get 'src' attribute value via object property since this will always contain the\n    // full absolute url (http://...)\n    // this fixes a very annoying bug in firefox (ver 3.6 & 4) and IE 8 where images copied from the same host\n    // will have relative paths, which the sanitizer strips out (see attributeCheckMethods.url)\n    return node.src;\n  } else if (HAS_GET_ATTRIBUTE_BUG && \"outerHTML\" in node) {\n    // Don't trust getAttribute/hasAttribute in IE 6-8, instead check the element's outerHTML\n    var outerHTML      = node.outerHTML.toLowerCase(),\n        // TODO: This might not work for attributes without value: <input disabled>\n        hasAttribute   = outerHTML.indexOf(\" \" + attributeName +  \"=\") != -1;\n\n    return hasAttribute ? node.getAttribute(attributeName) : null;\n  } else{\n    return node.getAttribute(attributeName);\n  }\n};\n;/**\n * Get all attributes of an element\n *\n * IE gives wrong results for hasAttribute/getAttribute, for example:\n *    var td = document.createElement(\"td\");\n *    td.getAttribute(\"rowspan\"); // => \"1\" in IE\n *\n * Therefore we have to check the element's outerHTML for the attribute\n*/\n\nwysihtml5.dom.getAttributes = function(node) {\n  var HAS_GET_ATTRIBUTE_BUG = !wysihtml5.browser.supportsGetAttributeCorrectly(),\n      nodeName = node.nodeName,\n      attributes = [],\n      attr;\n\n  for (attr in node.attributes) {\n    if ((node.attributes.hasOwnProperty && node.attributes.hasOwnProperty(attr)) || (!node.attributes.hasOwnProperty && Object.prototype.hasOwnProperty.call(node.attributes, attr)))  {\n      if (node.attributes[attr].specified) {\n        if (nodeName == \"IMG\" && node.attributes[attr].name.toLowerCase() == \"src\" && wysihtml5.dom.isLoadedImage(node) === true) {\n          attributes['src'] = node.src;\n        } else if (wysihtml5.lang.array(['rowspan', 'colspan']).contains(node.attributes[attr].name.toLowerCase()) && HAS_GET_ATTRIBUTE_BUG) {\n          if (node.attributes[attr].value !== 1) {\n            attributes[node.attributes[attr].name] = node.attributes[attr].value;\n          }\n        } else {\n          attributes[node.attributes[attr].name] = node.attributes[attr].value;\n        }\n      }\n    }\n  }\n  return attributes;\n};;/**\n   * Check whether the given node is a proper loaded image\n   * FIXME: Returns undefined when unknown (Chrome, Safari)\n*/\n\nwysihtml5.dom.isLoadedImage = function (node) {\n  try {\n    return node.complete && !node.mozMatchesSelector(\":-moz-broken\");\n  } catch(e) {\n    if (node.complete && node.readyState === \"complete\") {\n      return true;\n    }\n  }\n};\n;(function(wysihtml5) {\n\n    var api = wysihtml5.dom;\n\n    var MapCell = function(cell) {\n      this.el = cell;\n      this.isColspan= false;\n      this.isRowspan= false;\n      this.firstCol= true;\n      this.lastCol= true;\n      this.firstRow= true;\n      this.lastRow= true;\n      this.isReal= true;\n      this.spanCollection= [];\n      this.modified = false;\n    };\n\n    var TableModifyerByCell = function (cell, table) {\n        if (cell) {\n            this.cell = cell;\n            this.table = api.getParentElement(cell, { nodeName: [\"TABLE\"] });\n        } else if (table) {\n            this.table = table;\n            this.cell = this.table.querySelectorAll('th, td')[0];\n        }\n    };\n\n    function queryInList(list, query) {\n        var ret = [],\n            q;\n        for (var e = 0, len = list.length; e < len; e++) {\n            q = list[e].querySelectorAll(query);\n            if (q) {\n                for(var i = q.length; i--; ret.unshift(q[i]));\n            }\n        }\n        return ret;\n    }\n\n    function removeElement(el) {\n        el.parentNode.removeChild(el);\n    }\n\n    function insertAfter(referenceNode, newNode) {\n        referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);\n    }\n\n    function nextNode(node, tag) {\n        var element = node.nextSibling;\n        while (element.nodeType !=1) {\n            element = element.nextSibling;\n            if (!tag || tag == element.tagName.toLowerCase()) {\n                return element;\n            }\n        }\n        return null;\n    }\n\n    TableModifyerByCell.prototype = {\n\n        addSpannedCellToMap: function(cell, map, r, c, cspan, rspan) {\n            var spanCollect = [],\n                rmax = r + ((rspan) ? parseInt(rspan, 10) - 1 : 0),\n                cmax = c + ((cspan) ? parseInt(cspan, 10) - 1 : 0);\n\n            for (var rr = r; rr <= rmax; rr++) {\n                if (typeof map[rr] == \"undefined\") { map[rr] = []; }\n                for (var cc = c; cc <= cmax; cc++) {\n                    map[rr][cc] = new MapCell(cell);\n                    map[rr][cc].isColspan = (cspan && parseInt(cspan, 10) > 1);\n                    map[rr][cc].isRowspan = (rspan && parseInt(rspan, 10) > 1);\n                    map[rr][cc].firstCol = cc == c;\n                    map[rr][cc].lastCol = cc == cmax;\n                    map[rr][cc].firstRow = rr == r;\n                    map[rr][cc].lastRow = rr == rmax;\n                    map[rr][cc].isReal = cc == c && rr == r;\n                    map[rr][cc].spanCollection = spanCollect;\n\n                    spanCollect.push(map[rr][cc]);\n                }\n            }\n        },\n\n        setCellAsModified: function(cell) {\n            cell.modified = true;\n            if (cell.spanCollection.length > 0) {\n              for (var s = 0, smax = cell.spanCollection.length; s < smax; s++) {\n                cell.spanCollection[s].modified = true;\n              }\n            }\n        },\n\n        setTableMap: function() {\n            var map = [];\n            var tableRows = this.getTableRows(),\n                ridx, row, cells, cidx, cell,\n                c,\n                cspan, rspan;\n\n            for (ridx = 0; ridx < tableRows.length; ridx++) {\n                row = tableRows[ridx];\n                cells = this.getRowCells(row);\n                c = 0;\n                if (typeof map[ridx] == \"undefined\") { map[ridx] = []; }\n                for (cidx = 0; cidx < cells.length; cidx++) {\n                    cell = cells[cidx];\n\n                    // If cell allready set means it is set by col or rowspan,\n                    // so increase cols index until free col is found\n                    while (typeof map[ridx][c] != \"undefined\") { c++; }\n\n                    cspan = api.getAttribute(cell, 'colspan');\n                    rspan = api.getAttribute(cell, 'rowspan');\n\n                    if (cspan || rspan) {\n                        this.addSpannedCellToMap(cell, map, ridx, c, cspan, rspan);\n                        c = c + ((cspan) ? parseInt(cspan, 10) : 1);\n                    } else {\n                        map[ridx][c] = new MapCell(cell);\n                        c++;\n                    }\n                }\n            }\n            this.map = map;\n            return map;\n        },\n\n        getRowCells: function(row) {\n            var inlineTables = this.table.querySelectorAll('table'),\n                inlineCells = (inlineTables) ? queryInList(inlineTables, 'th, td') : [],\n                allCells = row.querySelectorAll('th, td'),\n                tableCells = (inlineCells.length > 0) ? wysihtml5.lang.array(allCells).without(inlineCells) : allCells;\n\n            return tableCells;\n        },\n\n        getTableRows: function() {\n          var inlineTables = this.table.querySelectorAll('table'),\n              inlineRows = (inlineTables) ? queryInList(inlineTables, 'tr') : [],\n              allRows = this.table.querySelectorAll('tr'),\n              tableRows = (inlineRows.length > 0) ? wysihtml5.lang.array(allRows).without(inlineRows) : allRows;\n\n          return tableRows;\n        },\n\n        getMapIndex: function(cell) {\n          var r_length = this.map.length,\n              c_length = (this.map && this.map[0]) ? this.map[0].length : 0;\n\n          for (var r_idx = 0;r_idx < r_length; r_idx++) {\n              for (var c_idx = 0;c_idx < c_length; c_idx++) {\n                  if (this.map[r_idx][c_idx].el === cell) {\n                      return {'row': r_idx, 'col': c_idx};\n                  }\n              }\n          }\n          return false;\n        },\n\n        getElementAtIndex: function(idx) {\n            this.setTableMap();\n            if (this.map[idx.row] && this.map[idx.row][idx.col] && this.map[idx.row][idx.col].el) {\n                return this.map[idx.row][idx.col].el;\n            }\n            return null;\n        },\n\n        getMapElsTo: function(to_cell) {\n            var els = [];\n            this.setTableMap();\n            this.idx_start = this.getMapIndex(this.cell);\n            this.idx_end = this.getMapIndex(to_cell);\n\n            // switch indexes if start is bigger than end\n            if (this.idx_start.row > this.idx_end.row || (this.idx_start.row == this.idx_end.row && this.idx_start.col > this.idx_end.col)) {\n                var temp_idx = this.idx_start;\n                this.idx_start = this.idx_end;\n                this.idx_end = temp_idx;\n            }\n            if (this.idx_start.col > this.idx_end.col) {\n                var temp_cidx = this.idx_start.col;\n                this.idx_start.col = this.idx_end.col;\n                this.idx_end.col = temp_cidx;\n            }\n\n            if (this.idx_start != null && this.idx_end != null) {\n                for (var row = this.idx_start.row, maxr = this.idx_end.row; row <= maxr; row++) {\n                    for (var col = this.idx_start.col, maxc = this.idx_end.col; col <= maxc; col++) {\n                        els.push(this.map[row][col].el);\n                    }\n                }\n            }\n            return els;\n        },\n\n        orderSelectionEnds: function(secondcell) {\n            this.setTableMap();\n            this.idx_start = this.getMapIndex(this.cell);\n            this.idx_end = this.getMapIndex(secondcell);\n\n            // switch indexes if start is bigger than end\n            if (this.idx_start.row > this.idx_end.row || (this.idx_start.row == this.idx_end.row && this.idx_start.col > this.idx_end.col)) {\n                var temp_idx = this.idx_start;\n                this.idx_start = this.idx_end;\n                this.idx_end = temp_idx;\n            }\n            if (this.idx_start.col > this.idx_end.col) {\n                var temp_cidx = this.idx_start.col;\n                this.idx_start.col = this.idx_end.col;\n                this.idx_end.col = temp_cidx;\n            }\n\n            return {\n                \"start\": this.map[this.idx_start.row][this.idx_start.col].el,\n                \"end\": this.map[this.idx_end.row][this.idx_end.col].el\n            };\n        },\n\n        createCells: function(tag, nr, attrs) {\n            var doc = this.table.ownerDocument,\n                frag = doc.createDocumentFragment(),\n                cell;\n            for (var i = 0; i < nr; i++) {\n                cell = doc.createElement(tag);\n\n                if (attrs) {\n                    for (var attr in attrs) {\n                        if (attrs.hasOwnProperty(attr)) {\n                            cell.setAttribute(attr, attrs[attr]);\n                        }\n                    }\n                }\n\n                // add non breaking space\n                cell.appendChild(document.createTextNode(\"\\u00a0\"));\n\n                frag.appendChild(cell);\n            }\n            return frag;\n        },\n\n        // Returns next real cell (not part of spanned cell unless first) on row if selected index is not real. I no real cells -1 will be returned\n        correctColIndexForUnreals: function(col, row) {\n            var r = this.map[row],\n                corrIdx = -1;\n            for (var i = 0, max = col; i < col; i++) {\n                if (r[i].isReal){\n                    corrIdx++;\n                }\n            }\n            return corrIdx;\n        },\n\n        getLastNewCellOnRow: function(row, rowLimit) {\n            var cells = this.getRowCells(row),\n                cell, idx;\n\n            for (var cidx = 0, cmax = cells.length; cidx < cmax; cidx++) {\n                cell = cells[cidx];\n                idx = this.getMapIndex(cell);\n                if (idx === false || (typeof rowLimit != \"undefined\" && idx.row != rowLimit)) {\n                    return cell;\n                }\n            }\n            return null;\n        },\n\n        removeEmptyTable: function() {\n            var cells = this.table.querySelectorAll('td, th');\n            if (!cells || cells.length == 0) {\n                removeElement(this.table);\n                return true;\n            } else {\n                return false;\n            }\n        },\n\n        // Splits merged cell on row to unique cells\n        splitRowToCells: function(cell) {\n            if (cell.isColspan) {\n                var colspan = parseInt(api.getAttribute(cell.el, 'colspan') || 1, 10),\n                    cType = cell.el.tagName.toLowerCase();\n                if (colspan > 1) {\n                    var newCells = this.createCells(cType, colspan -1);\n                    insertAfter(cell.el, newCells);\n                }\n                cell.el.removeAttribute('colspan');\n            }\n        },\n\n        getRealRowEl: function(force, idx) {\n            var r = null,\n                c = null;\n\n            idx = idx || this.idx;\n\n            for (var cidx = 0, cmax = this.map[idx.row].length; cidx < cmax; cidx++) {\n                c = this.map[idx.row][cidx];\n                if (c.isReal) {\n                    r = api.getParentElement(c.el, { nodeName: [\"TR\"] });\n                    if (r) {\n                        return r;\n                    }\n                }\n            }\n\n            if (r === null && force) {\n                r = api.getParentElement(this.map[idx.row][idx.col].el, { nodeName: [\"TR\"] }) || null;\n            }\n\n            return r;\n        },\n\n        injectRowAt: function(row, col, colspan, cType, c) {\n            var r = this.getRealRowEl(false, {'row': row, 'col': col}),\n                new_cells = this.createCells(cType, colspan);\n\n            if (r) {\n                var n_cidx = this.correctColIndexForUnreals(col, row);\n                if (n_cidx >= 0) {\n                    insertAfter(this.getRowCells(r)[n_cidx], new_cells);\n                } else {\n                    r.insertBefore(new_cells, r.firstChild);\n                }\n            } else {\n                var rr = this.table.ownerDocument.createElement('tr');\n                rr.appendChild(new_cells);\n                insertAfter(api.getParentElement(c.el, { nodeName: [\"TR\"] }), rr);\n            }\n        },\n\n        canMerge: function(to) {\n            this.to = to;\n            this.setTableMap();\n            this.idx_start = this.getMapIndex(this.cell);\n            this.idx_end = this.getMapIndex(this.to);\n\n            // switch indexes if start is bigger than end\n            if (this.idx_start.row > this.idx_end.row || (this.idx_start.row == this.idx_end.row && this.idx_start.col > this.idx_end.col)) {\n                var temp_idx = this.idx_start;\n                this.idx_start = this.idx_end;\n                this.idx_end = temp_idx;\n            }\n            if (this.idx_start.col > this.idx_end.col) {\n                var temp_cidx = this.idx_start.col;\n                this.idx_start.col = this.idx_end.col;\n                this.idx_end.col = temp_cidx;\n            }\n\n            for (var row = this.idx_start.row, maxr = this.idx_end.row; row <= maxr; row++) {\n                for (var col = this.idx_start.col, maxc = this.idx_end.col; col <= maxc; col++) {\n                    if (this.map[row][col].isColspan || this.map[row][col].isRowspan) {\n                        return false;\n                    }\n                }\n            }\n            return true;\n        },\n\n        decreaseCellSpan: function(cell, span) {\n            var nr = parseInt(api.getAttribute(cell.el, span), 10) - 1;\n            if (nr >= 1) {\n                cell.el.setAttribute(span, nr);\n            } else {\n                cell.el.removeAttribute(span);\n                if (span == 'colspan') {\n                    cell.isColspan = false;\n                }\n                if (span == 'rowspan') {\n                    cell.isRowspan = false;\n                }\n                cell.firstCol = true;\n                cell.lastCol = true;\n                cell.firstRow = true;\n                cell.lastRow = true;\n                cell.isReal = true;\n            }\n        },\n\n        removeSurplusLines: function() {\n            var row, cell, ridx, rmax, cidx, cmax, allRowspan;\n\n            this.setTableMap();\n            if (this.map) {\n                ridx = 0;\n                rmax = this.map.length;\n                for (;ridx < rmax; ridx++) {\n                    row = this.map[ridx];\n                    allRowspan = true;\n                    cidx = 0;\n                    cmax = row.length;\n                    for (; cidx < cmax; cidx++) {\n                        cell = row[cidx];\n                        if (!(api.getAttribute(cell.el, \"rowspan\") && parseInt(api.getAttribute(cell.el, \"rowspan\"), 10) > 1 && cell.firstRow !== true)) {\n                            allRowspan = false;\n                            break;\n                        }\n                    }\n                    if (allRowspan) {\n                        cidx = 0;\n                        for (; cidx < cmax; cidx++) {\n                            this.decreaseCellSpan(row[cidx], 'rowspan');\n                        }\n                    }\n                }\n\n                // remove rows without cells\n                var tableRows = this.getTableRows();\n                ridx = 0;\n                rmax = tableRows.length;\n                for (;ridx < rmax; ridx++) {\n                    row = tableRows[ridx];\n                    if (row.childNodes.length == 0 && (/^\\s*$/.test(row.textContent || row.innerText))) {\n                        removeElement(row);\n                    }\n                }\n            }\n        },\n\n        fillMissingCells: function() {\n            var r_max = 0,\n                c_max = 0,\n                prevcell = null;\n\n            this.setTableMap();\n            if (this.map) {\n\n                // find maximal dimensions of broken table\n                r_max = this.map.length;\n                for (var ridx = 0; ridx < r_max; ridx++) {\n                    if (this.map[ridx].length > c_max) { c_max = this.map[ridx].length; }\n                }\n\n                for (var row = 0; row < r_max; row++) {\n                    for (var col = 0; col < c_max; col++) {\n                        if (this.map[row] && !this.map[row][col]) {\n                            if (col > 0) {\n                                this.map[row][col] = new MapCell(this.createCells('td', 1));\n                                prevcell = this.map[row][col-1];\n                                if (prevcell && prevcell.el && prevcell.el.parent) { // if parent does not exist element is removed from dom\n                                    insertAfter(this.map[row][col-1].el, this.map[row][col].el);\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        },\n\n        rectify: function() {\n            if (!this.removeEmptyTable()) {\n                this.removeSurplusLines();\n                this.fillMissingCells();\n                return true;\n            } else {\n                return false;\n            }\n        },\n\n        unmerge: function() {\n            if (this.rectify()) {\n                this.setTableMap();\n                this.idx = this.getMapIndex(this.cell);\n\n                if (this.idx) {\n                    var thisCell = this.map[this.idx.row][this.idx.col],\n                        colspan = (api.getAttribute(thisCell.el, \"colspan\")) ? parseInt(api.getAttribute(thisCell.el, \"colspan\"), 10) : 1,\n                        cType = thisCell.el.tagName.toLowerCase();\n\n                    if (thisCell.isRowspan) {\n                        var rowspan = parseInt(api.getAttribute(thisCell.el, \"rowspan\"), 10);\n                        if (rowspan > 1) {\n                            for (var nr = 1, maxr = rowspan - 1; nr <= maxr; nr++){\n                                this.injectRowAt(this.idx.row + nr, this.idx.col, colspan, cType, thisCell);\n                            }\n                        }\n                        thisCell.el.removeAttribute('rowspan');\n                    }\n                    this.splitRowToCells(thisCell);\n                }\n            }\n        },\n\n        // merges cells from start cell (defined in creating obj) to \"to\" cell\n        merge: function(to) {\n            if (this.rectify()) {\n                if (this.canMerge(to)) {\n                    var rowspan = this.idx_end.row - this.idx_start.row + 1,\n                        colspan = this.idx_end.col - this.idx_start.col + 1;\n\n                    for (var row = this.idx_start.row, maxr = this.idx_end.row; row <= maxr; row++) {\n                        for (var col = this.idx_start.col, maxc = this.idx_end.col; col <= maxc; col++) {\n\n                            if (row == this.idx_start.row && col == this.idx_start.col) {\n                                if (rowspan > 1) {\n                                    this.map[row][col].el.setAttribute('rowspan', rowspan);\n                                }\n                                if (colspan > 1) {\n                                    this.map[row][col].el.setAttribute('colspan', colspan);\n                                }\n                            } else {\n                                // transfer content\n                                if (!(/^\\s*<br\\/?>\\s*$/.test(this.map[row][col].el.innerHTML.toLowerCase()))) {\n                                    this.map[this.idx_start.row][this.idx_start.col].el.innerHTML += ' ' + this.map[row][col].el.innerHTML;\n                                }\n                                removeElement(this.map[row][col].el);\n                            }\n                        }\n                    }\n                    this.rectify();\n                } else {\n                    if (window.console) {\n                        console.log('Do not know how to merge allready merged cells.');\n                    }\n                }\n            }\n        },\n\n        // Decreases rowspan of a cell if it is done on first cell of rowspan row (real cell)\n        // Cell is moved to next row (if it is real)\n        collapseCellToNextRow: function(cell) {\n            var cellIdx = this.getMapIndex(cell.el),\n                newRowIdx = cellIdx.row + 1,\n                newIdx = {'row': newRowIdx, 'col': cellIdx.col};\n\n            if (newRowIdx < this.map.length) {\n\n                var row = this.getRealRowEl(false, newIdx);\n                if (row !== null) {\n                    var n_cidx = this.correctColIndexForUnreals(newIdx.col, newIdx.row);\n                    if (n_cidx >= 0) {\n                        insertAfter(this.getRowCells(row)[n_cidx], cell.el);\n                    } else {\n                        var lastCell = this.getLastNewCellOnRow(row, newRowIdx);\n                        if (lastCell !== null) {\n                            insertAfter(lastCell, cell.el);\n                        } else {\n                            row.insertBefore(cell.el, row.firstChild);\n                        }\n                    }\n                    if (parseInt(api.getAttribute(cell.el, 'rowspan'), 10) > 2) {\n                        cell.el.setAttribute('rowspan', parseInt(api.getAttribute(cell.el, 'rowspan'), 10) - 1);\n                    } else {\n                        cell.el.removeAttribute('rowspan');\n                    }\n                }\n            }\n        },\n\n        // Removes a cell when removing a row\n        // If is rowspan cell then decreases the rowspan\n        // and moves cell to next row if needed (is first cell of rowspan)\n        removeRowCell: function(cell) {\n            if (cell.isReal) {\n               if (cell.isRowspan) {\n                   this.collapseCellToNextRow(cell);\n               } else {\n                   removeElement(cell.el);\n               }\n            } else {\n                if (parseInt(api.getAttribute(cell.el, 'rowspan'), 10) > 2) {\n                    cell.el.setAttribute('rowspan', parseInt(api.getAttribute(cell.el, 'rowspan'), 10) - 1);\n                } else {\n                    cell.el.removeAttribute('rowspan');\n                }\n            }\n        },\n\n        getRowElementsByCell: function() {\n            var cells = [];\n            this.setTableMap();\n            this.idx = this.getMapIndex(this.cell);\n            if (this.idx !== false) {\n                var modRow = this.map[this.idx.row];\n                for (var cidx = 0, cmax = modRow.length; cidx < cmax; cidx++) {\n                    if (modRow[cidx].isReal) {\n                        cells.push(modRow[cidx].el);\n                    }\n                }\n            }\n            return cells;\n        },\n\n        getColumnElementsByCell: function() {\n            var cells = [];\n            this.setTableMap();\n            this.idx = this.getMapIndex(this.cell);\n            if (this.idx !== false) {\n                for (var ridx = 0, rmax = this.map.length; ridx < rmax; ridx++) {\n                    if (this.map[ridx][this.idx.col] && this.map[ridx][this.idx.col].isReal) {\n                        cells.push(this.map[ridx][this.idx.col].el);\n                    }\n                }\n            }\n            return cells;\n        },\n\n        // Removes the row of selected cell\n        removeRow: function() {\n            var oldRow = api.getParentElement(this.cell, { nodeName: [\"TR\"] });\n            if (oldRow) {\n                this.setTableMap();\n                this.idx = this.getMapIndex(this.cell);\n                if (this.idx !== false) {\n                    var modRow = this.map[this.idx.row];\n                    for (var cidx = 0, cmax = modRow.length; cidx < cmax; cidx++) {\n                        if (!modRow[cidx].modified) {\n                            this.setCellAsModified(modRow[cidx]);\n                            this.removeRowCell(modRow[cidx]);\n                        }\n                    }\n                }\n                removeElement(oldRow);\n            }\n        },\n\n        removeColCell: function(cell) {\n            if (cell.isColspan) {\n                if (parseInt(api.getAttribute(cell.el, 'colspan'), 10) > 2) {\n                    cell.el.setAttribute('colspan', parseInt(api.getAttribute(cell.el, 'colspan'), 10) - 1);\n                } else {\n                    cell.el.removeAttribute('colspan');\n                }\n            } else if (cell.isReal) {\n                removeElement(cell.el);\n            }\n        },\n\n        removeColumn: function() {\n            this.setTableMap();\n            this.idx = this.getMapIndex(this.cell);\n            if (this.idx !== false) {\n                for (var ridx = 0, rmax = this.map.length; ridx < rmax; ridx++) {\n                    if (!this.map[ridx][this.idx.col].modified) {\n                        this.setCellAsModified(this.map[ridx][this.idx.col]);\n                        this.removeColCell(this.map[ridx][this.idx.col]);\n                    }\n                }\n            }\n        },\n\n        // removes row or column by selected cell element\n        remove: function(what) {\n            if (this.rectify()) {\n                switch (what) {\n                    case 'row':\n                        this.removeRow();\n                    break;\n                    case 'column':\n                        this.removeColumn();\n                    break;\n                }\n                this.rectify();\n            }\n        },\n\n        addRow: function(where) {\n            var doc = this.table.ownerDocument;\n\n            this.setTableMap();\n            this.idx = this.getMapIndex(this.cell);\n            if (where == \"below\" && api.getAttribute(this.cell, 'rowspan')) {\n                this.idx.row = this.idx.row + parseInt(api.getAttribute(this.cell, 'rowspan'), 10) - 1;\n            }\n\n            if (this.idx !== false) {\n                var modRow = this.map[this.idx.row],\n                    newRow = doc.createElement('tr');\n\n                for (var ridx = 0, rmax = modRow.length; ridx < rmax; ridx++) {\n                    if (!modRow[ridx].modified) {\n                        this.setCellAsModified(modRow[ridx]);\n                        this.addRowCell(modRow[ridx], newRow, where);\n                    }\n                }\n\n                switch (where) {\n                    case 'below':\n                        insertAfter(this.getRealRowEl(true), newRow);\n                    break;\n                    case 'above':\n                        var cr = api.getParentElement(this.map[this.idx.row][this.idx.col].el, { nodeName: [\"TR\"] });\n                        if (cr) {\n                            cr.parentNode.insertBefore(newRow, cr);\n                        }\n                    break;\n                }\n            }\n        },\n\n        addRowCell: function(cell, row, where) {\n            var colSpanAttr = (cell.isColspan) ? {\"colspan\" : api.getAttribute(cell.el, 'colspan')} : null;\n            if (cell.isReal) {\n                if (where != 'above' && cell.isRowspan) {\n                    cell.el.setAttribute('rowspan', parseInt(api.getAttribute(cell.el,'rowspan'), 10) + 1);\n                } else {\n                    row.appendChild(this.createCells('td', 1, colSpanAttr));\n                }\n            } else {\n                if (where != 'above' && cell.isRowspan && cell.lastRow) {\n                    row.appendChild(this.createCells('td', 1, colSpanAttr));\n                } else if (c.isRowspan) {\n                    cell.el.attr('rowspan', parseInt(api.getAttribute(cell.el, 'rowspan'), 10) + 1);\n                }\n            }\n        },\n\n        add: function(where) {\n            if (this.rectify()) {\n                if (where == 'below' || where == 'above') {\n                    this.addRow(where);\n                }\n                if (where == 'before' || where == 'after') {\n                    this.addColumn(where);\n                }\n            }\n        },\n\n        addColCell: function (cell, ridx, where) {\n            var doAdd,\n                cType = cell.el.tagName.toLowerCase();\n\n            // defines add cell vs expand cell conditions\n            // true means add\n            switch (where) {\n                case \"before\":\n                    doAdd = (!cell.isColspan || cell.firstCol);\n                break;\n                case \"after\":\n                    doAdd = (!cell.isColspan || cell.lastCol || (cell.isColspan && c.el == this.cell));\n                break;\n            }\n\n            if (doAdd){\n                // adds a cell before or after current cell element\n                switch (where) {\n                    case \"before\":\n                        cell.el.parentNode.insertBefore(this.createCells(cType, 1), cell.el);\n                    break;\n                    case \"after\":\n                        insertAfter(cell.el, this.createCells(cType, 1));\n                    break;\n                }\n\n                // handles if cell has rowspan\n                if (cell.isRowspan) {\n                    this.handleCellAddWithRowspan(cell, ridx+1, where);\n                }\n\n            } else {\n                // expands cell\n                cell.el.setAttribute('colspan',  parseInt(api.getAttribute(cell.el, 'colspan'), 10) + 1);\n            }\n        },\n\n        addColumn: function(where) {\n            var row, modCell;\n\n            this.setTableMap();\n            this.idx = this.getMapIndex(this.cell);\n            if (where == \"after\" && api.getAttribute(this.cell, 'colspan')) {\n              this.idx.col = this.idx.col + parseInt(api.getAttribute(this.cell, 'colspan'), 10) - 1;\n            }\n\n            if (this.idx !== false) {\n                for (var ridx = 0, rmax = this.map.length; ridx < rmax; ridx++ ) {\n                    row = this.map[ridx];\n                    if (row[this.idx.col]) {\n                        modCell = row[this.idx.col];\n                        if (!modCell.modified) {\n                            this.setCellAsModified(modCell);\n                            this.addColCell(modCell, ridx , where);\n                        }\n                    }\n                }\n            }\n        },\n\n        handleCellAddWithRowspan: function (cell, ridx, where) {\n            var addRowsNr = parseInt(api.getAttribute(this.cell, 'rowspan'), 10) - 1,\n                crow = api.getParentElement(cell.el, { nodeName: [\"TR\"] }),\n                cType = cell.el.tagName.toLowerCase(),\n                cidx, temp_r_cells,\n                doc = this.table.ownerDocument,\n                nrow;\n\n            for (var i = 0; i < addRowsNr; i++) {\n                cidx = this.correctColIndexForUnreals(this.idx.col, (ridx + i));\n                crow = nextNode(crow, 'tr');\n                if (crow) {\n                    if (cidx > 0) {\n                        switch (where) {\n                            case \"before\":\n                                temp_r_cells = this.getRowCells(crow);\n                                if (cidx > 0 && this.map[ridx + i][this.idx.col].el != temp_r_cells[cidx] && cidx == temp_r_cells.length - 1) {\n                                     insertAfter(temp_r_cells[cidx], this.createCells(cType, 1));\n                                } else {\n                                    temp_r_cells[cidx].parentNode.insertBefore(this.createCells(cType, 1), temp_r_cells[cidx]);\n                                }\n\n                            break;\n                            case \"after\":\n                                insertAfter(this.getRowCells(crow)[cidx], this.createCells(cType, 1));\n                            break;\n                        }\n                    } else {\n                        crow.insertBefore(this.createCells(cType, 1), crow.firstChild);\n                    }\n                } else {\n                    nrow = doc.createElement('tr');\n                    nrow.appendChild(this.createCells(cType, 1));\n                    this.table.appendChild(nrow);\n                }\n            }\n        }\n    };\n\n    api.table = {\n        getCellsBetween: function(cell1, cell2) {\n            var c1 = new TableModifyerByCell(cell1);\n            return c1.getMapElsTo(cell2);\n        },\n\n        addCells: function(cell, where) {\n            var c = new TableModifyerByCell(cell);\n            c.add(where);\n        },\n\n        removeCells: function(cell, what) {\n            var c = new TableModifyerByCell(cell);\n            c.remove(what);\n        },\n\n        mergeCellsBetween: function(cell1, cell2) {\n            var c1 = new TableModifyerByCell(cell1);\n            c1.merge(cell2);\n        },\n\n        unmergeCell: function(cell) {\n            var c = new TableModifyerByCell(cell);\n            c.unmerge();\n        },\n\n        orderSelectionEnds: function(cell, cell2) {\n            var c = new TableModifyerByCell(cell);\n            return c.orderSelectionEnds(cell2);\n        },\n\n        indexOf: function(cell) {\n            var c = new TableModifyerByCell(cell);\n            c.setTableMap();\n            return c.getMapIndex(cell);\n        },\n\n        findCell: function(table, idx) {\n            var c = new TableModifyerByCell(null, table);\n            return c.getElementAtIndex(idx);\n        },\n\n        findRowByCell: function(cell) {\n            var c = new TableModifyerByCell(cell);\n            return c.getRowElementsByCell();\n        },\n\n        findColumnByCell: function(cell) {\n            var c = new TableModifyerByCell(cell);\n            return c.getColumnElementsByCell();\n        },\n\n        canMerge: function(cell1, cell2) {\n            var c = new TableModifyerByCell(cell1);\n            return c.canMerge(cell2);\n        }\n    };\n\n\n\n})(wysihtml5);\n;// does a selector query on element or array of elements\n\nwysihtml5.dom.query = function(elements, query) {\n    var ret = [],\n        q;\n\n    if (elements.nodeType) {\n        elements = [elements];\n    }\n\n    for (var e = 0, len = elements.length; e < len; e++) {\n        q = elements[e].querySelectorAll(query);\n        if (q) {\n            for(var i = q.length; i--; ret.unshift(q[i]));\n        }\n    }\n    return ret;\n};\n;wysihtml5.dom.compareDocumentPosition = (function() {\n  var documentElement = document.documentElement;\n  if (documentElement.compareDocumentPosition) {\n    return function(container, element) {\n      return container.compareDocumentPosition(element);\n    };\n  } else {\n    return function( container, element ) {\n      // implementation borrowed from https://github.com/tmpvar/jsdom/blob/681a8524b663281a0f58348c6129c8c184efc62c/lib/jsdom/level3/core.js // MIT license\n      var thisOwner, otherOwner;\n\n      if( container.nodeType === 9) // Node.DOCUMENT_NODE\n        thisOwner = container;\n      else\n        thisOwner = container.ownerDocument;\n\n      if( element.nodeType === 9) // Node.DOCUMENT_NODE\n        otherOwner = element;\n      else\n        otherOwner = element.ownerDocument;\n\n      if( container === element ) return 0;\n      if( container === element.ownerDocument ) return 4 + 16; //Node.DOCUMENT_POSITION_FOLLOWING + Node.DOCUMENT_POSITION_CONTAINED_BY;\n      if( container.ownerDocument === element ) return 2 + 8;  //Node.DOCUMENT_POSITION_PRECEDING + Node.DOCUMENT_POSITION_CONTAINS;\n      if( thisOwner !== otherOwner ) return 1; // Node.DOCUMENT_POSITION_DISCONNECTED;\n\n      // Text nodes for attributes does not have a _parentNode. So we need to find them as attribute child.\n      if( container.nodeType === 2 /*Node.ATTRIBUTE_NODE*/ && container.childNodes && wysihtml5.lang.array(container.childNodes).indexOf( element ) !== -1)\n        return 4 + 16; //Node.DOCUMENT_POSITION_FOLLOWING + Node.DOCUMENT_POSITION_CONTAINED_BY;\n\n      if( element.nodeType === 2 /*Node.ATTRIBUTE_NODE*/ && element.childNodes && wysihtml5.lang.array(element.childNodes).indexOf( container ) !== -1)\n        return 2 + 8; //Node.DOCUMENT_POSITION_PRECEDING + Node.DOCUMENT_POSITION_CONTAINS;\n\n      var point = container;\n      var parents = [ ];\n      var previous = null;\n      while( point ) {\n        if( point == element ) return 2 + 8; //Node.DOCUMENT_POSITION_PRECEDING + Node.DOCUMENT_POSITION_CONTAINS;\n        parents.push( point );\n        point = point.parentNode;\n      }\n      point = element;\n      previous = null;\n      while( point ) {\n        if( point == container ) return 4 + 16; //Node.DOCUMENT_POSITION_FOLLOWING + Node.DOCUMENT_POSITION_CONTAINED_BY;\n        var location_index = wysihtml5.lang.array(parents).indexOf( point );\n        if( location_index !== -1) {\n         var smallest_common_ancestor = parents[ location_index ];\n         var this_index = wysihtml5.lang.array(smallest_common_ancestor.childNodes).indexOf( parents[location_index - 1]);//smallest_common_ancestor.childNodes.toArray().indexOf( parents[location_index - 1] );\n         var other_index = wysihtml5.lang.array(smallest_common_ancestor.childNodes).indexOf( previous ); //smallest_common_ancestor.childNodes.toArray().indexOf( previous );\n         if( this_index > other_index ) {\n               return 2; //Node.DOCUMENT_POSITION_PRECEDING;\n         }\n         else {\n           return 4; //Node.DOCUMENT_POSITION_FOLLOWING;\n         }\n        }\n        previous = point;\n        point = point.parentNode;\n      }\n      return 1; //Node.DOCUMENT_POSITION_DISCONNECTED;\n    };\n  }\n})();\n;wysihtml5.dom.unwrap = function(node) {\n  if (node.parentNode) {\n    while (node.lastChild) {\n      wysihtml5.dom.insert(node.lastChild).after(node);\n    }\n    node.parentNode.removeChild(node);\n  }\n};;/* \n * Methods for fetching pasted html before it gets inserted into content\n**/\n\n/* Modern event.clipboardData driven approach.\n * Advantage is that it does not have to loose selection or modify dom to catch the data. \n * IE does not support though.\n**/\nwysihtml5.dom.getPastedHtml = function(event) {\n  var html;\n  if (event.clipboardData) {\n    if (wysihtml5.lang.array(event.clipboardData.types).contains('text/html')) {\n      html = event.clipboardData.getData('text/html');\n    } else if (wysihtml5.lang.array(event.clipboardData.types).contains('text/plain')) {\n      html = wysihtml5.lang.string(event.clipboardData.getData('text/plain')).escapeHTML(true, true);\n    }\n  }\n  return html;\n};\n\n/* Older temprorary contenteditable as paste source catcher method for fallbacks */\nwysihtml5.dom.getPastedHtmlWithDiv = function (composer, f) {\n  var selBookmark = composer.selection.getBookmark(),\n      doc = composer.element.ownerDocument,\n      cleanerDiv = doc.createElement('DIV');\n  \n  doc.body.appendChild(cleanerDiv);\n\n  cleanerDiv.style.width = \"1px\";\n  cleanerDiv.style.height = \"1px\";\n  cleanerDiv.style.overflow = \"hidden\";\n\n  cleanerDiv.setAttribute('contenteditable', 'true');\n  cleanerDiv.focus();\n\n  setTimeout(function () {\n    composer.selection.setBookmark(selBookmark);\n    f(cleanerDiv.innerHTML);\n    cleanerDiv.parentNode.removeChild(cleanerDiv);\n  }, 0);\n};;/**\n * Fix most common html formatting misbehaviors of browsers implementation when inserting\n * content via copy & paste contentEditable\n *\n * @author Christopher Blum\n */\nwysihtml5.quirks.cleanPastedHTML = (function() {\n\n  var styleToRegex = function (styleStr) {\n    var trimmedStr = wysihtml5.lang.string(styleStr).trim(),\n        escapedStr = trimmedStr.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\");\n\n    return new RegExp(\"^((?!^\" + escapedStr + \"$).)*$\", \"i\");\n  };\n\n  var extendRulesWithStyleExceptions = function (rules, exceptStyles) {\n    var newRules = wysihtml5.lang.object(rules).clone(true),\n        tag, style;\n\n    for (tag in newRules.tags) {\n\n      if (newRules.tags.hasOwnProperty(tag)) {\n        if (newRules.tags[tag].keep_styles) {\n          for (style in newRules.tags[tag].keep_styles) {\n            if (newRules.tags[tag].keep_styles.hasOwnProperty(style)) {\n              if (exceptStyles[style]) {\n                newRules.tags[tag].keep_styles[style] = styleToRegex(exceptStyles[style]);\n              }\n            }\n          }\n        }\n      }\n    }\n\n    return newRules;\n  };\n\n  var pickRuleset = function(ruleset, html) {\n    var pickedSet, defaultSet;\n\n    if (!ruleset) {\n      return null;\n    }\n\n    for (var i = 0, max = ruleset.length; i < max; i++) {\n      if (!ruleset[i].condition) {\n        defaultSet = ruleset[i].set;\n      }\n      if (ruleset[i].condition && ruleset[i].condition.test(html)) {\n        return ruleset[i].set;\n      }\n    }\n\n    return defaultSet;\n  };\n\n  return function(html, options) {\n    var exceptStyles = {\n          'color': wysihtml5.dom.getStyle(\"color\").from(options.referenceNode),\n          'fontSize': wysihtml5.dom.getStyle(\"font-size\").from(options.referenceNode)\n        },\n        rules = extendRulesWithStyleExceptions(pickRuleset(options.rules, html) || {}, exceptStyles),\n        newHtml;\n\n    newHtml = wysihtml5.dom.parse(html, {\n      \"rules\": rules,\n      \"cleanUp\": true, // <span> elements, empty or without attributes, should be removed/replaced with their content\n      \"context\": options.referenceNode.ownerDocument,\n      \"uneditableClass\": options.uneditableClass,\n      \"clearInternals\" : true, // don't paste temprorary selection and other markings\n      \"unjoinNbsps\" : true\n    });\n\n    return newHtml;\n  };\n\n})();;/**\n * IE and Opera leave an empty paragraph in the contentEditable element after clearing it\n *\n * @param {Object} contentEditableElement The contentEditable element to observe for clearing events\n * @exaple\n *    wysihtml5.quirks.ensureProperClearing(myContentEditableElement);\n */\nwysihtml5.quirks.ensureProperClearing = (function() {\n  var clearIfNecessary = function() {\n    var element = this;\n    setTimeout(function() {\n      var innerHTML = element.innerHTML.toLowerCase();\n      if (innerHTML == \"<p>&nbsp;</p>\" ||\n          innerHTML == \"<p>&nbsp;</p><p>&nbsp;</p>\") {\n        element.innerHTML = \"\";\n      }\n    }, 0);\n  };\n\n  return function(composer) {\n    wysihtml5.dom.observe(composer.element, [\"cut\", \"keydown\"], clearIfNecessary);\n  };\n})();\n;// See https://bugzilla.mozilla.org/show_bug.cgi?id=664398\n//\n// In Firefox this:\n//      var d = document.createElement(\"div\");\n//      d.innerHTML ='<a href=\"~\"></a>';\n//      d.innerHTML;\n// will result in:\n//      <a href=\"%7E\"></a>\n// which is wrong\n(function(wysihtml5) {\n  var TILDE_ESCAPED = \"%7E\";\n  wysihtml5.quirks.getCorrectInnerHTML = function(element) {\n    var innerHTML = element.innerHTML;\n    if (innerHTML.indexOf(TILDE_ESCAPED) === -1) {\n      return innerHTML;\n    }\n\n    var elementsWithTilde = element.querySelectorAll(\"[href*='~'], [src*='~']\"),\n        url,\n        urlToSearch,\n        length,\n        i;\n    for (i=0, length=elementsWithTilde.length; i<length; i++) {\n      url         = elementsWithTilde[i].href || elementsWithTilde[i].src;\n      urlToSearch = wysihtml5.lang.string(url).replace(\"~\").by(TILDE_ESCAPED);\n      innerHTML   = wysihtml5.lang.string(innerHTML).replace(urlToSearch).by(url);\n    }\n    return innerHTML;\n  };\n})(wysihtml5);\n;/**\n * Force rerendering of a given element\n * Needed to fix display misbehaviors of IE\n *\n * @param {Element} element The element object which needs to be rerendered\n * @example\n *    wysihtml5.quirks.redraw(document.body);\n */\n(function(wysihtml5) {\n  var CLASS_NAME = \"wysihtml5-quirks-redraw\";\n\n  wysihtml5.quirks.redraw = function(element) {\n    wysihtml5.dom.addClass(element, CLASS_NAME);\n    wysihtml5.dom.removeClass(element, CLASS_NAME);\n\n    // Following hack is needed for firefox to make sure that image resize handles are properly removed\n    try {\n      var doc = element.ownerDocument;\n      doc.execCommand(\"italic\", false, null);\n      doc.execCommand(\"italic\", false, null);\n    } catch(e) {}\n  };\n})(wysihtml5);\n;wysihtml5.quirks.tableCellsSelection = function(editable, editor) {\n\n    var dom = wysihtml5.dom,\n        select = {\n            table: null,\n            start: null,\n            end: null,\n            cells: null,\n            select: selectCells\n        },\n        selection_class = \"wysiwyg-tmp-selected-cell\",\n        moveHandler = null,\n        upHandler = null;\n\n    function init () {\n\n        dom.observe(editable, \"mousedown\", function(event) {\n          var target = wysihtml5.dom.getParentElement(event.target, { nodeName: [\"TD\", \"TH\"] });\n          if (target) {\n              handleSelectionMousedown(target);\n          }\n        });\n\n        return select;\n    }\n\n    function handleSelectionMousedown (target) {\n      select.start = target;\n      select.end = target;\n      select.cells = [target];\n      select.table = dom.getParentElement(select.start, { nodeName: [\"TABLE\"] });\n\n      if (select.table) {\n        removeCellSelections();\n        dom.addClass(target, selection_class);\n        moveHandler = dom.observe(editable, \"mousemove\", handleMouseMove);\n        upHandler = dom.observe(editable, \"mouseup\", handleMouseUp);\n        editor.fire(\"tableselectstart\").fire(\"tableselectstart:composer\");\n      }\n    }\n\n    // remove all selection classes\n    function removeCellSelections () {\n        if (editable) {\n            var selectedCells = editable.querySelectorAll('.' + selection_class);\n            if (selectedCells.length > 0) {\n              for (var i = 0; i < selectedCells.length; i++) {\n                  dom.removeClass(selectedCells[i], selection_class);\n              }\n            }\n        }\n    }\n\n    function addSelections (cells) {\n      for (var i = 0; i < cells.length; i++) {\n        dom.addClass(cells[i], selection_class);\n      }\n    }\n\n    function handleMouseMove (event) {\n      var curTable = null,\n          cell = dom.getParentElement(event.target, { nodeName: [\"TD\",\"TH\"] }),\n          oldEnd;\n\n      if (cell && select.table && select.start) {\n        curTable =  dom.getParentElement(cell, { nodeName: [\"TABLE\"] });\n        if (curTable && curTable === select.table) {\n          removeCellSelections();\n          oldEnd = select.end;\n          select.end = cell;\n          select.cells = dom.table.getCellsBetween(select.start, cell);\n          if (select.cells.length > 1) {\n            editor.composer.selection.deselect();\n          }\n          addSelections(select.cells);\n          if (select.end !== oldEnd) {\n            editor.fire(\"tableselectchange\").fire(\"tableselectchange:composer\");\n          }\n        }\n      }\n    }\n\n    function handleMouseUp (event) {\n      moveHandler.stop();\n      upHandler.stop();\n      editor.fire(\"tableselect\").fire(\"tableselect:composer\");\n      setTimeout(function() {\n        bindSideclick();\n      },0);\n    }\n\n    function bindSideclick () {\n        var sideClickHandler = dom.observe(editable.ownerDocument, \"click\", function(event) {\n          sideClickHandler.stop();\n          if (dom.getParentElement(event.target, { nodeName: [\"TABLE\"] }) != select.table) {\n              removeCellSelections();\n              select.table = null;\n              select.start = null;\n              select.end = null;\n              editor.fire(\"tableunselect\").fire(\"tableunselect:composer\");\n          }\n        });\n    }\n\n    function selectCells (start, end) {\n        select.start = start;\n        select.end = end;\n        select.table = dom.getParentElement(select.start, { nodeName: [\"TABLE\"] });\n        selectedCells = dom.table.getCellsBetween(select.start, select.end);\n        addSelections(selectedCells);\n        bindSideclick();\n        editor.fire(\"tableselect\").fire(\"tableselect:composer\");\n    }\n\n    return init();\n\n};\n;(function(wysihtml5) {\n  var RGBA_REGEX     = /^rgba\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*([\\d\\.]+)\\s*\\)/i,\n      RGB_REGEX      = /^rgb\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*\\)/i,\n      HEX6_REGEX     = /^#([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])/i,\n      HEX3_REGEX     = /^#([0-9a-f])([0-9a-f])([0-9a-f])/i;\n\n  var param_REGX = function (p) {\n    return new RegExp(\"(^|\\\\s|;)\" + p + \"\\\\s*:\\\\s*[^;$]+\" , \"gi\");\n  };\n\n  wysihtml5.quirks.styleParser = {\n\n    parseColor: function(stylesStr, paramName) {\n      var paramRegex = param_REGX(paramName),\n          params = stylesStr.match(paramRegex),\n          radix = 10,\n          str, colorMatch;\n\n      if (params) {\n        for (var i = params.length; i--;) {\n          params[i] = wysihtml5.lang.string(params[i].split(':')[1]).trim();\n        }\n        str = params[params.length-1];\n\n        if (RGBA_REGEX.test(str)) {\n          colorMatch = str.match(RGBA_REGEX);\n        } else if (RGB_REGEX.test(str)) {\n          colorMatch = str.match(RGB_REGEX);\n        } else if (HEX6_REGEX.test(str)) {\n          colorMatch = str.match(HEX6_REGEX);\n          radix = 16;\n        } else if (HEX3_REGEX.test(str)) {\n          colorMatch = str.match(HEX3_REGEX);\n          colorMatch.shift();\n          colorMatch.push(1);\n          return wysihtml5.lang.array(colorMatch).map(function(d, idx) {\n            return (idx < 3) ? (parseInt(d, 16) * 16) + parseInt(d, 16): parseFloat(d);\n          });\n        }\n\n        if (colorMatch) {\n          colorMatch.shift();\n          if (!colorMatch[3]) {\n            colorMatch.push(1);\n          }\n          return wysihtml5.lang.array(colorMatch).map(function(d, idx) {\n            return (idx < 3) ? parseInt(d, radix): parseFloat(d);\n          });\n        }\n      }\n      return false;\n    },\n\n    unparseColor: function(val, props) {\n      if (props) {\n        if (props == \"hex\") {\n          return (val[0].toString(16).toUpperCase()) + (val[1].toString(16).toUpperCase()) + (val[2].toString(16).toUpperCase());\n        } else if (props == \"hash\") {\n          return \"#\" + (val[0].toString(16).toUpperCase()) + (val[1].toString(16).toUpperCase()) + (val[2].toString(16).toUpperCase());\n        } else if (props == \"rgb\") {\n          return \"rgb(\" + val[0] + \",\" + val[1] + \",\" + val[2] + \")\";\n        } else if (props == \"rgba\") {\n          return \"rgba(\" + val[0] + \",\" + val[1] + \",\" + val[2] + \",\" + val[3] + \")\";\n        } else if (props == \"csv\") {\n          return  val[0] + \",\" + val[1] + \",\" + val[2] + \",\" + val[3];\n        }\n      }\n\n      if (val[3] && val[3] !== 1) {\n        return \"rgba(\" + val[0] + \",\" + val[1] + \",\" + val[2] + \",\" + val[3] + \")\";\n      } else {\n        return \"rgb(\" + val[0] + \",\" + val[1] + \",\" + val[2] + \")\";\n      }\n    },\n\n    parseFontSize: function(stylesStr) {\n      var params = stylesStr.match(param_REGX('font-size'));\n      if (params) {\n        return wysihtml5.lang.string(params[params.length - 1].split(':')[1]).trim();\n      }\n      return false;\n    }\n  };\n\n})(wysihtml5);\n;/**\n * Selection API\n *\n * @example\n *    var selection = new wysihtml5.Selection(editor);\n */\n(function(wysihtml5) {\n  var dom = wysihtml5.dom;\n\n  function _getCumulativeOffsetTop(element) {\n    var top = 0;\n    if (element.parentNode) {\n      do {\n        top += element.offsetTop || 0;\n        element = element.offsetParent;\n      } while (element);\n    }\n    return top;\n  }\n\n  // Provides the depth of ``descendant`` relative to ``ancestor``\n  function getDepth(ancestor, descendant) {\n      var ret = 0;\n      while (descendant !== ancestor) {\n          ret++;\n          descendant = descendant.parentNode;\n          if (!descendant)\n              throw new Error(\"not a descendant of ancestor!\");\n      }\n      return ret;\n  }\n\n  // Should fix the obtained ranges that cannot surrond contents normally to apply changes upon\n  // Being considerate to firefox that sets range start start out of span and end inside on doubleclick initiated selection\n  function expandRangeToSurround(range) {\n      if (range.canSurroundContents()) return;\n\n      var common = range.commonAncestorContainer,\n          start_depth = getDepth(common, range.startContainer),\n          end_depth = getDepth(common, range.endContainer);\n\n      while(!range.canSurroundContents()) {\n        // In the following branches, we cannot just decrement the depth variables because the setStartBefore/setEndAfter may move the start or end of the range more than one level relative to ``common``. So we need to recompute the depth.\n        if (start_depth > end_depth) {\n            range.setStartBefore(range.startContainer);\n            start_depth = getDepth(common, range.startContainer);\n        }\n        else {\n            range.setEndAfter(range.endContainer);\n            end_depth = getDepth(common, range.endContainer);\n        }\n      }\n  }\n\n  wysihtml5.Selection = Base.extend(\n    /** @scope wysihtml5.Selection.prototype */ {\n    constructor: function(editor, contain, unselectableClass) {\n      // Make sure that our external range library is initialized\n      window.rangy.init();\n\n      this.editor   = editor;\n      this.composer = editor.composer;\n      this.doc      = this.composer.doc;\n      this.contain = contain;\n      this.unselectableClass = unselectableClass || false;\n    },\n\n    /**\n     * Get the current selection as a bookmark to be able to later restore it\n     *\n     * @return {Object} An object that represents the current selection\n     */\n    getBookmark: function() {\n      var range = this.getRange();\n      if (range) expandRangeToSurround(range);\n      return range && range.cloneRange();\n    },\n\n    /**\n     * Restore a selection retrieved via wysihtml5.Selection.prototype.getBookmark\n     *\n     * @param {Object} bookmark An object that represents the current selection\n     */\n    setBookmark: function(bookmark) {\n      if (!bookmark) {\n        return;\n      }\n\n      this.setSelection(bookmark);\n    },\n\n    /**\n     * Set the caret in front of the given node\n     *\n     * @param {Object} node The element or text node where to position the caret in front of\n     * @example\n     *    selection.setBefore(myElement);\n     */\n    setBefore: function(node) {\n      var range = rangy.createRange(this.doc);\n      range.setStartBefore(node);\n      range.setEndBefore(node);\n      return this.setSelection(range);\n    },\n\n    /**\n     * Set the caret after the given node\n     *\n     * @param {Object} node The element or text node where to position the caret in front of\n     * @example\n     *    selection.setBefore(myElement);\n     */\n    setAfter: function(node) {\n      var range = rangy.createRange(this.doc);\n\n      range.setStartAfter(node);\n      range.setEndAfter(node);\n      return this.setSelection(range);\n    },\n\n    /**\n     * Ability to select/mark nodes\n     *\n     * @param {Element} node The node/element to select\n     * @example\n     *    selection.selectNode(document.getElementById(\"my-image\"));\n     */\n    selectNode: function(node, avoidInvisibleSpace) {\n      var range           = rangy.createRange(this.doc),\n          isElement       = node.nodeType === wysihtml5.ELEMENT_NODE,\n          canHaveHTML     = \"canHaveHTML\" in node ? node.canHaveHTML : (node.nodeName !== \"IMG\"),\n          content         = isElement ? node.innerHTML : node.data,\n          isEmpty         = (content === \"\" || content === wysihtml5.INVISIBLE_SPACE),\n          displayStyle    = dom.getStyle(\"display\").from(node),\n          isBlockElement  = (displayStyle === \"block\" || displayStyle === \"list-item\");\n\n      if (isEmpty && isElement && canHaveHTML && !avoidInvisibleSpace) {\n        // Make sure that caret is visible in node by inserting a zero width no breaking space\n        try { node.innerHTML = wysihtml5.INVISIBLE_SPACE; } catch(e) {}\n      }\n\n      if (canHaveHTML) {\n        range.selectNodeContents(node);\n      } else {\n        range.selectNode(node);\n      }\n\n      if (canHaveHTML && isEmpty && isElement) {\n        range.collapse(isBlockElement);\n      } else if (canHaveHTML && isEmpty) {\n        range.setStartAfter(node);\n        range.setEndAfter(node);\n      }\n\n      this.setSelection(range);\n    },\n\n    /**\n     * Get the node which contains the selection\n     *\n     * @param {Boolean} [controlRange] (only IE) Whether it should return the selected ControlRange element when the selection type is a \"ControlRange\"\n     * @return {Object} The node that contains the caret\n     * @example\n     *    var nodeThatContainsCaret = selection.getSelectedNode();\n     */\n    getSelectedNode: function(controlRange) {\n      var selection,\n          range;\n\n      if (controlRange && this.doc.selection && this.doc.selection.type === \"Control\") {\n        range = this.doc.selection.createRange();\n        if (range && range.length) {\n          return range.item(0);\n        }\n      }\n\n      selection = this.getSelection(this.doc);\n      if (selection.focusNode === selection.anchorNode) {\n        return selection.focusNode;\n      } else {\n        range = this.getRange(this.doc);\n        return range ? range.commonAncestorContainer : this.doc.body;\n      }\n    },\n\n    fixSelBorders: function() {\n      var range = this.getRange();\n      expandRangeToSurround(range);\n      this.setSelection(range);\n    },\n\n    getSelectedOwnNodes: function(controlRange) {\n      var selection,\n          ranges = this.getOwnRanges(),\n          ownNodes = [];\n\n      for (var i = 0, maxi = ranges.length; i < maxi; i++) {\n          ownNodes.push(ranges[i].commonAncestorContainer || this.doc.body);\n      }\n      return ownNodes;\n    },\n\n    findNodesInSelection: function(nodeTypes) {\n      var ranges = this.getOwnRanges(),\n          nodes = [], curNodes;\n      for (var i = 0, maxi = ranges.length; i < maxi; i++) {\n        curNodes = ranges[i].getNodes([1], function(node) {\n            return wysihtml5.lang.array(nodeTypes).contains(node.nodeName);\n        });\n        nodes = nodes.concat(curNodes);\n      }\n      return nodes;\n    },\n\n    containsUneditable: function() {\n      var uneditables = this.getOwnUneditables(),\n          selection = this.getSelection();\n\n      for (var i = 0, maxi = uneditables.length; i < maxi; i++) {\n        if (selection.containsNode(uneditables[i])) {\n          return true;\n        }\n      }\n\n      return false;\n    },\n\n    deleteContents: function()  {\n      var ranges = this.getOwnRanges();\n      for (var i = ranges.length; i--;) {\n        ranges[i].deleteContents();\n      }\n      this.setSelection(ranges[0]);\n    },\n\n    getPreviousNode: function(node, ignoreEmpty) {\n      if (!node) {\n        var selection = this.getSelection();\n        node = selection.anchorNode;\n      }\n\n      if (node === this.contain) {\n          return false;\n      }\n\n      var ret = node.previousSibling,\n          parent;\n\n      if (ret === this.contain) {\n          return false;\n      }\n\n      if (ret && ret.nodeType !== 3 && ret.nodeType !== 1) {\n         // do not count comments and other node types\n         ret = this.getPreviousNode(ret, ignoreEmpty);\n      } else if (ret && ret.nodeType === 3 && (/^\\s*$/).test(ret.textContent)) {\n        // do not count empty textnodes as previus nodes\n        ret = this.getPreviousNode(ret, ignoreEmpty);\n      } else if (ignoreEmpty && ret && ret.nodeType === 1 && !wysihtml5.lang.array([\"BR\", \"HR\", \"IMG\"]).contains(ret.nodeName) && (/^[\\s]*$/).test(ret.innerHTML)) {\n        // Do not count empty nodes if param set.\n        // Contenteditable tends to bypass and delete these silently when deleting with caret\n        ret = this.getPreviousNode(ret, ignoreEmpty);\n      } else if (!ret && node !== this.contain) {\n        parent = node.parentNode;\n        if (parent !== this.contain) {\n            ret = this.getPreviousNode(parent, ignoreEmpty);\n        }\n      }\n\n      return (ret !== this.contain) ? ret : false;\n    },\n\n    getSelectionParentsByTag: function(tagName) {\n      var nodes = this.getSelectedOwnNodes(),\n          curEl, parents = [];\n\n      for (var i = 0, maxi = nodes.length; i < maxi; i++) {\n        curEl = (nodes[i].nodeName &&  nodes[i].nodeName === 'LI') ? nodes[i] : wysihtml5.dom.getParentElement(nodes[i], { nodeName: ['LI']}, false, this.contain);\n        if (curEl) {\n          parents.push(curEl);\n        }\n      }\n      return (parents.length) ? parents : null;\n    },\n\n    getRangeToNodeEnd: function() {\n      if (this.isCollapsed()) {\n        var range = this.getRange(),\n            sNode = range.startContainer,\n            pos = range.startOffset,\n            lastR = rangy.createRange(this.doc);\n\n        lastR.selectNodeContents(sNode);\n        lastR.setStart(sNode, pos);\n        return lastR;\n      }\n    },\n\n    caretIsLastInSelection: function() {\n      var r = rangy.createRange(this.doc),\n          s = this.getSelection(),\n          endc = this.getRangeToNodeEnd().cloneContents(),\n          endtxt = endc.textContent;\n\n      return (/^\\s*$/).test(endtxt);\n    },\n\n    caretIsFirstInSelection: function() {\n      var r = rangy.createRange(this.doc),\n          s = this.getSelection(),\n          range = this.getRange(),\n          startNode = range.startContainer;\n      \n      if (startNode.nodeType === wysihtml5.TEXT_NODE) {\n        return this.isCollapsed() && (startNode.nodeType === wysihtml5.TEXT_NODE && (/^\\s*$/).test(startNode.data.substr(0,range.startOffset)));\n      } else {\n        r.selectNodeContents(this.getRange().commonAncestorContainer);\n        r.collapse(true);\n        return (this.isCollapsed() && (r.startContainer === s.anchorNode || r.endContainer === s.anchorNode) && r.startOffset === s.anchorOffset);\n      }\n    },\n\n    caretIsInTheBeginnig: function(ofNode) {\n        var selection = this.getSelection(),\n            node = selection.anchorNode,\n            offset = selection.anchorOffset;\n        if (ofNode) {\n          return (offset === 0 && (node.nodeName && node.nodeName === ofNode.toUpperCase() || wysihtml5.dom.getParentElement(node.parentNode, { nodeName: ofNode }, 1)));\n        } else {\n          return (offset === 0 && !this.getPreviousNode(node, true));\n        }\n    },\n\n    caretIsBeforeUneditable: function() {\n      var selection = this.getSelection(),\n          node = selection.anchorNode,\n          offset = selection.anchorOffset;\n\n      if (offset === 0) {\n        var prevNode = this.getPreviousNode(node, true);\n        if (prevNode) {\n          var uneditables = this.getOwnUneditables();\n          for (var i = 0, maxi = uneditables.length; i < maxi; i++) {\n            if (prevNode === uneditables[i]) {\n              return uneditables[i];\n            }\n          }\n        }\n      }\n      return false;\n    },\n\n    // TODO: Figure out a method from following 2 that would work universally\n    executeAndRestoreRangy: function(method, restoreScrollPosition) {\n      var win = this.doc.defaultView || this.doc.parentWindow,\n          sel = rangy.saveSelection(win);\n\n      if (!sel) {\n        method();\n      } else {\n        try {\n          method();\n        } catch(e) {\n          setTimeout(function() { throw e; }, 0);\n        }\n      }\n      rangy.restoreSelection(sel);\n    },\n\n    // TODO: has problems in chrome 12. investigate block level and uneditable area inbetween\n    executeAndRestore: function(method, restoreScrollPosition) {\n      var body                  = this.doc.body,\n          oldScrollTop          = restoreScrollPosition && body.scrollTop,\n          oldScrollLeft         = restoreScrollPosition && body.scrollLeft,\n          className             = \"_wysihtml5-temp-placeholder\",\n          placeholderHtml       = '<span class=\"' + className + '\">' + wysihtml5.INVISIBLE_SPACE + '</span>',\n          range                 = this.getRange(true),\n          caretPlaceholder,\n          newCaretPlaceholder,\n          nextSibling, prevSibling,\n          node, node2, range2,\n          newRange;\n\n      // Nothing selected, execute and say goodbye\n      if (!range) {\n        method(body, body);\n        return;\n      }\n\n      if (!range.collapsed) {\n        range2 = range.cloneRange();\n        node2 = range2.createContextualFragment(placeholderHtml);\n        range2.collapse(false);\n        range2.insertNode(node2);\n        range2.detach();\n      }\n\n      node = range.createContextualFragment(placeholderHtml);\n      range.insertNode(node);\n\n      if (node2) {\n        caretPlaceholder = this.contain.querySelectorAll(\".\" + className);\n        range.setStartBefore(caretPlaceholder[0]);\n        range.setEndAfter(caretPlaceholder[caretPlaceholder.length -1]);\n      }\n      this.setSelection(range);\n\n      // Make sure that a potential error doesn't cause our placeholder element to be left as a placeholder\n      try {\n        method(range.startContainer, range.endContainer);\n      } catch(e) {\n        setTimeout(function() { throw e; }, 0);\n      }\n      caretPlaceholder = this.contain.querySelectorAll(\".\" + className);\n      if (caretPlaceholder && caretPlaceholder.length) {\n        newRange = rangy.createRange(this.doc);\n        nextSibling = caretPlaceholder[0].nextSibling;\n        if (caretPlaceholder.length > 1) {\n          prevSibling = caretPlaceholder[caretPlaceholder.length -1].previousSibling;\n        }\n        if (prevSibling && nextSibling) {\n          newRange.setStartBefore(nextSibling);\n          newRange.setEndAfter(prevSibling);\n        } else {\n          newCaretPlaceholder = this.doc.createTextNode(wysihtml5.INVISIBLE_SPACE);\n          dom.insert(newCaretPlaceholder).after(caretPlaceholder[0]);\n          newRange.setStartBefore(newCaretPlaceholder);\n          newRange.setEndAfter(newCaretPlaceholder);\n        }\n        this.setSelection(newRange);\n        for (var i = caretPlaceholder.length; i--;) {\n         caretPlaceholder[i].parentNode.removeChild(caretPlaceholder[i]);\n        }\n\n      } else {\n        // fallback for when all hell breaks loose\n        this.contain.focus();\n      }\n\n      if (restoreScrollPosition) {\n        body.scrollTop  = oldScrollTop;\n        body.scrollLeft = oldScrollLeft;\n      }\n\n      // Remove it again, just to make sure that the placeholder is definitely out of the dom tree\n      try {\n        caretPlaceholder.parentNode.removeChild(caretPlaceholder);\n      } catch(e2) {}\n    },\n\n    set: function(node, offset) {\n      var newRange = rangy.createRange(this.doc);\n      newRange.setStart(node, offset || 0);\n      this.setSelection(newRange);\n    },\n\n    /**\n     * Insert html at the caret position and move the cursor after the inserted html\n     *\n     * @param {String} html HTML string to insert\n     * @example\n     *    selection.insertHTML(\"<p>foobar</p>\");\n     */\n    insertHTML: function(html) {\n      var range     = rangy.createRange(this.doc),\n          node = this.doc.createElement('DIV'),\n          fragment = this.doc.createDocumentFragment(),\n          lastChild;\n\n      node.innerHTML = html;\n      lastChild = node.lastChild;\n\n      while (node.firstChild) {\n        fragment.appendChild(node.firstChild);\n      }\n      this.insertNode(fragment);\n\n      if (lastChild) {\n        this.setAfter(lastChild);\n      }\n    },\n\n    /**\n     * Insert a node at the caret position and move the cursor behind it\n     *\n     * @param {Object} node HTML string to insert\n     * @example\n     *    selection.insertNode(document.createTextNode(\"foobar\"));\n     */\n    insertNode: function(node) {\n      var range = this.getRange();\n      if (range) {\n        range.insertNode(node);\n      }\n    },\n\n    /**\n     * Wraps current selection with the given node\n     *\n     * @param {Object} node The node to surround the selected elements with\n     */\n    surround: function(nodeOptions) {\n      var ranges = this.getOwnRanges(),\n          node, nodes = [];\n      if (ranges.length == 0) {\n        return nodes;\n      }\n\n      for (var i = ranges.length; i--;) {\n        node = this.doc.createElement(nodeOptions.nodeName);\n        nodes.push(node);\n        if (nodeOptions.className) {\n          node.className = nodeOptions.className;\n        }\n        if (nodeOptions.cssStyle) {\n          node.setAttribute('style', nodeOptions.cssStyle);\n        }\n        try {\n          // This only works when the range boundaries are not overlapping other elements\n          ranges[i].surroundContents(node);\n          this.selectNode(node);\n        } catch(e) {\n          // fallback\n          node.appendChild(ranges[i].extractContents());\n          ranges[i].insertNode(node);\n        }\n      }\n      return nodes;\n    },\n\n    deblockAndSurround: function(nodeOptions) {\n      var tempElement = this.doc.createElement('div'),\n          range = rangy.createRange(this.doc),\n          tempDivElements,\n          tempElements,\n          firstChild;\n\n      tempElement.className = nodeOptions.className;\n\n      this.composer.commands.exec(\"formatBlock\", nodeOptions.nodeName, nodeOptions.className);\n      tempDivElements = this.contain.querySelectorAll(\".\" + nodeOptions.className);\n      if (tempDivElements[0]) {\n        tempDivElements[0].parentNode.insertBefore(tempElement, tempDivElements[0]);\n\n        range.setStartBefore(tempDivElements[0]);\n        range.setEndAfter(tempDivElements[tempDivElements.length - 1]);\n        tempElements = range.extractContents();\n\n        while (tempElements.firstChild) {\n          firstChild = tempElements.firstChild;\n          if (firstChild.nodeType == 1 && wysihtml5.dom.hasClass(firstChild, nodeOptions.className)) {\n            while (firstChild.firstChild) {\n              tempElement.appendChild(firstChild.firstChild);\n            }\n            if (firstChild.nodeName !== \"BR\") { tempElement.appendChild(this.doc.createElement('br')); }\n            tempElements.removeChild(firstChild);\n          } else {\n            tempElement.appendChild(firstChild);\n          }\n        }\n      } else {\n        tempElement = null;\n      }\n\n      return tempElement;\n    },\n\n    /**\n     * Scroll the current caret position into the view\n     * FIXME: This is a bit hacky, there might be a smarter way of doing this\n     *\n     * @example\n     *    selection.scrollIntoView();\n     */\n    scrollIntoView: function() {\n      var doc           = this.doc,\n          tolerance     = 5, // px\n          hasScrollBars = doc.documentElement.scrollHeight > doc.documentElement.offsetHeight,\n          tempElement   = doc._wysihtml5ScrollIntoViewElement = doc._wysihtml5ScrollIntoViewElement || (function() {\n            var element = doc.createElement(\"span\");\n            // The element needs content in order to be able to calculate it's position properly\n            element.innerHTML = wysihtml5.INVISIBLE_SPACE;\n            return element;\n          })(),\n          offsetTop;\n\n      if (hasScrollBars) {\n        this.insertNode(tempElement);\n        offsetTop = _getCumulativeOffsetTop(tempElement);\n        tempElement.parentNode.removeChild(tempElement);\n        if (offsetTop >= (doc.body.scrollTop + doc.documentElement.offsetHeight - tolerance)) {\n          doc.body.scrollTop = offsetTop;\n        }\n      }\n    },\n\n    /**\n     * Select line where the caret is in\n     */\n    selectLine: function() {\n      if (wysihtml5.browser.supportsSelectionModify()) {\n        this._selectLine_W3C();\n      } else if (this.doc.selection) {\n        this._selectLine_MSIE();\n      }\n    },\n\n    /**\n     * See https://developer.mozilla.org/en/DOM/Selection/modify\n     */\n    _selectLine_W3C: function() {\n      var win       = this.doc.defaultView,\n          selection = win.getSelection();\n      selection.modify(\"move\", \"left\", \"lineboundary\");\n      selection.modify(\"extend\", \"right\", \"lineboundary\");\n    },\n\n    _selectLine_MSIE: function() {\n      var range       = this.doc.selection.createRange(),\n          rangeTop    = range.boundingTop,\n          scrollWidth = this.doc.body.scrollWidth,\n          rangeBottom,\n          rangeEnd,\n          measureNode,\n          i,\n          j;\n\n      if (!range.moveToPoint) {\n        return;\n      }\n\n      if (rangeTop === 0) {\n        // Don't know why, but when the selection ends at the end of a line\n        // range.boundingTop is 0\n        measureNode = this.doc.createElement(\"span\");\n        this.insertNode(measureNode);\n        rangeTop = measureNode.offsetTop;\n        measureNode.parentNode.removeChild(measureNode);\n      }\n\n      rangeTop += 1;\n\n      for (i=-10; i<scrollWidth; i+=2) {\n        try {\n          range.moveToPoint(i, rangeTop);\n          break;\n        } catch(e1) {}\n      }\n\n      // Investigate the following in order to handle multi line selections\n      // rangeBottom = rangeTop + (rangeHeight ? (rangeHeight - 1) : 0);\n      rangeBottom = rangeTop;\n      rangeEnd = this.doc.selection.createRange();\n      for (j=scrollWidth; j>=0; j--) {\n        try {\n          rangeEnd.moveToPoint(j, rangeBottom);\n          break;\n        } catch(e2) {}\n      }\n\n      range.setEndPoint(\"EndToEnd\", rangeEnd);\n      range.select();\n    },\n\n    getText: function() {\n      var selection = this.getSelection();\n      return selection ? selection.toString() : \"\";\n    },\n\n    getNodes: function(nodeType, filter) {\n      var range = this.getRange();\n      if (range) {\n        return range.getNodes([nodeType], filter);\n      } else {\n        return [];\n      }\n    },\n\n    fixRangeOverflow: function(range) {\n      if (this.contain && this.contain.firstChild && range) {\n        var containment = range.compareNode(this.contain);\n        if (containment !== 2) {\n          if (containment === 1) {\n            range.setStartBefore(this.contain.firstChild);\n          }\n          if (containment === 0) {\n            range.setEndAfter(this.contain.lastChild);\n          }\n          if (containment === 3) {\n            range.setStartBefore(this.contain.firstChild);\n            range.setEndAfter(this.contain.lastChild);\n          }\n        } else if (this._detectInlineRangeProblems(range)) {\n          var previousElementSibling = range.endContainer.previousElementSibling;\n          if (previousElementSibling) {\n            range.setEnd(previousElementSibling, this._endOffsetForNode(previousElementSibling));\n          }\n        }\n      }\n    },\n\n    _endOffsetForNode: function(node) {\n      var range = document.createRange();\n      range.selectNodeContents(node);\n      return range.endOffset;\n    },\n\n    _detectInlineRangeProblems: function(range) {\n      var position = dom.compareDocumentPosition(range.startContainer, range.endContainer);\n      return (\n        range.endOffset == 0 &&\n        position & 4 //Node.DOCUMENT_POSITION_FOLLOWING\n      );\n    },\n\n    getRange: function(dontFix) {\n      var selection = this.getSelection(),\n          range = selection && selection.rangeCount && selection.getRangeAt(0);\n\n      if (dontFix !== true) {\n        this.fixRangeOverflow(range);\n      }\n\n      return range;\n    },\n\n    getOwnUneditables: function() {\n      var allUneditables = dom.query(this.contain, '.' + this.unselectableClass),\n          deepUneditables = dom.query(allUneditables, '.' + this.unselectableClass);\n\n      return wysihtml5.lang.array(allUneditables).without(deepUneditables);\n    },\n\n    // Returns an array of ranges that belong only to this editable\n    // Needed as uneditable block in contenteditabel can split range into pieces\n    // If manipulating content reverse loop is usually needed as manipulation can shift subsequent ranges\n    getOwnRanges: function()  {\n      var ranges = [],\n          r = this.getRange(),\n          tmpRanges;\n\n      if (r) { ranges.push(r); }\n\n      if (this.unselectableClass && this.contain && r) {\n          var uneditables = this.getOwnUneditables(),\n              tmpRange;\n          if (uneditables.length > 0) {\n            for (var i = 0, imax = uneditables.length; i < imax; i++) {\n              tmpRanges = [];\n              for (var j = 0, jmax = ranges.length; j < jmax; j++) {\n                if (ranges[j]) {\n                  switch (ranges[j].compareNode(uneditables[i])) {\n                    case 2:\n                      // all selection inside uneditable. remove\n                    break;\n                    case 3:\n                      //section begins before and ends after uneditable. spilt\n                      tmpRange = ranges[j].cloneRange();\n                      tmpRange.setEndBefore(uneditables[i]);\n                      tmpRanges.push(tmpRange);\n\n                      tmpRange = ranges[j].cloneRange();\n                      tmpRange.setStartAfter(uneditables[i]);\n                      tmpRanges.push(tmpRange);\n                    break;\n                    default:\n                      // in all other cases uneditable does not touch selection. dont modify\n                      tmpRanges.push(ranges[j]);\n                  }\n                }\n                ranges = tmpRanges;\n              }\n            }\n          }\n      }\n      return ranges;\n    },\n\n    getSelection: function() {\n      return rangy.getSelection(this.doc.defaultView || this.doc.parentWindow);\n    },\n\n    setSelection: function(range) {\n      var win       = this.doc.defaultView || this.doc.parentWindow,\n          selection = rangy.getSelection(win);\n      return selection.setSingleRange(range);\n    },\n\n    createRange: function() {\n      return rangy.createRange(this.doc);\n    },\n\n    isCollapsed: function() {\n        return this.getSelection().isCollapsed;\n    },\n\n    getHtml: function() {\n      return this.getSelection().toHtml();\n    },\n\n    isEndToEndInNode: function(nodeNames) {\n      var range = this.getRange(),\n          parentElement = range.commonAncestorContainer,\n          startNode = range.startContainer,\n          endNode = range.endContainer;\n\n\n        if (parentElement.nodeType === wysihtml5.TEXT_NODE) {\n          parentElement = parentElement.parentNode;\n        }\n\n        if (startNode.nodeType === wysihtml5.TEXT_NODE && !(/^\\s*$/).test(startNode.data.substr(range.startOffset))) {\n          return false;\n        }\n\n        if (endNode.nodeType === wysihtml5.TEXT_NODE && !(/^\\s*$/).test(endNode.data.substr(range.endOffset))) {\n          return false;\n        }\n\n        while (startNode && startNode !== parentElement) {\n          if (startNode.nodeType !== wysihtml5.TEXT_NODE && !wysihtml5.dom.contains(parentElement, startNode)) {\n            return false;\n          }\n          if (wysihtml5.dom.domNode(startNode).prev({ignoreBlankTexts: true})) {\n            return false;\n          }\n          startNode = startNode.parentNode;\n        }\n\n        while (endNode && endNode !== parentElement) {\n          if (endNode.nodeType !== wysihtml5.TEXT_NODE && !wysihtml5.dom.contains(parentElement, endNode)) {\n            return false;\n          }\n          if (wysihtml5.dom.domNode(endNode).next({ignoreBlankTexts: true})) {\n            return false;\n          }\n          endNode = endNode.parentNode;\n        }\n\n        return (wysihtml5.lang.array(nodeNames).contains(parentElement.nodeName)) ? parentElement : false;\n    },\n\n    deselect: function() {\n      var sel = this.getSelection();\n      sel && sel.removeAllRanges();\n    }\n  });\n\n})(wysihtml5);\n;/**\n * Inspired by the rangy CSS Applier module written by Tim Down and licensed under the MIT license.\n * http://code.google.com/p/rangy/\n *\n * changed in order to be able ...\n *    - to use custom tags\n *    - to detect and replace similar css classes via reg exp\n */\n(function(wysihtml5, rangy) {\n  var defaultTagName = \"span\";\n\n  var REG_EXP_WHITE_SPACE = /\\s+/g;\n\n  function hasClass(el, cssClass, regExp) {\n    if (!el.className) {\n      return false;\n    }\n\n    var matchingClassNames = el.className.match(regExp) || [];\n    return matchingClassNames[matchingClassNames.length - 1] === cssClass;\n  }\n\n  function hasStyleAttr(el, regExp) {\n    if (!el.getAttribute || !el.getAttribute('style')) {\n      return false;\n    }\n    var matchingStyles = el.getAttribute('style').match(regExp);\n    return  (el.getAttribute('style').match(regExp)) ? true : false;\n  }\n\n  function addStyle(el, cssStyle, regExp) {\n    if (el.getAttribute('style')) {\n      removeStyle(el, regExp);\n      if (el.getAttribute('style') && !(/^\\s*$/).test(el.getAttribute('style'))) {\n        el.setAttribute('style', cssStyle + \";\" + el.getAttribute('style'));\n      } else {\n        el.setAttribute('style', cssStyle);\n      }\n    } else {\n      el.setAttribute('style', cssStyle);\n    }\n  }\n\n  function addClass(el, cssClass, regExp) {\n    if (el.className) {\n      removeClass(el, regExp);\n      el.className += \" \" + cssClass;\n    } else {\n      el.className = cssClass;\n    }\n  }\n\n  function removeClass(el, regExp) {\n    if (el.className) {\n      el.className = el.className.replace(regExp, \"\");\n    }\n  }\n\n  function removeStyle(el, regExp) {\n    var s,\n        s2 = [];\n    if (el.getAttribute('style')) {\n      s = el.getAttribute('style').split(';');\n      for (var i = s.length; i--;) {\n        if (!s[i].match(regExp) && !(/^\\s*$/).test(s[i])) {\n          s2.push(s[i]);\n        }\n      }\n      if (s2.length) {\n        el.setAttribute('style', s2.join(';'));\n      } else {\n        el.removeAttribute('style');\n      }\n    }\n  }\n\n  function getMatchingStyleRegexp(el, style) {\n    var regexes = [],\n        sSplit = style.split(';'),\n        elStyle = el.getAttribute('style');\n\n    if (elStyle) {\n      elStyle = elStyle.replace(/\\s/gi, '').toLowerCase();\n      regexes.push(new RegExp(\"(^|\\\\s|;)\" + style.replace(/\\s/gi, '').replace(/([\\(\\)])/gi, \"\\\\$1\").toLowerCase().replace(\";\", \";?\").replace(/rgb\\\\\\((\\d+),(\\d+),(\\d+)\\\\\\)/gi, \"\\\\s?rgb\\\\($1,\\\\s?$2,\\\\s?$3\\\\)\"), \"gi\"));\n\n      for (var i = sSplit.length; i-- > 0;) {\n        if (!(/^\\s*$/).test(sSplit[i])) {\n          regexes.push(new RegExp(\"(^|\\\\s|;)\" + sSplit[i].replace(/\\s/gi, '').replace(/([\\(\\)])/gi, \"\\\\$1\").toLowerCase().replace(\";\", \";?\").replace(/rgb\\\\\\((\\d+),(\\d+),(\\d+)\\\\\\)/gi, \"\\\\s?rgb\\\\($1,\\\\s?$2,\\\\s?$3\\\\)\"), \"gi\"));\n        }\n      }\n      for (var j = 0, jmax = regexes.length; j < jmax; j++) {\n        if (elStyle.match(regexes[j])) {\n          return regexes[j];\n        }\n      }\n    }\n\n    return false;\n  }\n\n  function isMatchingAllready(node, tags, style, className) {\n    if (style) {\n      return getMatchingStyleRegexp(node, style);\n    } else if (className) {\n      return wysihtml5.dom.hasClass(node, className);\n    } else {\n      return rangy.dom.arrayContains(tags, node.tagName.toLowerCase());\n    }\n  }\n\n  function areMatchingAllready(nodes, tags, style, className) {\n    for (var i = nodes.length; i--;) {\n      if (!isMatchingAllready(nodes[i], tags, style, className)) {\n        return false;\n      }\n    }\n    return nodes.length ? true : false;\n  }\n\n  function removeOrChangeStyle(el, style, regExp) {\n\n    var exactRegex = getMatchingStyleRegexp(el, style);\n    if (exactRegex) {\n      // adding same style value on property again removes style\n      removeStyle(el, exactRegex);\n      return \"remove\";\n    } else {\n      // adding new style value changes value\n      addStyle(el, style, regExp);\n      return \"change\";\n    }\n  }\n\n  function hasSameClasses(el1, el2) {\n    return el1.className.replace(REG_EXP_WHITE_SPACE, \" \") == el2.className.replace(REG_EXP_WHITE_SPACE, \" \");\n  }\n\n  function replaceWithOwnChildren(el) {\n    var parent = el.parentNode;\n    while (el.firstChild) {\n      parent.insertBefore(el.firstChild, el);\n    }\n    parent.removeChild(el);\n  }\n\n  function elementsHaveSameNonClassAttributes(el1, el2) {\n    if (el1.attributes.length != el2.attributes.length) {\n      return false;\n    }\n    for (var i = 0, len = el1.attributes.length, attr1, attr2, name; i < len; ++i) {\n      attr1 = el1.attributes[i];\n      name = attr1.name;\n      if (name != \"class\") {\n        attr2 = el2.attributes.getNamedItem(name);\n        if (attr1.specified != attr2.specified) {\n          return false;\n        }\n        if (attr1.specified && attr1.nodeValue !== attr2.nodeValue) {\n          return false;\n        }\n      }\n    }\n    return true;\n  }\n\n  function isSplitPoint(node, offset) {\n    if (rangy.dom.isCharacterDataNode(node)) {\n      if (offset == 0) {\n        return !!node.previousSibling;\n      } else if (offset == node.length) {\n        return !!node.nextSibling;\n      } else {\n        return true;\n      }\n    }\n\n    return offset > 0 && offset < node.childNodes.length;\n  }\n\n  function splitNodeAt(node, descendantNode, descendantOffset, container) {\n    var newNode;\n    if (rangy.dom.isCharacterDataNode(descendantNode)) {\n      if (descendantOffset == 0) {\n        descendantOffset = rangy.dom.getNodeIndex(descendantNode);\n        descendantNode = descendantNode.parentNode;\n      } else if (descendantOffset == descendantNode.length) {\n        descendantOffset = rangy.dom.getNodeIndex(descendantNode) + 1;\n        descendantNode = descendantNode.parentNode;\n      } else {\n        newNode = rangy.dom.splitDataNode(descendantNode, descendantOffset);\n      }\n    }\n    if (!newNode) {\n      if (!container || descendantNode !== container) {\n\n        newNode = descendantNode.cloneNode(false);\n        if (newNode.id) {\n          newNode.removeAttribute(\"id\");\n        }\n        var child;\n        while ((child = descendantNode.childNodes[descendantOffset])) {\n          newNode.appendChild(child);\n        }\n        rangy.dom.insertAfter(newNode, descendantNode);\n\n      }\n    }\n    return (descendantNode == node) ? newNode :  splitNodeAt(node, newNode.parentNode, rangy.dom.getNodeIndex(newNode), container);\n  }\n\n  function Merge(firstNode) {\n    this.isElementMerge = (firstNode.nodeType == wysihtml5.ELEMENT_NODE);\n    this.firstTextNode = this.isElementMerge ? firstNode.lastChild : firstNode;\n    this.textNodes = [this.firstTextNode];\n  }\n\n  Merge.prototype = {\n    doMerge: function() {\n      var textBits = [], textNode, parent, text;\n      for (var i = 0, len = this.textNodes.length; i < len; ++i) {\n        textNode = this.textNodes[i];\n        parent = textNode.parentNode;\n        textBits[i] = textNode.data;\n        if (i) {\n          parent.removeChild(textNode);\n          if (!parent.hasChildNodes()) {\n            parent.parentNode.removeChild(parent);\n          }\n        }\n      }\n      this.firstTextNode.data = text = textBits.join(\"\");\n      return text;\n    },\n\n    getLength: function() {\n      var i = this.textNodes.length, len = 0;\n      while (i--) {\n        len += this.textNodes[i].length;\n      }\n      return len;\n    },\n\n    toString: function() {\n      var textBits = [];\n      for (var i = 0, len = this.textNodes.length; i < len; ++i) {\n        textBits[i] = \"'\" + this.textNodes[i].data + \"'\";\n      }\n      return \"[Merge(\" + textBits.join(\",\") + \")]\";\n    }\n  };\n\n  function HTMLApplier(tagNames, cssClass, similarClassRegExp, normalize, cssStyle, similarStyleRegExp, container) {\n    this.tagNames = tagNames || [defaultTagName];\n    this.cssClass = cssClass || ((cssClass === false) ? false : \"\");\n    this.similarClassRegExp = similarClassRegExp;\n    this.cssStyle = cssStyle || \"\";\n    this.similarStyleRegExp = similarStyleRegExp;\n    this.normalize = normalize;\n    this.applyToAnyTagName = false;\n    this.container = container;\n  }\n\n  HTMLApplier.prototype = {\n    getAncestorWithClass: function(node) {\n      var cssClassMatch;\n      while (node) {\n        cssClassMatch = this.cssClass ? hasClass(node, this.cssClass, this.similarClassRegExp) : (this.cssStyle !== \"\") ? false : true;\n        if (node.nodeType == wysihtml5.ELEMENT_NODE && node.getAttribute(\"contenteditable\") != \"false\" &&  rangy.dom.arrayContains(this.tagNames, node.tagName.toLowerCase()) && cssClassMatch) {\n          return node;\n        }\n        node = node.parentNode;\n      }\n      return false;\n    },\n\n    // returns parents of node with given style attribute\n    getAncestorWithStyle: function(node) {\n      var cssStyleMatch;\n      while (node) {\n        cssStyleMatch = this.cssStyle ? hasStyleAttr(node, this.similarStyleRegExp) : false;\n\n        if (node.nodeType == wysihtml5.ELEMENT_NODE && node.getAttribute(\"contenteditable\") != \"false\" && rangy.dom.arrayContains(this.tagNames, node.tagName.toLowerCase()) && cssStyleMatch) {\n          return node;\n        }\n        node = node.parentNode;\n      }\n      return false;\n    },\n\n    getMatchingAncestor: function(node) {\n      var ancestor = this.getAncestorWithClass(node),\n          matchType = false;\n\n      if (!ancestor) {\n        ancestor = this.getAncestorWithStyle(node);\n        if (ancestor) {\n          matchType = \"style\";\n        }\n      } else {\n        if (this.cssStyle) {\n          matchType = \"class\";\n        }\n      }\n\n      return {\n        \"element\": ancestor,\n        \"type\": matchType\n      };\n    },\n\n    // Normalizes nodes after applying a CSS class to a Range.\n    postApply: function(textNodes, range) {\n      var firstNode = textNodes[0], lastNode = textNodes[textNodes.length - 1];\n\n      var merges = [], currentMerge;\n\n      var rangeStartNode = firstNode, rangeEndNode = lastNode;\n      var rangeStartOffset = 0, rangeEndOffset = lastNode.length;\n\n      var textNode, precedingTextNode;\n\n      for (var i = 0, len = textNodes.length; i < len; ++i) {\n        textNode = textNodes[i];\n        precedingTextNode = null;\n        if (textNode && textNode.parentNode) {\n          precedingTextNode = this.getAdjacentMergeableTextNode(textNode.parentNode, false);\n        }\n        if (precedingTextNode) {\n          if (!currentMerge) {\n            currentMerge = new Merge(precedingTextNode);\n            merges.push(currentMerge);\n          }\n          currentMerge.textNodes.push(textNode);\n          if (textNode === firstNode) {\n            rangeStartNode = currentMerge.firstTextNode;\n            rangeStartOffset = rangeStartNode.length;\n          }\n          if (textNode === lastNode) {\n            rangeEndNode = currentMerge.firstTextNode;\n            rangeEndOffset = currentMerge.getLength();\n          }\n        } else {\n          currentMerge = null;\n        }\n      }\n      // Test whether the first node after the range needs merging\n      if(lastNode && lastNode.parentNode) {\n        var nextTextNode = this.getAdjacentMergeableTextNode(lastNode.parentNode, true);\n        if (nextTextNode) {\n          if (!currentMerge) {\n            currentMerge = new Merge(lastNode);\n            merges.push(currentMerge);\n          }\n          currentMerge.textNodes.push(nextTextNode);\n        }\n      }\n      // Do the merges\n      if (merges.length) {\n        for (i = 0, len = merges.length; i < len; ++i) {\n          merges[i].doMerge();\n        }\n        // Set the range boundaries\n        range.setStart(rangeStartNode, rangeStartOffset);\n        range.setEnd(rangeEndNode, rangeEndOffset);\n      }\n    },\n\n    getAdjacentMergeableTextNode: function(node, forward) {\n        var isTextNode = (node.nodeType == wysihtml5.TEXT_NODE);\n        var el = isTextNode ? node.parentNode : node;\n        var adjacentNode;\n        var propName = forward ? \"nextSibling\" : \"previousSibling\";\n        if (isTextNode) {\n          // Can merge if the node's previous/next sibling is a text node\n          adjacentNode = node[propName];\n          if (adjacentNode && adjacentNode.nodeType == wysihtml5.TEXT_NODE) {\n            return adjacentNode;\n          }\n        } else {\n          // Compare element with its sibling\n          adjacentNode = el[propName];\n          if (adjacentNode && this.areElementsMergeable(node, adjacentNode)) {\n            return adjacentNode[forward ? \"firstChild\" : \"lastChild\"];\n          }\n        }\n        return null;\n    },\n\n    areElementsMergeable: function(el1, el2) {\n      return rangy.dom.arrayContains(this.tagNames, (el1.tagName || \"\").toLowerCase())\n        && rangy.dom.arrayContains(this.tagNames, (el2.tagName || \"\").toLowerCase())\n        && hasSameClasses(el1, el2)\n        && elementsHaveSameNonClassAttributes(el1, el2);\n    },\n\n    createContainer: function(doc) {\n      var el = doc.createElement(this.tagNames[0]);\n      if (this.cssClass) {\n        el.className = this.cssClass;\n      }\n      if (this.cssStyle) {\n        el.setAttribute('style', this.cssStyle);\n      }\n      return el;\n    },\n\n    applyToTextNode: function(textNode) {\n      var parent = textNode.parentNode;\n      if (parent.childNodes.length == 1 && rangy.dom.arrayContains(this.tagNames, parent.tagName.toLowerCase())) {\n\n        if (this.cssClass) {\n          addClass(parent, this.cssClass, this.similarClassRegExp);\n        }\n        if (this.cssStyle) {\n          addStyle(parent, this.cssStyle, this.similarStyleRegExp);\n        }\n      } else {\n        var el = this.createContainer(rangy.dom.getDocument(textNode));\n        textNode.parentNode.insertBefore(el, textNode);\n        el.appendChild(textNode);\n      }\n    },\n\n    isRemovable: function(el) {\n      return rangy.dom.arrayContains(this.tagNames, el.tagName.toLowerCase()) &&\n              wysihtml5.lang.string(el.className).trim() === \"\" &&\n              (\n                !el.getAttribute('style') ||\n                wysihtml5.lang.string(el.getAttribute('style')).trim() === \"\"\n              );\n    },\n\n    undoToTextNode: function(textNode, range, ancestorWithClass, ancestorWithStyle) {\n      var styleMode = (ancestorWithClass) ? false : true,\n          ancestor = ancestorWithClass || ancestorWithStyle,\n          styleChanged = false;\n      if (!range.containsNode(ancestor)) {\n        // Split out the portion of the ancestor from which we can remove the CSS class\n        var ancestorRange = range.cloneRange();\n            ancestorRange.selectNode(ancestor);\n\n        if (ancestorRange.isPointInRange(range.endContainer, range.endOffset) && isSplitPoint(range.endContainer, range.endOffset)) {\n            splitNodeAt(ancestor, range.endContainer, range.endOffset, this.container);\n            range.setEndAfter(ancestor);\n        }\n        if (ancestorRange.isPointInRange(range.startContainer, range.startOffset) && isSplitPoint(range.startContainer, range.startOffset)) {\n            ancestor = splitNodeAt(ancestor, range.startContainer, range.startOffset, this.container);\n        }\n      }\n\n      if (!styleMode && this.similarClassRegExp) {\n        removeClass(ancestor, this.similarClassRegExp);\n      }\n\n      if (styleMode && this.similarStyleRegExp) {\n        styleChanged = (removeOrChangeStyle(ancestor, this.cssStyle, this.similarStyleRegExp) === \"change\");\n      }\n      if (this.isRemovable(ancestor) && !styleChanged) {\n        replaceWithOwnChildren(ancestor);\n      }\n    },\n\n    applyToRange: function(range) {\n        var textNodes;\n        for (var ri = range.length; ri--;) {\n            textNodes = range[ri].getNodes([wysihtml5.TEXT_NODE]);\n\n            if (!textNodes.length) {\n              try {\n                var node = this.createContainer(range[ri].endContainer.ownerDocument);\n                range[ri].surroundContents(node);\n                this.selectNode(range[ri], node);\n                return;\n              } catch(e) {}\n            }\n\n            range[ri].splitBoundaries();\n            textNodes = range[ri].getNodes([wysihtml5.TEXT_NODE]);\n            if (textNodes.length) {\n              var textNode;\n\n              for (var i = 0, len = textNodes.length; i < len; ++i) {\n                textNode = textNodes[i];\n                if (!this.getMatchingAncestor(textNode).element) {\n                  this.applyToTextNode(textNode);\n                }\n              }\n\n              range[ri].setStart(textNodes[0], 0);\n              textNode = textNodes[textNodes.length - 1];\n              range[ri].setEnd(textNode, textNode.length);\n\n              if (this.normalize) {\n                this.postApply(textNodes, range[ri]);\n              }\n            }\n\n        }\n    },\n\n    undoToRange: function(range) {\n      var textNodes, textNode, ancestorWithClass, ancestorWithStyle, ancestor;\n      for (var ri = range.length; ri--;) {\n\n          textNodes = range[ri].getNodes([wysihtml5.TEXT_NODE]);\n          if (textNodes.length) {\n            range[ri].splitBoundaries();\n            textNodes = range[ri].getNodes([wysihtml5.TEXT_NODE]);\n          } else {\n            var doc = range[ri].endContainer.ownerDocument,\n                node = doc.createTextNode(wysihtml5.INVISIBLE_SPACE);\n            range[ri].insertNode(node);\n            range[ri].selectNode(node);\n            textNodes = [node];\n          }\n\n          for (var i = 0, len = textNodes.length; i < len; ++i) {\n            if (range[ri].isValid()) {\n              textNode = textNodes[i];\n\n              ancestor = this.getMatchingAncestor(textNode);\n              if (ancestor.type === \"style\") {\n                this.undoToTextNode(textNode, range[ri], false, ancestor.element);\n              } else if (ancestor.element) {\n                this.undoToTextNode(textNode, range[ri], ancestor.element);\n              }\n            }\n          }\n\n          if (len == 1) {\n            this.selectNode(range[ri], textNodes[0]);\n          } else {\n            range[ri].setStart(textNodes[0], 0);\n            textNode = textNodes[textNodes.length - 1];\n            range[ri].setEnd(textNode, textNode.length);\n\n            if (this.normalize) {\n              this.postApply(textNodes, range[ri]);\n            }\n          }\n\n      }\n    },\n\n    selectNode: function(range, node) {\n      var isElement       = node.nodeType === wysihtml5.ELEMENT_NODE,\n          canHaveHTML     = \"canHaveHTML\" in node ? node.canHaveHTML : true,\n          content         = isElement ? node.innerHTML : node.data,\n          isEmpty         = (content === \"\" || content === wysihtml5.INVISIBLE_SPACE);\n\n      if (isEmpty && isElement && canHaveHTML) {\n        // Make sure that caret is visible in node by inserting a zero width no breaking space\n        try { node.innerHTML = wysihtml5.INVISIBLE_SPACE; } catch(e) {}\n      }\n      range.selectNodeContents(node);\n      if (isEmpty && isElement) {\n        range.collapse(false);\n      } else if (isEmpty) {\n        range.setStartAfter(node);\n        range.setEndAfter(node);\n      }\n    },\n\n    getTextSelectedByRange: function(textNode, range) {\n      var textRange = range.cloneRange();\n      textRange.selectNodeContents(textNode);\n\n      var intersectionRange = textRange.intersection(range);\n      var text = intersectionRange ? intersectionRange.toString() : \"\";\n      textRange.detach();\n\n      return text;\n    },\n\n    isAppliedToRange: function(range) {\n      var ancestors = [],\n          appliedType = \"full\",\n          ancestor, styleAncestor, textNodes;\n\n      for (var ri = range.length; ri--;) {\n\n        textNodes = range[ri].getNodes([wysihtml5.TEXT_NODE]);\n        if (!textNodes.length) {\n          ancestor = this.getMatchingAncestor(range[ri].startContainer).element;\n\n          return (ancestor) ? {\n            \"elements\": [ancestor],\n            \"coverage\": appliedType\n          } : false;\n        }\n\n        for (var i = 0, len = textNodes.length, selectedText; i < len; ++i) {\n          selectedText = this.getTextSelectedByRange(textNodes[i], range[ri]);\n          ancestor = this.getMatchingAncestor(textNodes[i]).element;\n          if (ancestor && selectedText != \"\") {\n            ancestors.push(ancestor);\n\n            if (wysihtml5.dom.getTextNodes(ancestor, true).length === 1) {\n              appliedType = \"full\";\n            } else if (appliedType === \"full\") {\n              appliedType = \"inline\";\n            }\n          } else if (!ancestor) {\n            appliedType = \"partial\";\n          }\n        }\n\n      }\n\n      return (ancestors.length) ? {\n        \"elements\": ancestors,\n        \"coverage\": appliedType\n      } : false;\n    },\n\n    toggleRange: function(range) {\n      var isApplied = this.isAppliedToRange(range),\n          parentsExactMatch;\n\n      if (isApplied) {\n        if (isApplied.coverage === \"full\") {\n          this.undoToRange(range);\n        } else if (isApplied.coverage === \"inline\") {\n          parentsExactMatch = areMatchingAllready(isApplied.elements, this.tagNames, this.cssStyle, this.cssClass);\n          this.undoToRange(range);\n          if (!parentsExactMatch) {\n            this.applyToRange(range);\n          }\n        } else {\n          // partial\n          if (!areMatchingAllready(isApplied.elements, this.tagNames, this.cssStyle, this.cssClass)) {\n            this.undoToRange(range);\n          }\n          this.applyToRange(range);\n        }\n      } else {\n        this.applyToRange(range);\n      }\n    }\n  };\n\n  wysihtml5.selection.HTMLApplier = HTMLApplier;\n\n})(wysihtml5, rangy);\n;/**\n * Rich Text Query/Formatting Commands\n *\n * @example\n *    var commands = new wysihtml5.Commands(editor);\n */\nwysihtml5.Commands = Base.extend(\n  /** @scope wysihtml5.Commands.prototype */ {\n  constructor: function(editor) {\n    this.editor   = editor;\n    this.composer = editor.composer;\n    this.doc      = this.composer.doc;\n  },\n\n  /**\n   * Check whether the browser supports the given command\n   *\n   * @param {String} command The command string which to check (eg. \"bold\", \"italic\", \"insertUnorderedList\")\n   * @example\n   *    commands.supports(\"createLink\");\n   */\n  support: function(command) {\n    return wysihtml5.browser.supportsCommand(this.doc, command);\n  },\n\n  /**\n   * Check whether the browser supports the given command\n   *\n   * @param {String} command The command string which to execute (eg. \"bold\", \"italic\", \"insertUnorderedList\")\n   * @param {String} [value] The command value parameter, needed for some commands (\"createLink\", \"insertImage\", ...), optional for commands that don't require one (\"bold\", \"underline\", ...)\n   * @example\n   *    commands.exec(\"insertImage\", \"http://a1.twimg.com/profile_images/113868655/schrei_twitter_reasonably_small.jpg\");\n   */\n  exec: function(command, value) {\n    var obj     = wysihtml5.commands[command],\n        args    = wysihtml5.lang.array(arguments).get(),\n        method  = obj && obj.exec,\n        result  = null;\n\n    this.editor.fire(\"beforecommand:composer\");\n\n    if (method) {\n      args.unshift(this.composer);\n      result = method.apply(obj, args);\n    } else {\n      try {\n        // try/catch for buggy firefox\n        result = this.doc.execCommand(command, false, value);\n      } catch(e) {}\n    }\n\n    this.editor.fire(\"aftercommand:composer\");\n    return result;\n  },\n\n  /**\n   * Check whether the current command is active\n   * If the caret is within a bold text, then calling this with command \"bold\" should return true\n   *\n   * @param {String} command The command string which to check (eg. \"bold\", \"italic\", \"insertUnorderedList\")\n   * @param {String} [commandValue] The command value parameter (eg. for \"insertImage\" the image src)\n   * @return {Boolean} Whether the command is active\n   * @example\n   *    var isCurrentSelectionBold = commands.state(\"bold\");\n   */\n  state: function(command, commandValue) {\n    var obj     = wysihtml5.commands[command],\n        args    = wysihtml5.lang.array(arguments).get(),\n        method  = obj && obj.state;\n    if (method) {\n      args.unshift(this.composer);\n      return method.apply(obj, args);\n    } else {\n      try {\n        // try/catch for buggy firefox\n        return this.doc.queryCommandState(command);\n      } catch(e) {\n        return false;\n      }\n    }\n  },\n\n  /* Get command state parsed value if command has stateValue parsing function */\n  stateValue: function(command) {\n    var obj     = wysihtml5.commands[command],\n        args    = wysihtml5.lang.array(arguments).get(),\n        method  = obj && obj.stateValue;\n    if (method) {\n      args.unshift(this.composer);\n      return method.apply(obj, args);\n    } else {\n      return false;\n    }\n  }\n});\n;wysihtml5.commands.bold = {\n  exec: function(composer, command) {\n    wysihtml5.commands.formatInline.execWithToggle(composer, command, \"b\");\n  },\n\n  state: function(composer, command) {\n    // element.ownerDocument.queryCommandState(\"bold\") results:\n    // firefox: only <b>\n    // chrome:  <b>, <strong>, <h1>, <h2>, ...\n    // ie:      <b>, <strong>\n    // opera:   <b>, <strong>\n    return wysihtml5.commands.formatInline.state(composer, command, \"b\");\n  }\n};\n\n;(function(wysihtml5) {\n  var undef,\n      NODE_NAME = \"A\",\n      dom       = wysihtml5.dom;\n\n  function _format(composer, attributes) {\n    var doc             = composer.doc,\n        tempClass       = \"_wysihtml5-temp-\" + (+new Date()),\n        tempClassRegExp = /non-matching-class/g,\n        i               = 0,\n        length,\n        anchors,\n        anchor,\n        hasElementChild,\n        isEmpty,\n        elementToSetCaretAfter,\n        textContent,\n        whiteSpace,\n        j;\n    wysihtml5.commands.formatInline.exec(composer, undef, NODE_NAME, tempClass, tempClassRegExp, undef, undef, true, true);\n    anchors = doc.querySelectorAll(NODE_NAME + \".\" + tempClass);\n    length  = anchors.length;\n    for (; i<length; i++) {\n      anchor = anchors[i];\n      anchor.removeAttribute(\"class\");\n      for (j in attributes) {\n        // Do not set attribute \"text\" as it is meant for setting string value if created link has no textual data\n        if (j !== \"text\") {\n          anchor.setAttribute(j, attributes[j]);\n        }\n      }\n    }\n\n    elementToSetCaretAfter = anchor;\n    if (length === 1) {\n      textContent = dom.getTextContent(anchor);\n      hasElementChild = !!anchor.querySelector(\"*\");\n      isEmpty = textContent === \"\" || textContent === wysihtml5.INVISIBLE_SPACE;\n      if (!hasElementChild && isEmpty) {\n        dom.setTextContent(anchor, attributes.text || anchor.href);\n        whiteSpace = doc.createTextNode(\" \");\n        composer.selection.setAfter(anchor);\n        dom.insert(whiteSpace).after(anchor);\n        elementToSetCaretAfter = whiteSpace;\n      }\n    }\n    composer.selection.setAfter(elementToSetCaretAfter);\n  }\n\n  // Changes attributes of links\n  function _changeLinks(composer, anchors, attributes) {\n    var oldAttrs;\n    for (var a = anchors.length; a--;) {\n\n      // Remove all old attributes\n      oldAttrs = anchors[a].attributes;\n      for (var oa = oldAttrs.length; oa--;) {\n        anchors[a].removeAttribute(oldAttrs.item(oa).name);\n      }\n\n      // Set new attributes\n      for (var j in attributes) {\n        if (attributes.hasOwnProperty(j)) {\n          anchors[a].setAttribute(j, attributes[j]);\n        }\n      }\n\n    }\n  }\n\n  wysihtml5.commands.createLink = {\n    /**\n     * TODO: Use HTMLApplier or formatInline here\n     *\n     * Turns selection into a link\n     * If selection is already a link, it just changes the attributes\n     *\n     * @example\n     *    // either ...\n     *    wysihtml5.commands.createLink.exec(composer, \"createLink\", \"http://www.google.de\");\n     *    // ... or ...\n     *    wysihtml5.commands.createLink.exec(composer, \"createLink\", { href: \"http://www.google.de\", target: \"_blank\" });\n     */\n    exec: function(composer, command, value) {\n      var anchors = this.state(composer, command);\n      if (anchors) {\n        // Selection contains links then change attributes of these links\n        composer.selection.executeAndRestore(function() {\n          _changeLinks(composer, anchors, value);\n        });\n      } else {\n        // Create links\n        value = typeof(value) === \"object\" ? value : { href: value };\n        _format(composer, value);\n      }\n    },\n\n    state: function(composer, command) {\n      return wysihtml5.commands.formatInline.state(composer, command, \"A\");\n    }\n  };\n})(wysihtml5);\n;(function(wysihtml5) {\n  var dom = wysihtml5.dom;\n\n  function _removeFormat(composer, anchors) {\n    var length  = anchors.length,\n        i       = 0,\n        anchor,\n        codeElement,\n        textContent;\n    for (; i<length; i++) {\n      anchor      = anchors[i];\n      codeElement = dom.getParentElement(anchor, { nodeName: \"code\" });\n      textContent = dom.getTextContent(anchor);\n\n      // if <a> contains url-like text content, rename it to <code> to prevent re-autolinking\n      // else replace <a> with its childNodes\n      if (textContent.match(dom.autoLink.URL_REG_EXP) && !codeElement) {\n        // <code> element is used to prevent later auto-linking of the content\n        codeElement = dom.renameElement(anchor, \"code\");\n      } else {\n        dom.replaceWithChildNodes(anchor);\n      }\n    }\n  }\n\n  wysihtml5.commands.removeLink = {\n    /*\n     * If selection is a link, it removes the link and wraps it with a <code> element\n     * The <code> element is needed to avoid auto linking\n     *\n     * @example\n     *    wysihtml5.commands.createLink.exec(composer, \"removeLink\");\n     */\n\n    exec: function(composer, command) {\n      var anchors = this.state(composer, command);\n      if (anchors) {\n        composer.selection.executeAndRestore(function() {\n          _removeFormat(composer, anchors);\n        });\n      }\n    },\n\n    state: function(composer, command) {\n      return wysihtml5.commands.formatInline.state(composer, command, \"A\");\n    }\n  };\n})(wysihtml5);\n;/**\n * document.execCommand(\"fontSize\") will create either inline styles (firefox, chrome) or use font tags\n * which we don't want\n * Instead we set a css class\n */\n(function(wysihtml5) {\n  var REG_EXP = /wysiwyg-font-size-[0-9a-z\\-]+/g;\n\n  wysihtml5.commands.fontSize = {\n    exec: function(composer, command, size) {\n        wysihtml5.commands.formatInline.execWithToggle(composer, command, \"span\", \"wysiwyg-font-size-\" + size, REG_EXP);\n    },\n\n    state: function(composer, command, size) {\n      return wysihtml5.commands.formatInline.state(composer, command, \"span\", \"wysiwyg-font-size-\" + size, REG_EXP);\n    }\n  };\n})(wysihtml5);\n;/* In case font size adjustment to any number defined by user is preferred, we cannot use classes and must use inline styles. */\n(function(wysihtml5) {\n  var REG_EXP = /(\\s|^)font-size\\s*:\\s*[^;\\s]+;?/gi;\n\n  wysihtml5.commands.fontSizeStyle = {\n    exec: function(composer, command, size) {\n      size = (typeof(size) == \"object\") ? size.size : size;\n      if (!(/^\\s*$/).test(size)) {\n        wysihtml5.commands.formatInline.execWithToggle(composer, command, \"span\", false, false, \"font-size:\" + size, REG_EXP);\n      }\n    },\n\n    state: function(composer, command, size) {\n      return wysihtml5.commands.formatInline.state(composer, command, \"span\", false, false, \"font-size\", REG_EXP);\n    },\n\n    stateValue: function(composer, command) {\n      var st = this.state(composer, command),\n          styleStr, fontsizeMatches,\n          val = false;\n\n      if (st && wysihtml5.lang.object(st).isArray()) {\n          st = st[0];\n      }\n      if (st) {\n        styleStr = st.getAttribute('style');\n        if (styleStr) {\n          return wysihtml5.quirks.styleParser.parseFontSize(styleStr);\n        }\n      }\n      return false;\n    }\n  };\n})(wysihtml5);\n;/**\n * document.execCommand(\"foreColor\") will create either inline styles (firefox, chrome) or use font tags\n * which we don't want\n * Instead we set a css class\n */\n(function(wysihtml5) {\n  var REG_EXP = /wysiwyg-color-[0-9a-z]+/g;\n\n  wysihtml5.commands.foreColor = {\n    exec: function(composer, command, color) {\n        wysihtml5.commands.formatInline.execWithToggle(composer, command, \"span\", \"wysiwyg-color-\" + color, REG_EXP);\n    },\n\n    state: function(composer, command, color) {\n      return wysihtml5.commands.formatInline.state(composer, command, \"span\", \"wysiwyg-color-\" + color, REG_EXP);\n    }\n  };\n})(wysihtml5);\n;/**\n * document.execCommand(\"foreColor\") will create either inline styles (firefox, chrome) or use font tags\n * which we don't want\n * Instead we set a css class\n */\n(function(wysihtml5) {\n  var REG_EXP = /(\\s|^)color\\s*:\\s*[^;\\s]+;?/gi;\n\n  wysihtml5.commands.foreColorStyle = {\n    exec: function(composer, command, color) {\n      var colorVals  = wysihtml5.quirks.styleParser.parseColor((typeof(color) == \"object\") ? \"color:\" + color.color : \"color:\" + color, \"color\"),\n          colString;\n\n      if (colorVals) {\n        colString = \"color: rgb(\" + colorVals[0] + ',' + colorVals[1] + ',' + colorVals[2] + ');';\n        if (colorVals[3] !== 1) {\n          colString += \"color: rgba(\" + colorVals[0] + ',' + colorVals[1] + ',' + colorVals[2] + ',' + colorVals[3] + ');';\n        }\n        wysihtml5.commands.formatInline.execWithToggle(composer, command, \"span\", false, false, colString, REG_EXP);\n      }\n    },\n\n    state: function(composer, command) {\n      return wysihtml5.commands.formatInline.state(composer, command, \"span\", false, false, \"color\", REG_EXP);\n    },\n\n    stateValue: function(composer, command, props) {\n      var st = this.state(composer, command),\n          colorStr;\n\n      if (st && wysihtml5.lang.object(st).isArray()) {\n        st = st[0];\n      }\n\n      if (st) {\n        colorStr = st.getAttribute('style');\n        if (colorStr) {\n          if (colorStr) {\n            val = wysihtml5.quirks.styleParser.parseColor(colorStr, \"color\");\n            return wysihtml5.quirks.styleParser.unparseColor(val, props);\n          }\n        }\n      }\n      return false;\n    }\n\n  };\n})(wysihtml5);\n;/* In case background adjustment to any color defined by user is preferred, we cannot use classes and must use inline styles. */\n(function(wysihtml5) {\n  var REG_EXP = /(\\s|^)background-color\\s*:\\s*[^;\\s]+;?/gi;\n\n  wysihtml5.commands.bgColorStyle = {\n    exec: function(composer, command, color) {\n      var colorVals  = wysihtml5.quirks.styleParser.parseColor((typeof(color) == \"object\") ? \"background-color:\" + color.color : \"background-color:\" + color, \"background-color\"),\n          colString;\n\n      if (colorVals) {\n        colString = \"background-color: rgb(\" + colorVals[0] + ',' + colorVals[1] + ',' + colorVals[2] + ');';\n        if (colorVals[3] !== 1) {\n          colString += \"background-color: rgba(\" + colorVals[0] + ',' + colorVals[1] + ',' + colorVals[2] + ',' + colorVals[3] + ');';\n        }\n        wysihtml5.commands.formatInline.execWithToggle(composer, command, \"span\", false, false, colString, REG_EXP);\n      }\n    },\n\n    state: function(composer, command) {\n      return wysihtml5.commands.formatInline.state(composer, command, \"span\", false, false, \"background-color\", REG_EXP);\n    },\n\n    stateValue: function(composer, command, props) {\n      var st = this.state(composer, command),\n          colorStr,\n          val = false;\n\n      if (st && wysihtml5.lang.object(st).isArray()) {\n        st = st[0];\n      }\n\n      if (st) {\n        colorStr = st.getAttribute('style');\n        if (colorStr) {\n          val = wysihtml5.quirks.styleParser.parseColor(colorStr, \"background-color\");\n          return wysihtml5.quirks.styleParser.unparseColor(val, props);\n        }\n      }\n      return false;\n    }\n\n  };\n})(wysihtml5);\n;(function(wysihtml5) {\n  var dom                     = wysihtml5.dom,\n      // Following elements are grouped\n      // when the caret is within a H1 and the H4 is invoked, the H1 should turn into H4\n      // instead of creating a H4 within a H1 which would result in semantically invalid html\n      BLOCK_ELEMENTS_GROUP    = [\"H1\", \"H2\", \"H3\", \"H4\", \"H5\", \"H6\", \"P\", \"PRE\", \"DIV\"];\n\n  /**\n   * Remove similiar classes (based on classRegExp)\n   * and add the desired class name\n   */\n  function _addClass(element, className, classRegExp) {\n    if (element.className) {\n      _removeClass(element, classRegExp);\n      element.className = wysihtml5.lang.string(element.className + \" \" + className).trim();\n    } else {\n      element.className = className;\n    }\n  }\n\n  function _addStyle(element, cssStyle, styleRegExp) {\n    _removeStyle(element, styleRegExp);\n    if (element.getAttribute('style')) {\n      element.setAttribute('style', wysihtml5.lang.string(element.getAttribute('style') + \" \" + cssStyle).trim());\n    } else {\n      element.setAttribute('style', cssStyle);\n    }\n  }\n\n  function _removeClass(element, classRegExp) {\n    var ret = classRegExp.test(element.className);\n    element.className = element.className.replace(classRegExp, \"\");\n    if (wysihtml5.lang.string(element.className).trim() == '') {\n        element.removeAttribute('class');\n    }\n    return ret;\n  }\n\n  function _removeStyle(element, styleRegExp) {\n    var ret = styleRegExp.test(element.getAttribute('style'));\n    element.setAttribute('style', (element.getAttribute('style') || \"\").replace(styleRegExp, \"\"));\n    if (wysihtml5.lang.string(element.getAttribute('style') || \"\").trim() == '') {\n      element.removeAttribute('style');\n    }\n    return ret;\n  }\n\n  function _removeLastChildIfLineBreak(node) {\n    var lastChild = node.lastChild;\n    if (lastChild && _isLineBreak(lastChild)) {\n      lastChild.parentNode.removeChild(lastChild);\n    }\n  }\n\n  function _isLineBreak(node) {\n    return node.nodeName === \"BR\";\n  }\n\n  /**\n   * Execute native query command\n   * and if necessary modify the inserted node's className\n   */\n  function _execCommand(doc, composer, command, nodeName, className) {\n    var ranges = composer.selection.getOwnRanges();\n    for (var i = ranges.length; i--;){\n      composer.selection.getSelection().removeAllRanges();\n      composer.selection.setSelection(ranges[i]);\n      if (className) {\n        var eventListener = dom.observe(doc, \"DOMNodeInserted\", function(event) {\n          var target = event.target,\n              displayStyle;\n          if (target.nodeType !== wysihtml5.ELEMENT_NODE) {\n            return;\n          }\n          displayStyle = dom.getStyle(\"display\").from(target);\n          if (displayStyle.substr(0, 6) !== \"inline\") {\n            // Make sure that only block elements receive the given class\n            target.className += \" \" + className;\n          }\n        });\n      }\n      doc.execCommand(command, false, nodeName);\n\n      if (eventListener) {\n        eventListener.stop();\n      }\n    }\n  }\n\n  function _selectionWrap(composer, options) {\n    if (composer.selection.isCollapsed()) {\n        composer.selection.selectLine();\n    }\n\n    var surroundedNodes = composer.selection.surround(options);\n    for (var i = 0, imax = surroundedNodes.length; i < imax; i++) {\n      wysihtml5.dom.lineBreaks(surroundedNodes[i]).remove();\n      _removeLastChildIfLineBreak(surroundedNodes[i]);\n    }\n\n    // rethink restoring selection\n    // composer.selection.selectNode(element, wysihtml5.browser.displaysCaretInEmptyContentEditableCorrectly());\n  }\n\n  function _hasClasses(element) {\n    return !!wysihtml5.lang.string(element.className).trim();\n  }\n\n  function _hasStyles(element) {\n    return !!wysihtml5.lang.string(element.getAttribute('style') || '').trim();\n  }\n\n  wysihtml5.commands.formatBlock = {\n    exec: function(composer, command, nodeName, className, classRegExp, cssStyle, styleRegExp) {\n      var doc             = composer.doc,\n          blockElements    = this.state(composer, command, nodeName, className, classRegExp, cssStyle, styleRegExp),\n          useLineBreaks   = composer.config.useLineBreaks,\n          defaultNodeName = useLineBreaks ? \"DIV\" : \"P\",\n          selectedNodes, classRemoveAction, blockRenameFound, styleRemoveAction, blockElement;\n      nodeName = typeof(nodeName) === \"string\" ? nodeName.toUpperCase() : nodeName;\n\n      if (blockElements.length) {\n        composer.selection.executeAndRestoreRangy(function() {\n          for (var b = blockElements.length; b--;) {\n            if (classRegExp) {\n              classRemoveAction = _removeClass(blockElements[b], classRegExp);\n            }\n            if (styleRegExp) {\n              styleRemoveAction = _removeStyle(blockElements[b], styleRegExp);\n            }\n\n            if ((styleRemoveAction || classRemoveAction) && nodeName === null && blockElements[b].nodeName != defaultNodeName) {\n              // dont rename or remove element when just setting block formating class or style\n              return;\n            }\n\n            var hasClasses = _hasClasses(blockElements[b]),\n                hasStyles = _hasStyles(blockElements[b]);\n\n            if (!hasClasses && !hasStyles && (useLineBreaks || nodeName === \"P\")) {\n              // Insert a line break afterwards and beforewards when there are siblings\n              // that are not of type line break or block element\n              wysihtml5.dom.lineBreaks(blockElements[b]).add();\n              dom.replaceWithChildNodes(blockElements[b]);\n            } else {\n              // Make sure that styling is kept by renaming the element to a <div> or <p> and copying over the class name\n              dom.renameElement(blockElements[b], nodeName === \"P\" ? \"DIV\" : defaultNodeName);\n            }\n          }\n        });\n\n        return;\n      }\n\n      // Find similiar block element and rename it (<h2 class=\"foo\"></h2>  =>  <h1 class=\"foo\"></h1>)\n      if (nodeName === null || wysihtml5.lang.array(BLOCK_ELEMENTS_GROUP).contains(nodeName)) {\n        selectedNodes = composer.selection.findNodesInSelection(BLOCK_ELEMENTS_GROUP).concat(composer.selection.getSelectedOwnNodes());\n        composer.selection.executeAndRestoreRangy(function() {\n          for (var n = selectedNodes.length; n--;) {\n            blockElement = dom.getParentElement(selectedNodes[n], {\n              nodeName: BLOCK_ELEMENTS_GROUP\n            });\n            if (blockElement == composer.element) {\n              blockElement = null;\n            }\n            if (blockElement) {\n                // Rename current block element to new block element and add class\n                if (nodeName) {\n                  blockElement = dom.renameElement(blockElement, nodeName);\n                }\n                if (className) {\n                  _addClass(blockElement, className, classRegExp);\n                }\n                if (cssStyle) {\n                  _addStyle(blockElement, cssStyle, styleRegExp);\n                }\n              blockRenameFound = true;\n            }\n          }\n\n        });\n\n        if (blockRenameFound) {\n          return;\n        }\n      }\n\n      _selectionWrap(composer, {\n        \"nodeName\": (nodeName || defaultNodeName),\n        \"className\": className || null,\n        \"cssStyle\": cssStyle || null\n      });\n    },\n\n    state: function(composer, command, nodeName, className, classRegExp, cssStyle, styleRegExp) {\n      var nodes = composer.selection.getSelectedOwnNodes(),\n          parents = [],\n          parent;\n\n      nodeName = typeof(nodeName) === \"string\" ? nodeName.toUpperCase() : nodeName;\n\n      //var selectedNode = composer.selection.getSelectedNode();\n      for (var i = 0, maxi = nodes.length; i < maxi; i++) {\n        parent = dom.getParentElement(nodes[i], {\n          nodeName:     nodeName,\n          className:    className,\n          classRegExp:  classRegExp,\n          cssStyle:     cssStyle,\n          styleRegExp:  styleRegExp\n        });\n        if (parent && wysihtml5.lang.array(parents).indexOf(parent) == -1) {\n          parents.push(parent);\n        }\n      }\n      if (parents.length == 0) {\n        return false;\n      }\n      return parents;\n    }\n\n\n  };\n})(wysihtml5);\n;/* Formats block for as a <pre><code class=\"classname\"></code></pre> block\n * Useful in conjuction for sytax highlight utility: highlight.js\n *\n * Usage:\n *\n * editorInstance.composer.commands.exec(\"formatCode\", \"language-html\");\n*/\n\nwysihtml5.commands.formatCode = {\n\n  exec: function(composer, command, classname) {\n    var pre = this.state(composer),\n        code, range, selectedNodes;\n    if (pre) {\n      // caret is already within a <pre><code>...</code></pre>\n      composer.selection.executeAndRestore(function() {\n        code = pre.querySelector(\"code\");\n        wysihtml5.dom.replaceWithChildNodes(pre);\n        if (code) {\n          wysihtml5.dom.replaceWithChildNodes(code);\n        }\n      });\n    } else {\n      // Wrap in <pre><code>...</code></pre>\n      range = composer.selection.getRange();\n      selectedNodes = range.extractContents();\n      pre = composer.doc.createElement(\"pre\");\n      code = composer.doc.createElement(\"code\");\n\n      if (classname) {\n        code.className = classname;\n      }\n\n      pre.appendChild(code);\n      code.appendChild(selectedNodes);\n      range.insertNode(pre);\n      composer.selection.selectNode(pre);\n    }\n  },\n\n  state: function(composer) {\n    var selectedNode = composer.selection.getSelectedNode();\n    if (selectedNode && selectedNode.nodeName && selectedNode.nodeName == \"PRE\"&&\n        selectedNode.firstChild && selectedNode.firstChild.nodeName && selectedNode.firstChild.nodeName == \"CODE\") {\n      return selectedNode;\n    } else {\n      return wysihtml5.dom.getParentElement(selectedNode, { nodeName: \"CODE\" }) && wysihtml5.dom.getParentElement(selectedNode, { nodeName: \"PRE\" });\n    }\n  }\n};;/**\n * formatInline scenarios for tag \"B\" (| = caret, |foo| = selected text)\n *\n *   #1 caret in unformatted text:\n *      abcdefg|\n *   output:\n *      abcdefg<b>|</b>\n *\n *   #2 unformatted text selected:\n *      abc|deg|h\n *   output:\n *      abc<b>|deg|</b>h\n *\n *   #3 unformatted text selected across boundaries:\n *      ab|c <span>defg|h</span>\n *   output:\n *      ab<b>|c </b><span><b>defg</b>|h</span>\n *\n *   #4 formatted text entirely selected\n *      <b>|abc|</b>\n *   output:\n *      |abc|\n *\n *   #5 formatted text partially selected\n *      <b>ab|c|</b>\n *   output:\n *      <b>ab</b>|c|\n *\n *   #6 formatted text selected across boundaries\n *      <span>ab|c</span> <b>de|fgh</b>\n *   output:\n *      <span>ab|c</span> de|<b>fgh</b>\n */\n(function(wysihtml5) {\n  var // Treat <b> as <strong> and vice versa\n      ALIAS_MAPPING = {\n        \"strong\": \"b\",\n        \"em\":     \"i\",\n        \"b\":      \"strong\",\n        \"i\":      \"em\"\n      },\n      htmlApplier = {};\n\n  function _getTagNames(tagName) {\n    var alias = ALIAS_MAPPING[tagName];\n    return alias ? [tagName.toLowerCase(), alias.toLowerCase()] : [tagName.toLowerCase()];\n  }\n\n  function _getApplier(tagName, className, classRegExp, cssStyle, styleRegExp, container) {\n    var identifier = tagName;\n    \n    if (className) {\n      identifier += \":\" + className;\n    }\n    if (cssStyle) {\n      identifier += \":\" + cssStyle;\n    }\n\n    if (!htmlApplier[identifier]) {\n      htmlApplier[identifier] = new wysihtml5.selection.HTMLApplier(_getTagNames(tagName), className, classRegExp, true, cssStyle, styleRegExp, container);\n    }\n\n    return htmlApplier[identifier];\n  }\n\n  wysihtml5.commands.formatInline = {\n    exec: function(composer, command, tagName, className, classRegExp, cssStyle, styleRegExp, dontRestoreSelect, noCleanup) {\n      var range = composer.selection.createRange(),\n          ownRanges = composer.selection.getOwnRanges();\n\n      if (!ownRanges || ownRanges.length == 0) {\n        return false;\n      }\n      composer.selection.getSelection().removeAllRanges();\n\n      _getApplier(tagName, className, classRegExp, cssStyle, styleRegExp, composer.element).toggleRange(ownRanges);\n\n      if (!dontRestoreSelect) {\n        range.setStart(ownRanges[0].startContainer,  ownRanges[0].startOffset);\n        range.setEnd(\n          ownRanges[ownRanges.length - 1].endContainer,\n          ownRanges[ownRanges.length - 1].endOffset\n        );\n        composer.selection.setSelection(range);\n        composer.selection.executeAndRestore(function() {\n          if (!noCleanup) {\n            composer.cleanUp();\n          }\n        }, true, true);\n      } else if (!noCleanup) {\n        composer.cleanUp();\n      }\n    },\n\n    // Executes so that if collapsed caret is in a state and executing that state it should unformat that state\n    // It is achieved by selecting the entire state element before executing.\n    // This works on built in contenteditable inline format commands\n    execWithToggle: function(composer, command, tagName, className, classRegExp, cssStyle, styleRegExp) {\n      var that = this;\n\n      if (this.state(composer, command, tagName, className, classRegExp, cssStyle, styleRegExp) &&\n        composer.selection.isCollapsed() &&\n        !composer.selection.caretIsLastInSelection() &&\n        !composer.selection.caretIsFirstInSelection()\n      ) {\n        var state_element = that.state(composer, command, tagName, className, classRegExp)[0];\n        composer.selection.executeAndRestoreRangy(function() {\n          var parent = state_element.parentNode;\n          composer.selection.selectNode(state_element, true);\n          wysihtml5.commands.formatInline.exec(composer, command, tagName, className, classRegExp, cssStyle, styleRegExp, true, true);\n        });\n      } else {\n        if (this.state(composer, command, tagName, className, classRegExp, cssStyle, styleRegExp) && !composer.selection.isCollapsed()) {\n          composer.selection.executeAndRestoreRangy(function() {\n            wysihtml5.commands.formatInline.exec(composer, command, tagName, className, classRegExp, cssStyle, styleRegExp, true, true);\n          });\n        } else {\n          wysihtml5.commands.formatInline.exec(composer, command, tagName, className, classRegExp, cssStyle, styleRegExp);\n        }\n      }\n    },\n\n    state: function(composer, command, tagName, className, classRegExp, cssStyle, styleRegExp) {\n      var doc           = composer.doc,\n          aliasTagName  = ALIAS_MAPPING[tagName] || tagName,\n          ownRanges, isApplied;\n\n      // Check whether the document contains a node with the desired tagName\n      if (!wysihtml5.dom.hasElementWithTagName(doc, tagName) &&\n          !wysihtml5.dom.hasElementWithTagName(doc, aliasTagName)) {\n        return false;\n      }\n\n       // Check whether the document contains a node with the desired className\n      if (className && !wysihtml5.dom.hasElementWithClassName(doc, className)) {\n         return false;\n      }\n\n      ownRanges = composer.selection.getOwnRanges();\n\n      if (!ownRanges || ownRanges.length === 0) {\n        return false;\n      }\n\n      isApplied = _getApplier(tagName, className, classRegExp, cssStyle, styleRegExp, composer.element).isAppliedToRange(ownRanges);\n\n      return (isApplied && isApplied.elements) ? isApplied.elements : false;\n    }\n  };\n})(wysihtml5);\n;(function(wysihtml5) {\n\n  wysihtml5.commands.insertBlockQuote = {\n    exec: function(composer, command) {\n      var state = this.state(composer, command),\n          endToEndParent = composer.selection.isEndToEndInNode(['H1', 'H2', 'H3', 'H4', 'H5', 'H6', 'P']),\n          prevNode, nextNode;\n\n      composer.selection.executeAndRestore(function() {\n        if (state) {\n          if (composer.config.useLineBreaks) {\n             wysihtml5.dom.lineBreaks(state).add();\n          }\n          wysihtml5.dom.unwrap(state);\n        } else {\n          if (composer.selection.isCollapsed()) {\n            composer.selection.selectLine();\n          }\n          \n          if (endToEndParent) {\n            var qouteEl = endToEndParent.ownerDocument.createElement('blockquote');\n            wysihtml5.dom.insert(qouteEl).after(endToEndParent);\n            qouteEl.appendChild(endToEndParent);\n          } else {\n            composer.selection.surround({nodeName: \"blockquote\"});\n          }\n        }\n      });\n    },\n    state: function(composer, command) {\n      var selectedNode  = composer.selection.getSelectedNode(),\n          node = wysihtml5.dom.getParentElement(selectedNode, { nodeName: \"BLOCKQUOTE\" }, false, composer.element);\n\n      return (node) ? node : false;\n    }\n  };\n\n})(wysihtml5);;wysihtml5.commands.insertHTML = {\n  exec: function(composer, command, html) {\n    if (composer.commands.support(command)) {\n      composer.doc.execCommand(command, false, html);\n    } else {\n      composer.selection.insertHTML(html);\n    }\n  },\n\n  state: function() {\n    return false;\n  }\n};\n;(function(wysihtml5) {\n  var NODE_NAME = \"IMG\";\n\n  wysihtml5.commands.insertImage = {\n    /**\n     * Inserts an <img>\n     * If selection is already an image link, it removes it\n     *\n     * @example\n     *    // either ...\n     *    wysihtml5.commands.insertImage.exec(composer, \"insertImage\", \"http://www.google.de/logo.jpg\");\n     *    // ... or ...\n     *    wysihtml5.commands.insertImage.exec(composer, \"insertImage\", { src: \"http://www.google.de/logo.jpg\", title: \"foo\" });\n     */\n    exec: function(composer, command, value) {\n      value = typeof(value) === \"object\" ? value : { src: value };\n\n      var doc     = composer.doc,\n          image   = this.state(composer),\n          textNode,\n          parent;\n\n      if (image) {\n        // Image already selected, set the caret before it and delete it\n        composer.selection.setBefore(image);\n        parent = image.parentNode;\n        parent.removeChild(image);\n\n        // and it's parent <a> too if it hasn't got any other relevant child nodes\n        wysihtml5.dom.removeEmptyTextNodes(parent);\n        if (parent.nodeName === \"A\" && !parent.firstChild) {\n          composer.selection.setAfter(parent);\n          parent.parentNode.removeChild(parent);\n        }\n\n        // firefox and ie sometimes don't remove the image handles, even though the image got removed\n        wysihtml5.quirks.redraw(composer.element);\n        return;\n      }\n\n      image = doc.createElement(NODE_NAME);\n\n      for (var i in value) {\n        image.setAttribute(i === \"className\" ? \"class\" : i, value[i]);\n      }\n\n      composer.selection.insertNode(image);\n      if (wysihtml5.browser.hasProblemsSettingCaretAfterImg()) {\n        textNode = doc.createTextNode(wysihtml5.INVISIBLE_SPACE);\n        composer.selection.insertNode(textNode);\n        composer.selection.setAfter(textNode);\n      } else {\n        composer.selection.setAfter(image);\n      }\n    },\n\n    state: function(composer) {\n      var doc = composer.doc,\n          selectedNode,\n          text,\n          imagesInSelection;\n\n      if (!wysihtml5.dom.hasElementWithTagName(doc, NODE_NAME)) {\n        return false;\n      }\n\n      selectedNode = composer.selection.getSelectedNode();\n      if (!selectedNode) {\n        return false;\n      }\n\n      if (selectedNode.nodeName === NODE_NAME) {\n        // This works perfectly in IE\n        return selectedNode;\n      }\n\n      if (selectedNode.nodeType !== wysihtml5.ELEMENT_NODE) {\n        return false;\n      }\n\n      text = composer.selection.getText();\n      text = wysihtml5.lang.string(text).trim();\n      if (text) {\n        return false;\n      }\n\n      imagesInSelection = composer.selection.getNodes(wysihtml5.ELEMENT_NODE, function(node) {\n        return node.nodeName === \"IMG\";\n      });\n\n      if (imagesInSelection.length !== 1) {\n        return false;\n      }\n\n      return imagesInSelection[0];\n    }\n  };\n})(wysihtml5);\n;(function(wysihtml5) {\n  var LINE_BREAK = \"<br>\" + (wysihtml5.browser.needsSpaceAfterLineBreak() ? \" \" : \"\");\n\n  wysihtml5.commands.insertLineBreak = {\n    exec: function(composer, command) {\n      if (composer.commands.support(command)) {\n        composer.doc.execCommand(command, false, null);\n        if (!wysihtml5.browser.autoScrollsToCaret()) {\n          composer.selection.scrollIntoView();\n        }\n      } else {\n        composer.commands.exec(\"insertHTML\", LINE_BREAK);\n      }\n    },\n\n    state: function() {\n      return false;\n    }\n  };\n})(wysihtml5);\n;wysihtml5.commands.insertOrderedList = {\n  exec: function(composer, command) {\n    wysihtml5.commands.insertList.exec(composer, command, \"OL\");\n  },\n\n  state: function(composer, command) {\n    return wysihtml5.commands.insertList.state(composer, command, \"OL\");\n  }\n};\n;wysihtml5.commands.insertUnorderedList = {\n  exec: function(composer, command) {\n    wysihtml5.commands.insertList.exec(composer, command, \"UL\");\n  },\n\n  state: function(composer, command) {\n    return wysihtml5.commands.insertList.state(composer, command, \"UL\");\n  }\n};\n;wysihtml5.commands.insertList = (function(wysihtml5) {\n\n  var isNode = function(node, name) {\n    if (node && node.nodeName) {\n      if (typeof name === 'string') {\n        name = [name];\n      }\n      for (var n = name.length; n--;) {\n        if (node.nodeName === name[n]) {\n          return true;\n        }\n      }\n    }\n    return false;\n  };\n\n  var findListEl = function(node, nodeName, composer) {\n    var ret = {\n          el: null,\n          other: false\n        };\n\n    if (node) {\n      var parentLi = wysihtml5.dom.getParentElement(node, { nodeName: \"LI\" }),\n          otherNodeName = (nodeName === \"UL\") ? \"OL\" : \"UL\";\n\n      if (isNode(node, nodeName)) {\n        ret.el = node;\n      } else if (isNode(node, otherNodeName)) {\n        ret = {\n          el: node,\n          other: true\n        };\n      } else if (parentLi) {\n        if (isNode(parentLi.parentNode, nodeName)) {\n          ret.el = parentLi.parentNode;\n        } else if (isNode(parentLi.parentNode, otherNodeName)) {\n          ret = {\n            el : parentLi.parentNode,\n            other: true\n          };\n        }\n      }\n    }\n\n    // do not count list elements outside of composer\n    if (ret.el && !composer.element.contains(ret.el)) {\n      ret.el = null;\n    }\n\n    return ret;\n  };\n\n  var handleSameTypeList = function(el, nodeName, composer) {\n    var otherNodeName = (nodeName === \"UL\") ? \"OL\" : \"UL\",\n        otherLists, innerLists;\n    // Unwrap list\n    // <ul><li>foo</li><li>bar</li></ul>\n    // becomes:\n    // foo<br>bar<br>\n    composer.selection.executeAndRestore(function() {\n      var otherLists = getListsInSelection(otherNodeName, composer);\n      if (otherLists.length) {\n        for (var l = otherLists.length; l--;) {\n          wysihtml5.dom.renameElement(otherLists[l], nodeName.toLowerCase());\n        }\n      } else {\n        innerLists = getListsInSelection(['OL', 'UL'], composer);\n        for (var i = innerLists.length; i--;) {\n          wysihtml5.dom.resolveList(innerLists[i], composer.config.useLineBreaks);\n        }\n        wysihtml5.dom.resolveList(el, composer.config.useLineBreaks);\n      }\n    });\n  };\n\n  var handleOtherTypeList =  function(el, nodeName, composer) {\n    var otherNodeName = (nodeName === \"UL\") ? \"OL\" : \"UL\";\n    // Turn an ordered list into an unordered list\n    // <ol><li>foo</li><li>bar</li></ol>\n    // becomes:\n    // <ul><li>foo</li><li>bar</li></ul>\n    // Also rename other lists in selection\n    composer.selection.executeAndRestore(function() {\n      var renameLists = [el].concat(getListsInSelection(otherNodeName, composer));\n\n      // All selection inner lists get renamed too\n      for (var l = renameLists.length; l--;) {\n        wysihtml5.dom.renameElement(renameLists[l], nodeName.toLowerCase());\n      }\n    });\n  };\n\n  var getListsInSelection = function(nodeName, composer) {\n      var ranges = composer.selection.getOwnRanges(),\n          renameLists = [];\n\n      for (var r = ranges.length; r--;) {\n        renameLists = renameLists.concat(ranges[r].getNodes([1], function(node) {\n          return isNode(node, nodeName);\n        }));\n      }\n\n      return renameLists;\n  };\n\n  var createListFallback = function(nodeName, composer) {\n    // Fallback for Create list\n    composer.selection.executeAndRestoreRangy(function() {\n      var tempClassName =  \"_wysihtml5-temp-\" + new Date().getTime(),\n          tempElement = composer.selection.deblockAndSurround({\n            \"nodeName\": \"div\",\n            \"className\": tempClassName\n          }),\n          isEmpty, list;\n\n      // This space causes new lists to never break on enter \n      var INVISIBLE_SPACE_REG_EXP = /\\uFEFF/g;\n      tempElement.innerHTML = tempElement.innerHTML.replace(INVISIBLE_SPACE_REG_EXP, \"\");\n      \n      if (tempElement) {\n        isEmpty = wysihtml5.lang.array([\"\", \"<br>\", wysihtml5.INVISIBLE_SPACE]).contains(tempElement.innerHTML);\n        list = wysihtml5.dom.convertToList(tempElement, nodeName.toLowerCase(), composer.parent.config.uneditableContainerClassname);\n        if (isEmpty) {\n          composer.selection.selectNode(list.querySelector(\"li\"), true);\n        }\n      }\n    });\n  };\n\n  return {\n    exec: function(composer, command, nodeName) {\n      var doc           = composer.doc,\n          cmd           = (nodeName === \"OL\") ? \"insertOrderedList\" : \"insertUnorderedList\",\n          selectedNode  = composer.selection.getSelectedNode(),\n          list          = findListEl(selectedNode, nodeName, composer);\n\n      if (!list.el){\n        if (composer.commands.support(cmd)) {\n          doc.execCommand(cmd, false, null);\n        } else {\n          createListFallback(nodeName, composer);\n        }\n      } else if (list.other) {\n        handleOtherTypeList(list.el, nodeName, composer);\n      } else {\n        handleSameTypeList(list.el, nodeName, composer);\n      }\n    },\n\n    state: function(composer, command, nodeName) {\n      var selectedNode = composer.selection.getSelectedNode(),\n          list         = findListEl(selectedNode, nodeName, composer);\n\n      return (list.el && !list.other) ? list.el : false;\n    }\n  };\n\n})(wysihtml5);;wysihtml5.commands.italic = {\n  exec: function(composer, command) {\n    wysihtml5.commands.formatInline.execWithToggle(composer, command, \"i\");\n  },\n\n  state: function(composer, command) {\n    // element.ownerDocument.queryCommandState(\"italic\") results:\n    // firefox: only <i>\n    // chrome:  <i>, <em>, <blockquote>, ...\n    // ie:      <i>, <em>\n    // opera:   only <i>\n    return wysihtml5.commands.formatInline.state(composer, command, \"i\");\n  }\n};\n;(function(wysihtml5) {\n  var CLASS_NAME  = \"wysiwyg-text-align-center\",\n      REG_EXP     = /wysiwyg-text-align-[0-9a-z]+/g;\n\n  wysihtml5.commands.justifyCenter = {\n    exec: function(composer, command) {\n      return wysihtml5.commands.formatBlock.exec(composer, \"formatBlock\", null, CLASS_NAME, REG_EXP);\n    },\n\n    state: function(composer, command) {\n      return wysihtml5.commands.formatBlock.state(composer, \"formatBlock\", null, CLASS_NAME, REG_EXP);\n    }\n  };\n})(wysihtml5);\n;(function(wysihtml5) {\n  var CLASS_NAME  = \"wysiwyg-text-align-left\",\n      REG_EXP     = /wysiwyg-text-align-[0-9a-z]+/g;\n\n  wysihtml5.commands.justifyLeft = {\n    exec: function(composer, command) {\n      return wysihtml5.commands.formatBlock.exec(composer, \"formatBlock\", null, CLASS_NAME, REG_EXP);\n    },\n\n    state: function(composer, command) {\n      return wysihtml5.commands.formatBlock.state(composer, \"formatBlock\", null, CLASS_NAME, REG_EXP);\n    }\n  };\n})(wysihtml5);\n;(function(wysihtml5) {\n  var CLASS_NAME  = \"wysiwyg-text-align-right\",\n      REG_EXP     = /wysiwyg-text-align-[0-9a-z]+/g;\n\n  wysihtml5.commands.justifyRight = {\n    exec: function(composer, command) {\n      return wysihtml5.commands.formatBlock.exec(composer, \"formatBlock\", null, CLASS_NAME, REG_EXP);\n    },\n\n    state: function(composer, command) {\n      return wysihtml5.commands.formatBlock.state(composer, \"formatBlock\", null, CLASS_NAME, REG_EXP);\n    }\n  };\n})(wysihtml5);\n;(function(wysihtml5) {\n  var CLASS_NAME  = \"wysiwyg-text-align-justify\",\n      REG_EXP     = /wysiwyg-text-align-[0-9a-z]+/g;\n\n  wysihtml5.commands.justifyFull = {\n    exec: function(composer, command) {\n      return wysihtml5.commands.formatBlock.exec(composer, \"formatBlock\", null, CLASS_NAME, REG_EXP);\n    },\n\n    state: function(composer, command) {\n      return wysihtml5.commands.formatBlock.state(composer, \"formatBlock\", null, CLASS_NAME, REG_EXP);\n    }\n  };\n})(wysihtml5);\n;(function(wysihtml5) {\n  var STYLE_STR  = \"text-align: right;\",\n      REG_EXP = /(\\s|^)text-align\\s*:\\s*[^;\\s]+;?/gi;\n\n  wysihtml5.commands.alignRightStyle = {\n    exec: function(composer, command) {\n      return wysihtml5.commands.formatBlock.exec(composer, \"formatBlock\", null, null, null, STYLE_STR, REG_EXP);\n    },\n\n    state: function(composer, command) {\n      return wysihtml5.commands.formatBlock.state(composer, \"formatBlock\", null, null, null, STYLE_STR, REG_EXP);\n    }\n  };\n})(wysihtml5);\n;(function(wysihtml5) {\n  var STYLE_STR  = \"text-align: left;\",\n      REG_EXP = /(\\s|^)text-align\\s*:\\s*[^;\\s]+;?/gi;\n\n  wysihtml5.commands.alignLeftStyle = {\n    exec: function(composer, command) {\n      return wysihtml5.commands.formatBlock.exec(composer, \"formatBlock\", null, null, null, STYLE_STR, REG_EXP);\n    },\n\n    state: function(composer, command) {\n      return wysihtml5.commands.formatBlock.state(composer, \"formatBlock\", null, null, null, STYLE_STR, REG_EXP);\n    }\n  };\n})(wysihtml5);\n;(function(wysihtml5) {\n  var STYLE_STR  = \"text-align: center;\",\n      REG_EXP = /(\\s|^)text-align\\s*:\\s*[^;\\s]+;?/gi;\n\n  wysihtml5.commands.alignCenterStyle = {\n    exec: function(composer, command) {\n      return wysihtml5.commands.formatBlock.exec(composer, \"formatBlock\", null, null, null, STYLE_STR, REG_EXP);\n    },\n\n    state: function(composer, command) {\n      return wysihtml5.commands.formatBlock.state(composer, \"formatBlock\", null, null, null, STYLE_STR, REG_EXP);\n    }\n  };\n})(wysihtml5);\n;wysihtml5.commands.redo = {\n  exec: function(composer) {\n    return composer.undoManager.redo();\n  },\n\n  state: function(composer) {\n    return false;\n  }\n};\n;wysihtml5.commands.underline = {\n  exec: function(composer, command) {\n    wysihtml5.commands.formatInline.execWithToggle(composer, command, \"u\");\n  },\n\n  state: function(composer, command) {\n    return wysihtml5.commands.formatInline.state(composer, command, \"u\");\n  }\n};\n;wysihtml5.commands.undo = {\n  exec: function(composer) {\n    return composer.undoManager.undo();\n  },\n\n  state: function(composer) {\n    return false;\n  }\n};\n;wysihtml5.commands.createTable = {\n  exec: function(composer, command, value) {\n      var col, row, html;\n      if (value && value.cols && value.rows && parseInt(value.cols, 10) > 0 && parseInt(value.rows, 10) > 0) {\n          if (value.tableStyle) {\n            html = \"<table style=\\\"\" + value.tableStyle + \"\\\">\";\n          } else {\n            html = \"<table>\";\n          }\n          html += \"<tbody>\";\n          for (row = 0; row < value.rows; row ++) {\n              html += '<tr>';\n              for (col = 0; col < value.cols; col ++) {\n                  html += \"<td>&nbsp;</td>\";\n              }\n              html += '</tr>';\n          }\n          html += \"</tbody></table>\";\n          composer.commands.exec(\"insertHTML\", html);\n          //composer.selection.insertHTML(html);\n      }\n\n\n  },\n\n  state: function(composer, command) {\n      return false;\n  }\n};\n;wysihtml5.commands.mergeTableCells = {\n  exec: function(composer, command) {\n      if (composer.tableSelection && composer.tableSelection.start && composer.tableSelection.end) {\n          if (this.state(composer, command)) {\n              wysihtml5.dom.table.unmergeCell(composer.tableSelection.start);\n          } else {\n              wysihtml5.dom.table.mergeCellsBetween(composer.tableSelection.start, composer.tableSelection.end);\n          }\n      }\n  },\n\n  state: function(composer, command) {\n      if (composer.tableSelection) {\n          var start = composer.tableSelection.start,\n              end = composer.tableSelection.end;\n          if (start && end && start == end &&\n              ((\n                  wysihtml5.dom.getAttribute(start, \"colspan\") &&\n                  parseInt(wysihtml5.dom.getAttribute(start, \"colspan\"), 10) > 1\n              ) || (\n                  wysihtml5.dom.getAttribute(start, \"rowspan\") &&\n                  parseInt(wysihtml5.dom.getAttribute(start, \"rowspan\"), 10) > 1\n              ))\n          ) {\n              return [start];\n          }\n      }\n      return false;\n  }\n};\n;wysihtml5.commands.addTableCells = {\n  exec: function(composer, command, value) {\n      if (composer.tableSelection && composer.tableSelection.start && composer.tableSelection.end) {\n\n          // switches start and end if start is bigger than end (reverse selection)\n          var tableSelect = wysihtml5.dom.table.orderSelectionEnds(composer.tableSelection.start, composer.tableSelection.end);\n          if (value == \"before\" || value == \"above\") {\n              wysihtml5.dom.table.addCells(tableSelect.start, value);\n          } else if (value == \"after\" || value == \"below\") {\n              wysihtml5.dom.table.addCells(tableSelect.end, value);\n          }\n          setTimeout(function() {\n              composer.tableSelection.select(tableSelect.start, tableSelect.end);\n          },0);\n      }\n  },\n\n  state: function(composer, command) {\n      return false;\n  }\n};\n;wysihtml5.commands.deleteTableCells = {\n  exec: function(composer, command, value) {\n      if (composer.tableSelection && composer.tableSelection.start && composer.tableSelection.end) {\n          var tableSelect = wysihtml5.dom.table.orderSelectionEnds(composer.tableSelection.start, composer.tableSelection.end),\n              idx = wysihtml5.dom.table.indexOf(tableSelect.start),\n              selCell,\n              table = composer.tableSelection.table;\n\n          wysihtml5.dom.table.removeCells(tableSelect.start, value);\n          setTimeout(function() {\n              // move selection to next or previous if not present\n              selCell = wysihtml5.dom.table.findCell(table, idx);\n\n              if (!selCell){\n                  if (value == \"row\") {\n                      selCell = wysihtml5.dom.table.findCell(table, {\n                          \"row\": idx.row - 1,\n                          \"col\": idx.col\n                      });\n                  }\n\n                  if (value == \"column\") {\n                      selCell = wysihtml5.dom.table.findCell(table, {\n                          \"row\": idx.row,\n                          \"col\": idx.col - 1\n                      });\n                  }\n              }\n              if (selCell) {\n                  composer.tableSelection.select(selCell, selCell);\n              }\n          }, 0);\n\n      }\n  },\n\n  state: function(composer, command) {\n      return false;\n  }\n};\n;wysihtml5.commands.indentList = {\n  exec: function(composer, command, value) {\n    var listEls = composer.selection.getSelectionParentsByTag('LI');\n    if (listEls) {\n      return this.tryToPushLiLevel(listEls, composer.selection);\n    }\n    return false;\n  },\n\n  state: function(composer, command) {\n      return false;\n  },\n\n  tryToPushLiLevel: function(liNodes, selection) {\n    var listTag, list, prevLi, liNode, prevLiList,\n        found = false;\n\n    selection.executeAndRestoreRangy(function() {\n\n      for (var i = liNodes.length; i--;) {\n        liNode = liNodes[i];\n        listTag = (liNode.parentNode.nodeName === 'OL') ? 'OL' : 'UL';\n        list = liNode.ownerDocument.createElement(listTag);\n        prevLi = wysihtml5.dom.domNode(liNode).prev({nodeTypes: [wysihtml5.ELEMENT_NODE]});\n        prevLiList = (prevLi) ? prevLi.querySelector('ul, ol') : null;\n\n        if (prevLi) {\n          if (prevLiList) {\n            prevLiList.appendChild(liNode);\n          } else {\n            list.appendChild(liNode);\n            prevLi.appendChild(list);\n          }\n          found = true;\n        }\n      }\n\n    });\n    return found;\n  }\n};\n;wysihtml5.commands.outdentList = {\n  exec: function(composer, command, value) {\n    var listEls = composer.selection.getSelectionParentsByTag('LI');\n    if (listEls) {\n      return this.tryToPullLiLevel(listEls, composer);\n    }\n    return false;\n  },\n\n  state: function(composer, command) {\n      return false;\n  },\n\n  tryToPullLiLevel: function(liNodes, composer) {\n    var listNode, outerListNode, outerLiNode, list, prevLi, liNode, afterList,\n        found = false,\n        that = this;\n\n    composer.selection.executeAndRestoreRangy(function() {\n\n      for (var i = liNodes.length; i--;) {\n        liNode = liNodes[i];\n        if (liNode.parentNode) {\n          listNode = liNode.parentNode;\n\n          if (listNode.tagName === 'OL' || listNode.tagName === 'UL') {\n            found = true;\n\n            outerListNode = wysihtml5.dom.getParentElement(listNode.parentNode, { nodeName: ['OL', 'UL']}, false, composer.element);\n            outerLiNode = wysihtml5.dom.getParentElement(listNode.parentNode, { nodeName: ['LI']}, false, composer.element);\n\n            if (outerListNode && outerLiNode) {\n\n              if (liNode.nextSibling) {\n                afterList = that.getAfterList(listNode, liNode);\n                liNode.appendChild(afterList);\n              }\n              outerListNode.insertBefore(liNode, outerLiNode.nextSibling);\n\n            } else {\n\n              if (liNode.nextSibling) {\n                afterList = that.getAfterList(listNode, liNode);\n                liNode.appendChild(afterList);\n              }\n\n              for (var j = liNode.childNodes.length; j--;) {\n                listNode.parentNode.insertBefore(liNode.childNodes[j], listNode.nextSibling);\n              }\n\n              listNode.parentNode.insertBefore(document.createElement('br'), listNode.nextSibling);\n              liNode.parentNode.removeChild(liNode);\n\n            }\n\n            // cleanup\n            if (listNode.childNodes.length === 0) {\n                listNode.parentNode.removeChild(listNode);\n            }\n          }\n        }\n      }\n\n    });\n    return found;\n  },\n\n  getAfterList: function(listNode, liNode) {\n    var nodeName = listNode.nodeName,\n        newList = document.createElement(nodeName);\n\n    while (liNode.nextSibling) {\n      newList.appendChild(liNode.nextSibling);\n    }\n    return newList;\n  }\n\n};;/**\n * Undo Manager for wysihtml5\n * slightly inspired by http://rniwa.com/editing/undomanager.html#the-undomanager-interface\n */\n(function(wysihtml5) {\n  var Z_KEY               = 90,\n      Y_KEY               = 89,\n      BACKSPACE_KEY       = 8,\n      DELETE_KEY          = 46,\n      MAX_HISTORY_ENTRIES = 25,\n      DATA_ATTR_NODE      = \"data-wysihtml5-selection-node\",\n      DATA_ATTR_OFFSET    = \"data-wysihtml5-selection-offset\",\n      UNDO_HTML           = '<span id=\"_wysihtml5-undo\" class=\"_wysihtml5-temp\">' + wysihtml5.INVISIBLE_SPACE + '</span>',\n      REDO_HTML           = '<span id=\"_wysihtml5-redo\" class=\"_wysihtml5-temp\">' + wysihtml5.INVISIBLE_SPACE + '</span>',\n      dom                 = wysihtml5.dom;\n\n  function cleanTempElements(doc) {\n    var tempElement;\n    while (tempElement = doc.querySelector(\"._wysihtml5-temp\")) {\n      tempElement.parentNode.removeChild(tempElement);\n    }\n  }\n\n  wysihtml5.UndoManager = wysihtml5.lang.Dispatcher.extend(\n    /** @scope wysihtml5.UndoManager.prototype */ {\n    constructor: function(editor) {\n      this.editor = editor;\n      this.composer = editor.composer;\n      this.element = this.composer.element;\n\n      this.position = 0;\n      this.historyStr = [];\n      this.historyDom = [];\n\n      this.transact();\n\n      this._observe();\n    },\n\n    _observe: function() {\n      var that      = this,\n          doc       = this.composer.sandbox.getDocument(),\n          lastKey;\n\n      // Catch CTRL+Z and CTRL+Y\n      dom.observe(this.element, \"keydown\", function(event) {\n        if (event.altKey || (!event.ctrlKey && !event.metaKey)) {\n          return;\n        }\n\n        var keyCode = event.keyCode,\n            isUndo = keyCode === Z_KEY && !event.shiftKey,\n            isRedo = (keyCode === Z_KEY && event.shiftKey) || (keyCode === Y_KEY);\n\n        if (isUndo) {\n          that.undo();\n          event.preventDefault();\n        } else if (isRedo) {\n          that.redo();\n          event.preventDefault();\n        }\n      });\n\n      // Catch delete and backspace\n      dom.observe(this.element, \"keydown\", function(event) {\n        var keyCode = event.keyCode;\n        if (keyCode === lastKey) {\n          return;\n        }\n\n        lastKey = keyCode;\n\n        if (keyCode === BACKSPACE_KEY || keyCode === DELETE_KEY) {\n          that.transact();\n        }\n      });\n\n      this.editor\n        .on(\"newword:composer\", function() {\n          that.transact();\n        })\n\n        .on(\"beforecommand:composer\", function() {\n          that.transact();\n        });\n    },\n\n    transact: function() {\n      var previousHtml      = this.historyStr[this.position - 1],\n          currentHtml       = this.composer.getValue(false, false),\n          composerIsVisible   = this.element.offsetWidth > 0 && this.element.offsetHeight > 0,\n          range, node, offset, element, position;\n\n      if (currentHtml === previousHtml) {\n        return;\n      }\n\n      var length = this.historyStr.length = this.historyDom.length = this.position;\n      if (length > MAX_HISTORY_ENTRIES) {\n        this.historyStr.shift();\n        this.historyDom.shift();\n        this.position--;\n      }\n\n      this.position++;\n\n      if (composerIsVisible) {\n        // Do not start saving selection if composer is not visible\n        range   = this.composer.selection.getRange();\n        node    = (range && range.startContainer) ? range.startContainer : this.element;\n        offset  = (range && range.startOffset) ? range.startOffset : 0;\n\n        if (node.nodeType === wysihtml5.ELEMENT_NODE) {\n          element = node;\n        } else {\n          element  = node.parentNode;\n          position = this.getChildNodeIndex(element, node);\n        }\n\n        element.setAttribute(DATA_ATTR_OFFSET, offset);\n        if (typeof(position) !== \"undefined\") {\n          element.setAttribute(DATA_ATTR_NODE, position);\n        }\n      }\n\n      var clone = this.element.cloneNode(!!currentHtml);\n      this.historyDom.push(clone);\n      this.historyStr.push(currentHtml);\n\n      if (element) {\n        element.removeAttribute(DATA_ATTR_OFFSET);\n        element.removeAttribute(DATA_ATTR_NODE);\n      }\n\n    },\n\n    undo: function() {\n      this.transact();\n\n      if (!this.undoPossible()) {\n        return;\n      }\n\n      this.set(this.historyDom[--this.position - 1]);\n      this.editor.fire(\"undo:composer\");\n    },\n\n    redo: function() {\n      if (!this.redoPossible()) {\n        return;\n      }\n\n      this.set(this.historyDom[++this.position - 1]);\n      this.editor.fire(\"redo:composer\");\n    },\n\n    undoPossible: function() {\n      return this.position > 1;\n    },\n\n    redoPossible: function() {\n      return this.position < this.historyStr.length;\n    },\n\n    set: function(historyEntry) {\n      this.element.innerHTML = \"\";\n\n      var i = 0,\n          childNodes = historyEntry.childNodes,\n          length = historyEntry.childNodes.length;\n\n      for (; i<length; i++) {\n        this.element.appendChild(childNodes[i].cloneNode(true));\n      }\n\n      // Restore selection\n      var offset,\n          node,\n          position;\n\n      if (historyEntry.hasAttribute(DATA_ATTR_OFFSET)) {\n        offset    = historyEntry.getAttribute(DATA_ATTR_OFFSET);\n        position  = historyEntry.getAttribute(DATA_ATTR_NODE);\n        node      = this.element;\n      } else {\n        node      = this.element.querySelector(\"[\" + DATA_ATTR_OFFSET + \"]\") || this.element;\n        offset    = node.getAttribute(DATA_ATTR_OFFSET);\n        position  = node.getAttribute(DATA_ATTR_NODE);\n        node.removeAttribute(DATA_ATTR_OFFSET);\n        node.removeAttribute(DATA_ATTR_NODE);\n      }\n\n      if (position !== null) {\n        node = this.getChildNodeByIndex(node, +position);\n      }\n\n      this.composer.selection.set(node, offset);\n    },\n\n    getChildNodeIndex: function(parent, child) {\n      var i           = 0,\n          childNodes  = parent.childNodes,\n          length      = childNodes.length;\n      for (; i<length; i++) {\n        if (childNodes[i] === child) {\n          return i;\n        }\n      }\n    },\n\n    getChildNodeByIndex: function(parent, index) {\n      return parent.childNodes[index];\n    }\n  });\n})(wysihtml5);\n;/**\n * TODO: the following methods still need unit test coverage\n */\nwysihtml5.views.View = Base.extend(\n  /** @scope wysihtml5.views.View.prototype */ {\n  constructor: function(parent, textareaElement, config) {\n    this.parent   = parent;\n    this.element  = textareaElement;\n    this.config   = config;\n    if (!this.config.noTextarea) {\n        this._observeViewChange();\n    }\n  },\n\n  _observeViewChange: function() {\n    var that = this;\n    this.parent.on(\"beforeload\", function() {\n      that.parent.on(\"change_view\", function(view) {\n        if (view === that.name) {\n          that.parent.currentView = that;\n          that.show();\n          // Using tiny delay here to make sure that the placeholder is set before focusing\n          setTimeout(function() { that.focus(); }, 0);\n        } else {\n          that.hide();\n        }\n      });\n    });\n  },\n\n  focus: function() {\n    if (this.element.ownerDocument.querySelector(\":focus\") === this.element) {\n      return;\n    }\n\n    try { this.element.focus(); } catch(e) {}\n  },\n\n  hide: function() {\n    this.element.style.display = \"none\";\n  },\n\n  show: function() {\n    this.element.style.display = \"\";\n  },\n\n  disable: function() {\n    this.element.setAttribute(\"disabled\", \"disabled\");\n  },\n\n  enable: function() {\n    this.element.removeAttribute(\"disabled\");\n  }\n});\n;(function(wysihtml5) {\n  var dom       = wysihtml5.dom,\n      browser   = wysihtml5.browser;\n\n  wysihtml5.views.Composer = wysihtml5.views.View.extend(\n    /** @scope wysihtml5.views.Composer.prototype */ {\n    name: \"composer\",\n\n    // Needed for firefox in order to display a proper caret in an empty contentEditable\n    CARET_HACK: \"<br>\",\n\n    constructor: function(parent, editableElement, config) {\n      this.base(parent, editableElement, config);\n      if (!this.config.noTextarea) {\n          this.textarea = this.parent.textarea;\n      } else {\n          this.editableArea = editableElement;\n      }\n      if (this.config.contentEditableMode) {\n          this._initContentEditableArea();\n      } else {\n          this._initSandbox();\n      }\n    },\n\n    clear: function() {\n      this.element.innerHTML = browser.displaysCaretInEmptyContentEditableCorrectly() ? \"\" : this.CARET_HACK;\n    },\n\n    getValue: function(parse, clearInternals) {\n      var value = this.isEmpty() ? \"\" : wysihtml5.quirks.getCorrectInnerHTML(this.element);\n      if (parse !== false) {\n        value = this.parent.parse(value, (clearInternals === false) ? false : true);\n      }\n\n      return value;\n    },\n\n    setValue: function(html, parse) {\n      if (parse) {\n        html = this.parent.parse(html);\n      }\n\n      try {\n        this.element.innerHTML = html;\n      } catch (e) {\n        this.element.innerText = html;\n      }\n    },\n\n    cleanUp: function() {\n        this.parent.parse(this.element);\n    },\n\n    show: function() {\n      this.editableArea.style.display = this._displayStyle || \"\";\n\n      if (!this.config.noTextarea && !this.textarea.element.disabled) {\n        // Firefox needs this, otherwise contentEditable becomes uneditable\n        this.disable();\n        this.enable();\n      }\n    },\n\n    hide: function() {\n      this._displayStyle = dom.getStyle(\"display\").from(this.editableArea);\n      if (this._displayStyle === \"none\") {\n        this._displayStyle = null;\n      }\n      this.editableArea.style.display = \"none\";\n    },\n\n    disable: function() {\n      this.parent.fire(\"disable:composer\");\n      this.element.removeAttribute(\"contentEditable\");\n    },\n\n    enable: function() {\n      this.parent.fire(\"enable:composer\");\n      this.element.setAttribute(\"contentEditable\", \"true\");\n    },\n\n    focus: function(setToEnd) {\n      // IE 8 fires the focus event after .focus()\n      // This is needed by our simulate_placeholder.js to work\n      // therefore we clear it ourselves this time\n      if (wysihtml5.browser.doesAsyncFocus() && this.hasPlaceholderSet()) {\n        this.clear();\n      }\n\n      this.base();\n\n      var lastChild = this.element.lastChild;\n      if (setToEnd && lastChild && this.selection) {\n        if (lastChild.nodeName === \"BR\") {\n          this.selection.setBefore(this.element.lastChild);\n        } else {\n          this.selection.setAfter(this.element.lastChild);\n        }\n      }\n    },\n\n    getTextContent: function() {\n      return dom.getTextContent(this.element);\n    },\n\n    hasPlaceholderSet: function() {\n      return this.getTextContent() == ((this.config.noTextarea) ? this.editableArea.getAttribute(\"data-placeholder\") : this.textarea.element.getAttribute(\"placeholder\")) && this.placeholderSet;\n    },\n\n    isEmpty: function() {\n      var innerHTML = this.element.innerHTML.toLowerCase();\n      return (/^(\\s|<br>|<\\/br>|<p>|<\\/p>)*$/i).test(innerHTML)  ||\n             innerHTML === \"\"            ||\n             innerHTML === \"<br>\"        ||\n             innerHTML === \"<p></p>\"     ||\n             innerHTML === \"<p><br></p>\" ||\n             this.hasPlaceholderSet();\n    },\n\n    _initContentEditableArea: function() {\n        var that = this;\n\n        if (this.config.noTextarea) {\n            this.sandbox = new dom.ContentEditableArea(function() {\n                that._create();\n            }, {}, this.editableArea);\n        } else {\n            this.sandbox = new dom.ContentEditableArea(function() {\n                that._create();\n            });\n            this.editableArea = this.sandbox.getContentEditable();\n            dom.insert(this.editableArea).after(this.textarea.element);\n            this._createWysiwygFormField();\n        }\n    },\n\n    _initSandbox: function() {\n      var that = this;\n\n      this.sandbox = new dom.Sandbox(function() {\n        that._create();\n      }, {\n        stylesheets:  this.config.stylesheets\n      });\n      this.editableArea  = this.sandbox.getIframe();\n\n      var textareaElement = this.textarea.element;\n      dom.insert(this.editableArea).after(textareaElement);\n\n      this._createWysiwygFormField();\n    },\n\n    // Creates hidden field which tells the server after submit, that the user used an wysiwyg editor\n    _createWysiwygFormField: function() {\n        if (this.textarea.element.form) {\n          var hiddenField = document.createElement(\"input\");\n          hiddenField.type   = \"hidden\";\n          hiddenField.name   = \"_wysihtml5_mode\";\n          hiddenField.value  = 1;\n          dom.insert(hiddenField).after(this.textarea.element);\n        }\n    },\n\n    _create: function() {\n      var that = this;\n      this.doc                = this.sandbox.getDocument();\n      this.element            = (this.config.contentEditableMode) ? this.sandbox.getContentEditable() : this.doc.body;\n      if (!this.config.noTextarea) {\n          this.textarea           = this.parent.textarea;\n          this.element.innerHTML  = this.textarea.getValue(true, false);\n      } else {\n          this.cleanUp(); // cleans contenteditable on initiation as it may contain html\n      }\n\n      // Make sure our selection handler is ready\n      this.selection = new wysihtml5.Selection(this.parent, this.element, this.config.uneditableContainerClassname);\n\n      // Make sure commands dispatcher is ready\n      this.commands  = new wysihtml5.Commands(this.parent);\n\n      if (!this.config.noTextarea) {\n          dom.copyAttributes([\n              \"className\", \"spellcheck\", \"title\", \"lang\", \"dir\", \"accessKey\"\n          ]).from(this.textarea.element).to(this.element);\n      }\n\n      dom.addClass(this.element, this.config.composerClassName);\n      //\n      // Make the editor look like the original textarea, by syncing styles\n      if (this.config.style && !this.config.contentEditableMode) {\n        this.style();\n      }\n\n      this.observe();\n\n      var name = this.config.name;\n      if (name) {\n        dom.addClass(this.element, name);\n        if (!this.config.contentEditableMode) { dom.addClass(this.editableArea, name); }\n      }\n\n      this.enable();\n\n      if (!this.config.noTextarea && this.textarea.element.disabled) {\n        this.disable();\n      }\n\n      // Simulate html5 placeholder attribute on contentEditable element\n      var placeholderText = typeof(this.config.placeholder) === \"string\"\n        ? this.config.placeholder\n        : ((this.config.noTextarea) ? this.editableArea.getAttribute(\"data-placeholder\") : this.textarea.element.getAttribute(\"placeholder\"));\n      if (placeholderText) {\n        dom.simulatePlaceholder(this.parent, this, placeholderText);\n      }\n\n      // Make sure that the browser avoids using inline styles whenever possible\n      this.commands.exec(\"styleWithCSS\", false);\n\n      this._initAutoLinking();\n      this._initObjectResizing();\n      this._initUndoManager();\n      this._initLineBreaking();\n\n      // Simulate html5 autofocus on contentEditable element\n      // This doesn't work on IOS (5.1.1)\n      if (!this.config.noTextarea && (this.textarea.element.hasAttribute(\"autofocus\") || document.querySelector(\":focus\") == this.textarea.element) && !browser.isIos()) {\n        setTimeout(function() { that.focus(true); }, 100);\n      }\n\n      // IE sometimes leaves a single paragraph, which can't be removed by the user\n      if (!browser.clearsContentEditableCorrectly()) {\n        wysihtml5.quirks.ensureProperClearing(this);\n      }\n\n      // Set up a sync that makes sure that textarea and editor have the same content\n      if (this.initSync && this.config.sync) {\n        this.initSync();\n      }\n\n      // Okay hide the textarea, we are ready to go\n      if (!this.config.noTextarea) { this.textarea.hide(); }\n\n      // Fire global (before-)load event\n      this.parent.fire(\"beforeload\").fire(\"load\");\n    },\n\n    _initAutoLinking: function() {\n      var that                           = this,\n          supportsDisablingOfAutoLinking = browser.canDisableAutoLinking(),\n          supportsAutoLinking            = browser.doesAutoLinkingInContentEditable();\n      if (supportsDisablingOfAutoLinking) {\n        this.commands.exec(\"autoUrlDetect\", false);\n      }\n\n      if (!this.config.autoLink) {\n        return;\n      }\n\n      // Only do the auto linking by ourselves when the browser doesn't support auto linking\n      // OR when he supports auto linking but we were able to turn it off (IE9+)\n      if (!supportsAutoLinking || (supportsAutoLinking && supportsDisablingOfAutoLinking)) {\n        this.parent.on(\"newword:composer\", function() {\n          if (dom.getTextContent(that.element).match(dom.autoLink.URL_REG_EXP)) {\n            that.selection.executeAndRestore(function(startContainer, endContainer) {\n              var uneditables = that.element.querySelectorAll(\".\" + that.config.uneditableContainerClassname),\n                  isInUneditable = false;\n\n              for (var i = uneditables.length; i--;) {\n                if (wysihtml5.dom.contains(uneditables[i], endContainer)) {\n                  isInUneditable = true;\n                }\n              }\n\n              if (!isInUneditable) dom.autoLink(endContainer.parentNode, [that.config.uneditableContainerClassname]);\n            });\n          }\n        });\n\n        dom.observe(this.element, \"blur\", function() {\n          dom.autoLink(that.element, [that.config.uneditableContainerClassname]);\n        });\n      }\n\n      // Assuming we have the following:\n      //  <a href=\"http://www.google.de\">http://www.google.de</a>\n      // If a user now changes the url in the innerHTML we want to make sure that\n      // it's synchronized with the href attribute (as long as the innerHTML is still a url)\n      var // Use a live NodeList to check whether there are any links in the document\n          links           = this.sandbox.getDocument().getElementsByTagName(\"a\"),\n          // The autoLink helper method reveals a reg exp to detect correct urls\n          urlRegExp       = dom.autoLink.URL_REG_EXP,\n          getTextContent  = function(element) {\n            var textContent = wysihtml5.lang.string(dom.getTextContent(element)).trim();\n            if (textContent.substr(0, 4) === \"www.\") {\n              textContent = \"http://\" + textContent;\n            }\n            return textContent;\n          };\n\n      dom.observe(this.element, \"keydown\", function(event) {\n        if (!links.length) {\n          return;\n        }\n\n        var selectedNode = that.selection.getSelectedNode(event.target.ownerDocument),\n            link         = dom.getParentElement(selectedNode, { nodeName: \"A\" }, 4),\n            textContent;\n\n        if (!link) {\n          return;\n        }\n\n        textContent = getTextContent(link);\n        // keydown is fired before the actual content is changed\n        // therefore we set a timeout to change the href\n        setTimeout(function() {\n          var newTextContent = getTextContent(link);\n          if (newTextContent === textContent) {\n            return;\n          }\n\n          // Only set href when new href looks like a valid url\n          if (newTextContent.match(urlRegExp)) {\n            link.setAttribute(\"href\", newTextContent);\n          }\n        }, 0);\n      });\n    },\n\n    _initObjectResizing: function() {\n      this.commands.exec(\"enableObjectResizing\", true);\n\n      // IE sets inline styles after resizing objects\n      // The following lines make sure that the width/height css properties\n      // are copied over to the width/height attributes\n      if (browser.supportsEvent(\"resizeend\")) {\n        var properties        = [\"width\", \"height\"],\n            propertiesLength  = properties.length,\n            element           = this.element;\n\n        dom.observe(element, \"resizeend\", function(event) {\n          var target = event.target || event.srcElement,\n              style  = target.style,\n              i      = 0,\n              property;\n\n          if (target.nodeName !== \"IMG\") {\n            return;\n          }\n\n          for (; i<propertiesLength; i++) {\n            property = properties[i];\n            if (style[property]) {\n              target.setAttribute(property, parseInt(style[property], 10));\n              style[property] = \"\";\n            }\n          }\n\n          // After resizing IE sometimes forgets to remove the old resize handles\n          wysihtml5.quirks.redraw(element);\n        });\n      }\n    },\n\n    _initUndoManager: function() {\n      this.undoManager = new wysihtml5.UndoManager(this.parent);\n    },\n\n    _initLineBreaking: function() {\n      var that                              = this,\n          USE_NATIVE_LINE_BREAK_INSIDE_TAGS = [\"LI\", \"P\", \"H1\", \"H2\", \"H3\", \"H4\", \"H5\", \"H6\"],\n          LIST_TAGS                         = [\"UL\", \"OL\", \"MENU\"];\n\n      function adjust(selectedNode) {\n        var parentElement = dom.getParentElement(selectedNode, { nodeName: [\"P\", \"DIV\"] }, 2);\n        if (parentElement && dom.contains(that.element, parentElement)) {\n          that.selection.executeAndRestore(function() {\n            if (that.config.useLineBreaks) {\n              dom.replaceWithChildNodes(parentElement);\n            } else if (parentElement.nodeName !== \"P\") {\n              dom.renameElement(parentElement, \"p\");\n            }\n          });\n        }\n      }\n\n      if (!this.config.useLineBreaks) {\n        dom.observe(this.element, [\"focus\", \"keydown\"], function() {\n          if (that.isEmpty()) {\n            var paragraph = that.doc.createElement(\"P\");\n            that.element.innerHTML = \"\";\n            that.element.appendChild(paragraph);\n            if (!browser.displaysCaretInEmptyContentEditableCorrectly()) {\n              paragraph.innerHTML = \"<br>\";\n              that.selection.setBefore(paragraph.firstChild);\n            } else {\n              that.selection.selectNode(paragraph, true);\n            }\n          }\n        });\n      }\n\n      // Under certain circumstances Chrome + Safari create nested <p> or <hX> tags after paste\n      // Inserting an invisible white space in front of it fixes the issue\n      // This is too hacky and causes selection not to replace content on paste in chrome\n     /* if (browser.createsNestedInvalidMarkupAfterPaste()) {\n        dom.observe(this.element, \"paste\", function(event) {\n          var invisibleSpace = that.doc.createTextNode(wysihtml5.INVISIBLE_SPACE);\n          that.selection.insertNode(invisibleSpace);\n        });\n      }*/\n\n\n      dom.observe(this.element, \"keydown\", function(event) {\n        var keyCode = event.keyCode;\n\n        if (event.shiftKey) {\n          return;\n        }\n\n        if (keyCode !== wysihtml5.ENTER_KEY && keyCode !== wysihtml5.BACKSPACE_KEY) {\n          return;\n        }\n        var blockElement = dom.getParentElement(that.selection.getSelectedNode(), { nodeName: USE_NATIVE_LINE_BREAK_INSIDE_TAGS }, 4);\n        if (blockElement) {\n          setTimeout(function() {\n            // Unwrap paragraph after leaving a list or a H1-6\n            var selectedNode = that.selection.getSelectedNode(),\n                list;\n\n            if (blockElement.nodeName === \"LI\") {\n              if (!selectedNode) {\n                return;\n              }\n\n              list = dom.getParentElement(selectedNode, { nodeName: LIST_TAGS }, 2);\n\n              if (!list) {\n                adjust(selectedNode);\n              }\n            }\n\n            if (keyCode === wysihtml5.ENTER_KEY && blockElement.nodeName.match(/^H[1-6]$/)) {\n              adjust(selectedNode);\n            }\n          }, 0);\n          return;\n        }\n\n        if (that.config.useLineBreaks && keyCode === wysihtml5.ENTER_KEY && !wysihtml5.browser.insertsLineBreaksOnReturn()) {\n          event.preventDefault();\n          that.commands.exec(\"insertLineBreak\");\n\n        }\n      });\n    }\n  });\n})(wysihtml5);\n;(function(wysihtml5) {\n  var dom             = wysihtml5.dom,\n      doc             = document,\n      win             = window,\n      HOST_TEMPLATE   = doc.createElement(\"div\"),\n      /**\n       * Styles to copy from textarea to the composer element\n       */\n      TEXT_FORMATTING = [\n        \"background-color\",\n        \"color\", \"cursor\",\n        \"font-family\", \"font-size\", \"font-style\", \"font-variant\", \"font-weight\",\n        \"line-height\", \"letter-spacing\",\n        \"text-align\", \"text-decoration\", \"text-indent\", \"text-rendering\",\n        \"word-break\", \"word-wrap\", \"word-spacing\"\n      ],\n      /**\n       * Styles to copy from textarea to the iframe\n       */\n      BOX_FORMATTING = [\n        \"background-color\",\n        \"border-collapse\",\n        \"border-bottom-color\", \"border-bottom-style\", \"border-bottom-width\",\n        \"border-left-color\", \"border-left-style\", \"border-left-width\",\n        \"border-right-color\", \"border-right-style\", \"border-right-width\",\n        \"border-top-color\", \"border-top-style\", \"border-top-width\",\n        \"clear\", \"display\", \"float\",\n        \"margin-bottom\", \"margin-left\", \"margin-right\", \"margin-top\",\n        \"outline-color\", \"outline-offset\", \"outline-width\", \"outline-style\",\n        \"padding-left\", \"padding-right\", \"padding-top\", \"padding-bottom\",\n        \"position\", \"top\", \"left\", \"right\", \"bottom\", \"z-index\",\n        \"vertical-align\", \"text-align\",\n        \"-webkit-box-sizing\", \"-moz-box-sizing\", \"-ms-box-sizing\", \"box-sizing\",\n        \"-webkit-box-shadow\", \"-moz-box-shadow\", \"-ms-box-shadow\",\"box-shadow\",\n        \"-webkit-border-top-right-radius\", \"-moz-border-radius-topright\", \"border-top-right-radius\",\n        \"-webkit-border-bottom-right-radius\", \"-moz-border-radius-bottomright\", \"border-bottom-right-radius\",\n        \"-webkit-border-bottom-left-radius\", \"-moz-border-radius-bottomleft\", \"border-bottom-left-radius\",\n        \"-webkit-border-top-left-radius\", \"-moz-border-radius-topleft\", \"border-top-left-radius\",\n        \"width\", \"height\"\n      ],\n      ADDITIONAL_CSS_RULES = [\n        \"html                 { height: 100%; }\",\n        \"body                 { height: 100%; padding: 1px 0 0 0; margin: -1px 0 0 0; }\",\n        \"body > p:first-child { margin-top: 0; }\",\n        \"._wysihtml5-temp     { display: none; }\",\n        wysihtml5.browser.isGecko ?\n          \"body.placeholder { color: graytext !important; }\" :\n          \"body.placeholder { color: #a9a9a9 !important; }\",\n        // Ensure that user see's broken images and can delete them\n        \"img:-moz-broken      { -moz-force-broken-image-icon: 1; height: 24px; width: 24px; }\"\n      ];\n\n  /**\n   * With \"setActive\" IE offers a smart way of focusing elements without scrolling them into view:\n   * http://msdn.microsoft.com/en-us/library/ms536738(v=vs.85).aspx\n   *\n   * Other browsers need a more hacky way: (pssst don't tell my mama)\n   * In order to prevent the element being scrolled into view when focusing it, we simply\n   * move it out of the scrollable area, focus it, and reset it's position\n   */\n  var focusWithoutScrolling = function(element) {\n    if (element.setActive) {\n      // Following line could cause a js error when the textarea is invisible\n      // See https://github.com/xing/wysihtml5/issues/9\n      try { element.setActive(); } catch(e) {}\n    } else {\n      var elementStyle = element.style,\n          originalScrollTop = doc.documentElement.scrollTop || doc.body.scrollTop,\n          originalScrollLeft = doc.documentElement.scrollLeft || doc.body.scrollLeft,\n          originalStyles = {\n            position:         elementStyle.position,\n            top:              elementStyle.top,\n            left:             elementStyle.left,\n            WebkitUserSelect: elementStyle.WebkitUserSelect\n          };\n\n      dom.setStyles({\n        position:         \"absolute\",\n        top:              \"-99999px\",\n        left:             \"-99999px\",\n        // Don't ask why but temporarily setting -webkit-user-select to none makes the whole thing performing smoother\n        WebkitUserSelect: \"none\"\n      }).on(element);\n\n      element.focus();\n\n      dom.setStyles(originalStyles).on(element);\n\n      if (win.scrollTo) {\n        // Some browser extensions unset this method to prevent annoyances\n        // \"Better PopUp Blocker\" for Chrome http://code.google.com/p/betterpopupblocker/source/browse/trunk/blockStart.js#100\n        // Issue: http://code.google.com/p/betterpopupblocker/issues/detail?id=1\n        win.scrollTo(originalScrollLeft, originalScrollTop);\n      }\n    }\n  };\n\n\n  wysihtml5.views.Composer.prototype.style = function() {\n    var that                  = this,\n        originalActiveElement = doc.querySelector(\":focus\"),\n        textareaElement       = this.textarea.element,\n        hasPlaceholder        = textareaElement.hasAttribute(\"placeholder\"),\n        originalPlaceholder   = hasPlaceholder && textareaElement.getAttribute(\"placeholder\"),\n        originalDisplayValue  = textareaElement.style.display,\n        originalDisabled      = textareaElement.disabled,\n        displayValueForCopying;\n\n    this.focusStylesHost      = HOST_TEMPLATE.cloneNode(false);\n    this.blurStylesHost       = HOST_TEMPLATE.cloneNode(false);\n    this.disabledStylesHost   = HOST_TEMPLATE.cloneNode(false);\n\n    // Remove placeholder before copying (as the placeholder has an affect on the computed style)\n    if (hasPlaceholder) {\n      textareaElement.removeAttribute(\"placeholder\");\n    }\n\n    if (textareaElement === originalActiveElement) {\n      textareaElement.blur();\n    }\n\n    // enable for copying styles\n    textareaElement.disabled = false;\n\n    // set textarea to display=\"none\" to get cascaded styles via getComputedStyle\n    textareaElement.style.display = displayValueForCopying = \"none\";\n\n    if ((textareaElement.getAttribute(\"rows\") && dom.getStyle(\"height\").from(textareaElement) === \"auto\") ||\n        (textareaElement.getAttribute(\"cols\") && dom.getStyle(\"width\").from(textareaElement) === \"auto\")) {\n      textareaElement.style.display = displayValueForCopying = originalDisplayValue;\n    }\n\n    // --------- iframe styles (has to be set before editor styles, otherwise IE9 sets wrong fontFamily on blurStylesHost) ---------\n    dom.copyStyles(BOX_FORMATTING).from(textareaElement).to(this.editableArea).andTo(this.blurStylesHost);\n\n    // --------- editor styles ---------\n    dom.copyStyles(TEXT_FORMATTING).from(textareaElement).to(this.element).andTo(this.blurStylesHost);\n\n    // --------- apply standard rules ---------\n    dom.insertCSS(ADDITIONAL_CSS_RULES).into(this.element.ownerDocument);\n\n    // --------- :disabled styles ---------\n    textareaElement.disabled = true;\n    dom.copyStyles(BOX_FORMATTING).from(textareaElement).to(this.disabledStylesHost);\n    dom.copyStyles(TEXT_FORMATTING).from(textareaElement).to(this.disabledStylesHost);\n    textareaElement.disabled = originalDisabled;\n\n    // --------- :focus styles ---------\n    textareaElement.style.display = originalDisplayValue;\n    focusWithoutScrolling(textareaElement);\n    textareaElement.style.display = displayValueForCopying;\n\n    dom.copyStyles(BOX_FORMATTING).from(textareaElement).to(this.focusStylesHost);\n    dom.copyStyles(TEXT_FORMATTING).from(textareaElement).to(this.focusStylesHost);\n\n    // reset textarea\n    textareaElement.style.display = originalDisplayValue;\n\n    dom.copyStyles([\"display\"]).from(textareaElement).to(this.editableArea);\n\n    // Make sure that we don't change the display style of the iframe when copying styles oblur/onfocus\n    // this is needed for when the change_view event is fired where the iframe is hidden and then\n    // the blur event fires and re-displays it\n    var boxFormattingStyles = wysihtml5.lang.array(BOX_FORMATTING).without([\"display\"]);\n\n    // --------- restore focus ---------\n    if (originalActiveElement) {\n      originalActiveElement.focus();\n    } else {\n      textareaElement.blur();\n    }\n\n    // --------- restore placeholder ---------\n    if (hasPlaceholder) {\n      textareaElement.setAttribute(\"placeholder\", originalPlaceholder);\n    }\n\n    // --------- Sync focus/blur styles ---------\n    this.parent.on(\"focus:composer\", function() {\n      dom.copyStyles(boxFormattingStyles) .from(that.focusStylesHost).to(that.editableArea);\n      dom.copyStyles(TEXT_FORMATTING)     .from(that.focusStylesHost).to(that.element);\n    });\n\n    this.parent.on(\"blur:composer\", function() {\n      dom.copyStyles(boxFormattingStyles) .from(that.blurStylesHost).to(that.editableArea);\n      dom.copyStyles(TEXT_FORMATTING)     .from(that.blurStylesHost).to(that.element);\n    });\n\n    this.parent.observe(\"disable:composer\", function() {\n      dom.copyStyles(boxFormattingStyles) .from(that.disabledStylesHost).to(that.editableArea);\n      dom.copyStyles(TEXT_FORMATTING)     .from(that.disabledStylesHost).to(that.element);\n    });\n\n    this.parent.observe(\"enable:composer\", function() {\n      dom.copyStyles(boxFormattingStyles) .from(that.blurStylesHost).to(that.editableArea);\n      dom.copyStyles(TEXT_FORMATTING)     .from(that.blurStylesHost).to(that.element);\n    });\n\n    return this;\n  };\n})(wysihtml5);\n;/**\n * Taking care of events\n *  - Simulating 'change' event on contentEditable element\n *  - Handling drag & drop logic\n *  - Catch paste events\n *  - Dispatch proprietary newword:composer event\n *  - Keyboard shortcuts\n */\n(function(wysihtml5) {\n  var dom       = wysihtml5.dom,\n      browser   = wysihtml5.browser,\n      /**\n       * Map keyCodes to query commands\n       */\n      shortcuts = {\n        \"66\": \"bold\",     // B\n        \"73\": \"italic\",   // I\n        \"85\": \"underline\" // U\n      };\n\n  var deleteAroundEditable = function(selection, uneditable, element) {\n    // merge node with previous node from uneditable\n    var prevNode = selection.getPreviousNode(uneditable, true),\n        curNode = selection.getSelectedNode();\n\n    if (curNode.nodeType !== 1 && curNode.parentNode !== element) { curNode = curNode.parentNode; }\n    if (prevNode) {\n      if (curNode.nodeType == 1) {\n        var first = curNode.firstChild;\n\n        if (prevNode.nodeType == 1) {\n          while (curNode.firstChild) {\n            prevNode.appendChild(curNode.firstChild);\n          }\n        } else {\n          while (curNode.firstChild) {\n            uneditable.parentNode.insertBefore(curNode.firstChild, uneditable);\n          }\n        }\n        if (curNode.parentNode) {\n          curNode.parentNode.removeChild(curNode);\n        }\n        selection.setBefore(first);\n      } else {\n        if (prevNode.nodeType == 1) {\n          prevNode.appendChild(curNode);\n        } else {\n          uneditable.parentNode.insertBefore(curNode, uneditable);\n        }\n        selection.setBefore(curNode);\n      }\n    }\n  };\n\n  var handleDeleteKeyPress = function(event, selection, element, composer) {\n    if (selection.isCollapsed()) {\n      if (selection.caretIsInTheBeginnig('LI')) {\n        event.preventDefault();\n        composer.commands.exec('outdentList');\n      } else if (selection.caretIsInTheBeginnig()) {\n        event.preventDefault();\n      } else {\n\n        if (selection.caretIsFirstInSelection() &&\n            selection.getPreviousNode() &&\n            selection.getPreviousNode().nodeName &&\n            (/^H\\d$/gi).test(selection.getPreviousNode().nodeName)\n        ) {\n          var prevNode = selection.getPreviousNode();\n          event.preventDefault();\n          if ((/^\\s*$/).test(prevNode.textContent || prevNode.innerText)) {\n            // heading is empty\n            prevNode.parentNode.removeChild(prevNode);\n          } else {\n            var range = prevNode.ownerDocument.createRange();\n            range.selectNodeContents(prevNode);\n            range.collapse(false);\n            selection.setSelection(range);\n          }\n        }\n\n        var beforeUneditable = selection.caretIsBeforeUneditable();\n        // Do a special delete if caret would delete uneditable\n        if (beforeUneditable) {\n          event.preventDefault();\n          deleteAroundEditable(selection, beforeUneditable, element);\n        }\n      }\n    } else {\n      if (selection.containsUneditable()) {\n        event.preventDefault();\n        selection.deleteContents();\n      }\n    }\n  };\n\n  var handleTabKeyDown = function(composer, element) {\n    if (!composer.selection.isCollapsed()) {\n      composer.selection.deleteContents();\n    } else if (composer.selection.caretIsInTheBeginnig('LI')) {\n      if (composer.commands.exec('indentList')) return;\n    }\n\n    // Is &emsp; close enough to tab. Could not find enough counter arguments for now.\n    composer.commands.exec(\"insertHTML\", \"&emsp;\");\n  };\n\n  wysihtml5.views.Composer.prototype.observe = function() {\n    var that                = this,\n        state               = this.getValue(false, false),\n        container           = (this.sandbox.getIframe) ? this.sandbox.getIframe() : this.sandbox.getContentEditable(),\n        element             = this.element,\n        focusBlurElement    = (browser.supportsEventsInIframeCorrectly() || this.sandbox.getContentEditable) ? element : this.sandbox.getWindow(),\n        pasteEvents         = [\"drop\", \"paste\", \"beforepaste\"],\n        interactionEvents   = [\"drop\", \"paste\", \"mouseup\", \"focus\", \"keyup\"];\n\n    // --------- destroy:composer event ---------\n    dom.observe(container, \"DOMNodeRemoved\", function() {\n      clearInterval(domNodeRemovedInterval);\n      that.parent.fire(\"destroy:composer\");\n    });\n\n    // DOMNodeRemoved event is not supported in IE 8\n    if (!browser.supportsMutationEvents()) {\n        var domNodeRemovedInterval = setInterval(function() {\n          if (!dom.contains(document.documentElement, container)) {\n            clearInterval(domNodeRemovedInterval);\n            that.parent.fire(\"destroy:composer\");\n          }\n        }, 250);\n    }\n\n    // --------- User interaction tracking --\n\n    dom.observe(focusBlurElement, interactionEvents, function() {\n      setTimeout(function() {\n        that.parent.fire(\"interaction\").fire(\"interaction:composer\");\n      }, 0);\n    });\n\n\n    if (this.config.handleTables) {\n      if(!this.tableClickHandle && this.doc.execCommand && wysihtml5.browser.supportsCommand(this.doc, \"enableObjectResizing\") && wysihtml5.browser.supportsCommand(this.doc, \"enableInlineTableEditing\")) {\n        if (this.sandbox.getIframe) {\n          this.tableClickHandle = dom.observe(container , [\"focus\", \"mouseup\", \"mouseover\"], function() {\n            that.doc.execCommand(\"enableObjectResizing\", false, \"false\");\n            that.doc.execCommand(\"enableInlineTableEditing\", false, \"false\");\n            that.tableClickHandle.stop();\n          });\n        } else {\n          setTimeout(function() {\n            that.doc.execCommand(\"enableObjectResizing\", false, \"false\");\n            that.doc.execCommand(\"enableInlineTableEditing\", false, \"false\");\n          }, 0);\n        }\n      }\n      this.tableSelection = wysihtml5.quirks.tableCellsSelection(element, that.parent);\n    }\n\n    // --------- Focus & blur logic ---------\n    dom.observe(focusBlurElement, \"focus\", function(event) {\n      that.parent.fire(\"focus\", event).fire(\"focus:composer\", event);\n\n      // Delay storing of state until all focus handler are fired\n      // especially the one which resets the placeholder\n      setTimeout(function() { state = that.getValue(false, false); }, 0);\n    });\n\n    dom.observe(focusBlurElement, \"blur\", function(event) {\n      if (state !== that.getValue(false, false)) {\n        //create change event if supported (all except IE8)\n        var changeevent = event;\n        if(typeof Object.create == 'function') {\n          changeevent = Object.create(event, { type: { value: 'change' } });\n        }\n        that.parent.fire(\"change\", changeevent).fire(\"change:composer\", changeevent);\n      }\n      that.parent.fire(\"blur\", event).fire(\"blur:composer\", event);\n    });\n\n    // --------- Drag & Drop logic ---------\n    dom.observe(element, \"dragenter\", function() {\n      that.parent.fire(\"unset_placeholder\");\n    });\n\n    dom.observe(element, pasteEvents, function(event) {\n      that.parent.fire(event.type, event).fire(event.type + \":composer\", event);\n    });\n\n\n    if (this.config.copyedFromMarking) {\n      // If supported the copied source is based directly on selection\n      // Very useful for webkit based browsers where copy will otherwise contain a lot of code and styles based on whatever and not actually in selection.\n      dom.observe(element, \"copy\", function(event) {\n        if (event.clipboardData) {\n          event.clipboardData.setData(\"text/html\", that.config.copyedFromMarking + that.selection.getHtml());\n          event.preventDefault();\n        }\n        that.parent.fire(event.type, event).fire(event.type + \":composer\", event);\n      });\n    }\n\n    // --------- neword event ---------\n    dom.observe(element, \"keyup\", function(event) {\n      var keyCode = event.keyCode;\n      if (keyCode === wysihtml5.SPACE_KEY || keyCode === wysihtml5.ENTER_KEY) {\n        that.parent.fire(\"newword:composer\");\n      }\n    });\n\n    this.parent.on(\"paste:composer\", function() {\n      setTimeout(function() { that.parent.fire(\"newword:composer\"); }, 0);\n    });\n\n    // --------- Make sure that images are selected when clicking on them ---------\n    if (!browser.canSelectImagesInContentEditable()) {\n      dom.observe(element, \"mousedown\", function(event) {\n        var target = event.target;\n        var allImages = element.querySelectorAll('img'),\n            notMyImages = element.querySelectorAll('.' + that.config.uneditableContainerClassname + ' img'),\n            myImages = wysihtml5.lang.array(allImages).without(notMyImages);\n\n        if (target.nodeName === \"IMG\" && wysihtml5.lang.array(myImages).contains(target)) {\n          that.selection.selectNode(target);\n        }\n      });\n    }\n\n    if (!browser.canSelectImagesInContentEditable()) {\n        dom.observe(element, \"drop\", function(event) {\n            // TODO: if I knew how to get dropped elements list from event I could limit it to only IMG element case\n            setTimeout(function() {\n                that.selection.getSelection().removeAllRanges();\n            }, 0);\n        });\n    }\n\n    if (browser.hasHistoryIssue() && browser.supportsSelectionModify()) {\n      dom.observe(element, \"keydown\", function(event) {\n        if (!event.metaKey && !event.ctrlKey) {\n          return;\n        }\n\n        var keyCode   = event.keyCode,\n            win       = element.ownerDocument.defaultView,\n            selection = win.getSelection();\n\n        if (keyCode === 37 || keyCode === 39) {\n          if (keyCode === 37) {\n            selection.modify(\"extend\", \"left\", \"lineboundary\");\n            if (!event.shiftKey) {\n              selection.collapseToStart();\n            }\n          }\n          if (keyCode === 39) {\n            selection.modify(\"extend\", \"right\", \"lineboundary\");\n            if (!event.shiftKey) {\n              selection.collapseToEnd();\n            }\n          }\n          event.preventDefault();\n        }\n      });\n    }\n\n    // --------- Shortcut logic ---------\n    dom.observe(element, \"keydown\", function(event) {\n      var keyCode  = event.keyCode,\n          command  = shortcuts[keyCode];\n      if ((event.ctrlKey || event.metaKey) && !event.altKey && command) {\n        that.commands.exec(command);\n        event.preventDefault();\n      }\n      if (keyCode === 8) {\n        // delete key\n        handleDeleteKeyPress(event, that.selection, element, that);\n      } else if (that.config.handleTabKey && keyCode === 9) {\n        event.preventDefault();\n        handleTabKeyDown(that, element);\n      }\n    });\n\n    // --------- Make sure that when pressing backspace/delete on selected images deletes the image and it's anchor ---------\n    dom.observe(element, \"keydown\", function(event) {\n      var target  = that.selection.getSelectedNode(true),\n          keyCode = event.keyCode,\n          parent;\n      if (target && target.nodeName === \"IMG\" && (keyCode === wysihtml5.BACKSPACE_KEY || keyCode === wysihtml5.DELETE_KEY)) { // 8 => backspace, 46 => delete\n        parent = target.parentNode;\n        // delete the <img>\n        parent.removeChild(target);\n        // and it's parent <a> too if it hasn't got any other child nodes\n        if (parent.nodeName === \"A\" && !parent.firstChild) {\n          parent.parentNode.removeChild(parent);\n        }\n\n        setTimeout(function() { wysihtml5.quirks.redraw(element); }, 0);\n        event.preventDefault();\n      }\n    });\n\n    // --------- IE 8+9 focus the editor when the iframe is clicked (without actually firing the 'focus' event on the <body>) ---------\n    if (!this.config.contentEditableMode && browser.hasIframeFocusIssue()) {\n      dom.observe(container, \"focus\", function() {\n        setTimeout(function() {\n          if (that.doc.querySelector(\":focus\") !== that.element) {\n            that.focus();\n          }\n        }, 0);\n      });\n\n      dom.observe(this.element, \"blur\", function() {\n        setTimeout(function() {\n          that.selection.getSelection().removeAllRanges();\n        }, 0);\n      });\n    }\n\n    // --------- Show url in tooltip when hovering links or images ---------\n    var titlePrefixes = {\n      IMG: \"Image: \",\n      A:   \"Link: \"\n    };\n\n    dom.observe(element, \"mouseover\", function(event) {\n      var target   = event.target,\n          nodeName = target.nodeName,\n          title;\n      if (nodeName !== \"A\" && nodeName !== \"IMG\") {\n        return;\n      }\n      var hasTitle = target.hasAttribute(\"title\");\n      if(!hasTitle){\n        title = titlePrefixes[nodeName] + (target.getAttribute(\"href\") || target.getAttribute(\"src\"));\n        target.setAttribute(\"title\", title);\n      }\n    });\n  };\n})(wysihtml5);\n;/**\n * Class that takes care that the value of the composer and the textarea is always in sync\n */\n(function(wysihtml5) {\n  var INTERVAL = 400;\n\n  wysihtml5.views.Synchronizer = Base.extend(\n    /** @scope wysihtml5.views.Synchronizer.prototype */ {\n\n    constructor: function(editor, textarea, composer) {\n      this.editor   = editor;\n      this.textarea = textarea;\n      this.composer = composer;\n\n      this._observe();\n    },\n\n    /**\n     * Sync html from composer to textarea\n     * Takes care of placeholders\n     * @param {Boolean} shouldParseHtml Whether the html should be sanitized before inserting it into the textarea\n     */\n    fromComposerToTextarea: function(shouldParseHtml) {\n      this.textarea.setValue(wysihtml5.lang.string(this.composer.getValue(false, false)).trim(), shouldParseHtml);\n    },\n\n    /**\n     * Sync value of textarea to composer\n     * Takes care of placeholders\n     * @param {Boolean} shouldParseHtml Whether the html should be sanitized before inserting it into the composer\n     */\n    fromTextareaToComposer: function(shouldParseHtml) {\n      var textareaValue = this.textarea.getValue(false, false);\n      if (textareaValue) {\n        this.composer.setValue(textareaValue, shouldParseHtml);\n      } else {\n        this.composer.clear();\n        this.editor.fire(\"set_placeholder\");\n      }\n    },\n\n    /**\n     * Invoke syncing based on view state\n     * @param {Boolean} shouldParseHtml Whether the html should be sanitized before inserting it into the composer/textarea\n     */\n    sync: function(shouldParseHtml) {\n      if (this.editor.currentView.name === \"textarea\") {\n        this.fromTextareaToComposer(shouldParseHtml);\n      } else {\n        this.fromComposerToTextarea(shouldParseHtml);\n      }\n    },\n\n    /**\n     * Initializes interval-based syncing\n     * also makes sure that on-submit the composer's content is synced with the textarea\n     * immediately when the form gets submitted\n     */\n    _observe: function() {\n      var interval,\n          that          = this,\n          form          = this.textarea.element.form,\n          startInterval = function() {\n            interval = setInterval(function() { that.fromComposerToTextarea(); }, INTERVAL);\n          },\n          stopInterval  = function() {\n            clearInterval(interval);\n            interval = null;\n          };\n\n      startInterval();\n\n      if (form) {\n        // If the textarea is in a form make sure that after onreset and onsubmit the composer\n        // has the correct state\n        wysihtml5.dom.observe(form, \"submit\", function() {\n          that.sync(true);\n        });\n        wysihtml5.dom.observe(form, \"reset\", function() {\n          setTimeout(function() { that.fromTextareaToComposer(); }, 0);\n        });\n      }\n\n      this.editor.on(\"change_view\", function(view) {\n        if (view === \"composer\" && !interval) {\n          that.fromTextareaToComposer(true);\n          startInterval();\n        } else if (view === \"textarea\") {\n          that.fromComposerToTextarea(true);\n          stopInterval();\n        }\n      });\n\n      this.editor.on(\"destroy:composer\", stopInterval);\n    }\n  });\n})(wysihtml5);\n;wysihtml5.views.Textarea = wysihtml5.views.View.extend(\n  /** @scope wysihtml5.views.Textarea.prototype */ {\n  name: \"textarea\",\n\n  constructor: function(parent, textareaElement, config) {\n    this.base(parent, textareaElement, config);\n\n    this._observe();\n  },\n\n  clear: function() {\n    this.element.value = \"\";\n  },\n\n  getValue: function(parse) {\n    var value = this.isEmpty() ? \"\" : this.element.value;\n    if (parse !== false) {\n      value = this.parent.parse(value);\n    }\n    return value;\n  },\n\n  setValue: function(html, parse) {\n    if (parse) {\n      html = this.parent.parse(html);\n    }\n    this.element.value = html;\n  },\n\n  cleanUp: function() {\n      var html = this.parent.parse(this.element.value);\n      this.element.value = html;\n  },\n\n  hasPlaceholderSet: function() {\n    var supportsPlaceholder = wysihtml5.browser.supportsPlaceholderAttributeOn(this.element),\n        placeholderText     = this.element.getAttribute(\"placeholder\") || null,\n        value               = this.element.value,\n        isEmpty             = !value;\n    return (supportsPlaceholder && isEmpty) || (value === placeholderText);\n  },\n\n  isEmpty: function() {\n    return !wysihtml5.lang.string(this.element.value).trim() || this.hasPlaceholderSet();\n  },\n\n  _observe: function() {\n    var element = this.element,\n        parent  = this.parent,\n        eventMapping = {\n          focusin:  \"focus\",\n          focusout: \"blur\"\n        },\n        /**\n         * Calling focus() or blur() on an element doesn't synchronously trigger the attached focus/blur events\n         * This is the case for focusin and focusout, so let's use them whenever possible, kkthxbai\n         */\n        events = wysihtml5.browser.supportsEvent(\"focusin\") ? [\"focusin\", \"focusout\", \"change\"] : [\"focus\", \"blur\", \"change\"];\n\n    parent.on(\"beforeload\", function() {\n      wysihtml5.dom.observe(element, events, function(event) {\n        var eventName = eventMapping[event.type] || event.type;\n        parent.fire(eventName).fire(eventName + \":textarea\");\n      });\n\n      wysihtml5.dom.observe(element, [\"paste\", \"drop\"], function() {\n        setTimeout(function() { parent.fire(\"paste\").fire(\"paste:textarea\"); }, 0);\n      });\n    });\n  }\n});\n;/**\n * WYSIHTML5 Editor\n *\n * @param {Element} editableElement Reference to the textarea which should be turned into a rich text interface\n * @param {Object} [config] See defaultConfig object below for explanation of each individual config option\n *\n * @events\n *    load\n *    beforeload (for internal use only)\n *    focus\n *    focus:composer\n *    focus:textarea\n *    blur\n *    blur:composer\n *    blur:textarea\n *    change\n *    change:composer\n *    change:textarea\n *    paste\n *    paste:composer\n *    paste:textarea\n *    newword:composer\n *    destroy:composer\n *    undo:composer\n *    redo:composer\n *    beforecommand:composer\n *    aftercommand:composer\n *    enable:composer\n *    disable:composer\n *    change_view\n */\n(function(wysihtml5) {\n  var undef;\n\n  var defaultConfig = {\n    // Give the editor a name, the name will also be set as class name on the iframe and on the iframe's body\n    name:                 undef,\n    // Whether the editor should look like the textarea (by adopting styles)\n    style:                true,\n    // Id of the toolbar element, pass falsey value if you don't want any toolbar logic\n    toolbar:              undef,\n    // Whether toolbar is displayed after init by script automatically.\n    // Can be set to false if toolobar is set to display only on editable area focus\n    showToolbarAfterInit: true,\n    // Whether urls, entered by the user should automatically become clickable-links\n    autoLink:             true,\n    // Includes table editing events and cell selection tracking\n    handleTables:         true,\n    // Tab key inserts tab into text as default behaviour. It can be disabled to regain keyboard navigation\n    handleTabKey:         true,\n    // Object which includes parser rules to apply when html gets cleaned\n    // See parser_rules/*.js for examples\n    parserRules:          { tags: { br: {}, span: {}, div: {}, p: {} }, classes: {} },\n    // Object which includes parser when the user inserts content via copy & paste. If null parserRules will be used instead\n    pasteParserRulesets: null,\n    // Parser method to use when the user inserts content\n    parser:               wysihtml5.dom.parse,\n    // Class name which should be set on the contentEditable element in the created sandbox iframe, can be styled via the 'stylesheets' option\n    composerClassName:    \"wysihtml5-editor\",\n    // Class name to add to the body when the wysihtml5 editor is supported\n    bodyClassName:        \"wysihtml5-supported\",\n    // By default wysihtml5 will insert a <br> for line breaks, set this to false to use <p>\n    useLineBreaks:        true,\n    // Array (or single string) of stylesheet urls to be loaded in the editor's iframe\n    stylesheets:          [],\n    // Placeholder text to use, defaults to the placeholder attribute on the textarea element\n    placeholderText:      undef,\n    // Whether the rich text editor should be rendered on touch devices (wysihtml5 >= 0.3.0 comes with basic support for iOS 5)\n    supportTouchDevices:  true,\n    // Whether senseless <span> elements (empty or without attributes) should be removed/replaced with their content\n    cleanUp:              true,\n    // Whether to use div instead of secure iframe\n    contentEditableMode: false,\n    // Classname of container that editor should not touch and pass through\n    // Pass false to disable\n    uneditableContainerClassname: \"wysihtml5-uneditable-container\",\n    // Browsers that support copied source handling will get a marking of the origin of the copied source (for determinig code cleanup rules on paste)\n    // Also copied source is based directly on selection - \n    // (very useful for webkit based browsers where copy will otherwise contain a lot of code and styles based on whatever and not actually in selection).\n    // If falsy value is passed source override is also disabled\n    copyedFromMarking: '<meta name=\"copied-from\" content=\"wysihtml5\">'\n  };\n\n  wysihtml5.Editor = wysihtml5.lang.Dispatcher.extend(\n    /** @scope wysihtml5.Editor.prototype */ {\n    constructor: function(editableElement, config) {\n      this.editableElement  = typeof(editableElement) === \"string\" ? document.getElementById(editableElement) : editableElement;\n      this.config           = wysihtml5.lang.object({}).merge(defaultConfig).merge(config).get();\n      this._isCompatible    = wysihtml5.browser.supported();\n\n      if (this.editableElement.nodeName.toLowerCase() != \"textarea\") {\n          this.config.contentEditableMode = true;\n          this.config.noTextarea = true;\n      }\n      if (!this.config.noTextarea) {\n          this.textarea         = new wysihtml5.views.Textarea(this, this.editableElement, this.config);\n          this.currentView      = this.textarea;\n      }\n\n      // Sort out unsupported/unwanted browsers here\n      if (!this._isCompatible || (!this.config.supportTouchDevices && wysihtml5.browser.isTouchDevice())) {\n        var that = this;\n        setTimeout(function() { that.fire(\"beforeload\").fire(\"load\"); }, 0);\n        return;\n      }\n\n      // Add class name to body, to indicate that the editor is supported\n      wysihtml5.dom.addClass(document.body, this.config.bodyClassName);\n\n      this.composer = new wysihtml5.views.Composer(this, this.editableElement, this.config);\n      this.currentView = this.composer;\n\n      if (typeof(this.config.parser) === \"function\") {\n        this._initParser();\n      }\n\n      this.on(\"beforeload\", this.handleBeforeLoad);\n    },\n\n    handleBeforeLoad: function() {\n        if (!this.config.noTextarea) {\n            this.synchronizer = new wysihtml5.views.Synchronizer(this, this.textarea, this.composer);\n        }\n        if (this.config.toolbar) {\n          this.toolbar = new wysihtml5.toolbar.Toolbar(this, this.config.toolbar, this.config.showToolbarAfterInit);\n        }\n    },\n\n    isCompatible: function() {\n      return this._isCompatible;\n    },\n\n    clear: function() {\n      this.currentView.clear();\n      return this;\n    },\n\n    getValue: function(parse, clearInternals) {\n      return this.currentView.getValue(parse, clearInternals);\n    },\n\n    setValue: function(html, parse) {\n      this.fire(\"unset_placeholder\");\n\n      if (!html) {\n        return this.clear();\n      }\n\n      this.currentView.setValue(html, parse);\n      return this;\n    },\n\n    cleanUp: function() {\n        this.currentView.cleanUp();\n    },\n\n    focus: function(setToEnd) {\n      this.currentView.focus(setToEnd);\n      return this;\n    },\n\n    /**\n     * Deactivate editor (make it readonly)\n     */\n    disable: function() {\n      this.currentView.disable();\n      return this;\n    },\n\n    /**\n     * Activate editor\n     */\n    enable: function() {\n      this.currentView.enable();\n      return this;\n    },\n\n    isEmpty: function() {\n      return this.currentView.isEmpty();\n    },\n\n    hasPlaceholderSet: function() {\n      return this.currentView.hasPlaceholderSet();\n    },\n\n    parse: function(htmlOrElement, clearInternals) {\n      var parseContext = (this.config.contentEditableMode) ? document : ((this.composer) ? this.composer.sandbox.getDocument() : null);\n      var returnValue = this.config.parser(htmlOrElement, {\n        \"rules\": this.config.parserRules,\n        \"cleanUp\": this.config.cleanUp,\n        \"context\": parseContext,\n        \"uneditableClass\": this.config.uneditableContainerClassname,\n        \"clearInternals\" : clearInternals\n      });\n      if (typeof(htmlOrElement) === \"object\") {\n        wysihtml5.quirks.redraw(htmlOrElement);\n      }\n      return returnValue;\n    },\n\n    /**\n     * Prepare html parser logic\n     *  - Observes for paste and drop\n     */\n    _initParser: function() {\n      var that = this,\n          oldHtml,\n          cleanHtml;\n\n      if (wysihtml5.browser.supportsModenPaste()) {\n        this.on(\"paste:composer\", function(event) {\n          event.preventDefault();\n          oldHtml = wysihtml5.dom.getPastedHtml(event);\n          if (oldHtml) {\n            that._cleanAndPaste(oldHtml);\n          }\n        });\n\n      } else {\n        this.on(\"beforepaste:composer\", function(event) {\n          event.preventDefault();\n          wysihtml5.dom.getPastedHtmlWithDiv(that.composer, function(pastedHTML) {\n            if (pastedHTML) {\n              that._cleanAndPaste(pastedHTML);\n            }\n          });\n        });\n\n      }\n    },\n\n    _cleanAndPaste: function (oldHtml) {\n      var cleanHtml = wysihtml5.quirks.cleanPastedHTML(oldHtml, {\n        \"referenceNode\": this.composer.element,\n        \"rules\": this.config.pasteParserRulesets || [{\"set\": this.config.parserRules}],\n        \"uneditableClass\": this.config.uneditableContainerClassname\n      });\n      this.composer.selection.deleteContents();\n      this.composer.selection.insertHTML(cleanHtml);\n    }\n  });\n})(wysihtml5);\n;/**\n * Toolbar Dialog\n *\n * @param {Element} link The toolbar link which causes the dialog to show up\n * @param {Element} container The dialog container\n *\n * @example\n *    <!-- Toolbar link -->\n *    <a data-wysihtml5-command=\"insertImage\">insert an image</a>\n *\n *    <!-- Dialog -->\n *    <div data-wysihtml5-dialog=\"insertImage\" style=\"display: none;\">\n *      <label>\n *        URL: <input data-wysihtml5-dialog-field=\"src\" value=\"http://\">\n *      </label>\n *      <label>\n *        Alternative text: <input data-wysihtml5-dialog-field=\"alt\" value=\"\">\n *      </label>\n *    </div>\n *\n *    <script>\n *      var dialog = new wysihtml5.toolbar.Dialog(\n *        document.querySelector(\"[data-wysihtml5-command='insertImage']\"),\n *        document.querySelector(\"[data-wysihtml5-dialog='insertImage']\")\n *      );\n *      dialog.observe(\"save\", function(attributes) {\n *        // do something\n *      });\n *    </script>\n */\n(function(wysihtml5) {\n  var dom                     = wysihtml5.dom,\n      CLASS_NAME_OPENED       = \"wysihtml5-command-dialog-opened\",\n      SELECTOR_FORM_ELEMENTS  = \"input, select, textarea\",\n      SELECTOR_FIELDS         = \"[data-wysihtml5-dialog-field]\",\n      ATTRIBUTE_FIELDS        = \"data-wysihtml5-dialog-field\";\n\n\n  wysihtml5.toolbar.Dialog = wysihtml5.lang.Dispatcher.extend(\n    /** @scope wysihtml5.toolbar.Dialog.prototype */ {\n    constructor: function(link, container) {\n      this.link       = link;\n      this.container  = container;\n    },\n\n    _observe: function() {\n      if (this._observed) {\n        return;\n      }\n\n      var that = this,\n          callbackWrapper = function(event) {\n            var attributes = that._serialize();\n            if (attributes == that.elementToChange) {\n              that.fire(\"edit\", attributes);\n            } else {\n              that.fire(\"save\", attributes);\n            }\n            that.hide();\n            event.preventDefault();\n            event.stopPropagation();\n          };\n\n      dom.observe(that.link, \"click\", function() {\n        if (dom.hasClass(that.link, CLASS_NAME_OPENED)) {\n          setTimeout(function() { that.hide(); }, 0);\n        }\n      });\n\n      dom.observe(this.container, \"keydown\", function(event) {\n        var keyCode = event.keyCode;\n        if (keyCode === wysihtml5.ENTER_KEY) {\n          callbackWrapper(event);\n        }\n        if (keyCode === wysihtml5.ESCAPE_KEY) {\n          that.fire(\"cancel\");\n          that.hide();\n        }\n      });\n\n      dom.delegate(this.container, \"[data-wysihtml5-dialog-action=save]\", \"click\", callbackWrapper);\n\n      dom.delegate(this.container, \"[data-wysihtml5-dialog-action=cancel]\", \"click\", function(event) {\n        that.fire(\"cancel\");\n        that.hide();\n        event.preventDefault();\n        event.stopPropagation();\n      });\n\n      var formElements  = this.container.querySelectorAll(SELECTOR_FORM_ELEMENTS),\n          i             = 0,\n          length        = formElements.length,\n          _clearInterval = function() { clearInterval(that.interval); };\n      for (; i<length; i++) {\n        dom.observe(formElements[i], \"change\", _clearInterval);\n      }\n\n      this._observed = true;\n    },\n\n    /**\n     * Grabs all fields in the dialog and puts them in key=>value style in an object which\n     * then gets returned\n     */\n    _serialize: function() {\n      var data    = this.elementToChange || {},\n          fields  = this.container.querySelectorAll(SELECTOR_FIELDS),\n          length  = fields.length,\n          i       = 0;\n\n      for (; i<length; i++) {\n        data[fields[i].getAttribute(ATTRIBUTE_FIELDS)] = fields[i].value;\n      }\n      return data;\n    },\n\n    /**\n     * Takes the attributes of the \"elementToChange\"\n     * and inserts them in their corresponding dialog input fields\n     *\n     * Assume the \"elementToChange\" looks like this:\n     *    <a href=\"http://www.google.com\" target=\"_blank\">foo</a>\n     *\n     * and we have the following dialog:\n     *    <input type=\"text\" data-wysihtml5-dialog-field=\"href\" value=\"\">\n     *    <input type=\"text\" data-wysihtml5-dialog-field=\"target\" value=\"\">\n     *\n     * after calling _interpolate() the dialog will look like this\n     *    <input type=\"text\" data-wysihtml5-dialog-field=\"href\" value=\"http://www.google.com\">\n     *    <input type=\"text\" data-wysihtml5-dialog-field=\"target\" value=\"_blank\">\n     *\n     * Basically it adopted the attribute values into the corresponding input fields\n     *\n     */\n    _interpolate: function(avoidHiddenFields) {\n      var field,\n          fieldName,\n          newValue,\n          focusedElement = document.querySelector(\":focus\"),\n          fields         = this.container.querySelectorAll(SELECTOR_FIELDS),\n          length         = fields.length,\n          i              = 0;\n      for (; i<length; i++) {\n        field = fields[i];\n\n        // Never change elements where the user is currently typing in\n        if (field === focusedElement) {\n          continue;\n        }\n\n        // Don't update hidden fields\n        // See https://github.com/xing/wysihtml5/pull/14\n        if (avoidHiddenFields && field.type === \"hidden\") {\n          continue;\n        }\n\n        fieldName = field.getAttribute(ATTRIBUTE_FIELDS);\n        newValue  = (this.elementToChange && typeof(this.elementToChange) !== 'boolean') ? (this.elementToChange.getAttribute(fieldName) || \"\") : field.defaultValue;\n        field.value = newValue;\n      }\n    },\n\n    /**\n     * Show the dialog element\n     */\n    show: function(elementToChange) {\n      if (dom.hasClass(this.link, CLASS_NAME_OPENED)) {\n        return;\n      }\n\n      var that        = this,\n          firstField  = this.container.querySelector(SELECTOR_FORM_ELEMENTS);\n      this.elementToChange = elementToChange;\n      this._observe();\n      this._interpolate();\n      if (elementToChange) {\n        this.interval = setInterval(function() { that._interpolate(true); }, 500);\n      }\n      dom.addClass(this.link, CLASS_NAME_OPENED);\n      this.container.style.display = \"\";\n      this.fire(\"show\");\n      if (firstField && !elementToChange) {\n        try {\n          firstField.focus();\n        } catch(e) {}\n      }\n    },\n\n    /**\n     * Hide the dialog element\n     */\n    hide: function() {\n      clearInterval(this.interval);\n      this.elementToChange = null;\n      dom.removeClass(this.link, CLASS_NAME_OPENED);\n      this.container.style.display = \"none\";\n      this.fire(\"hide\");\n    }\n  });\n})(wysihtml5);\n;/**\n * Converts speech-to-text and inserts this into the editor\n * As of now (2011/03/25) this only is supported in Chrome >= 11\n *\n * Note that it sends the recorded audio to the google speech recognition api:\n * http://stackoverflow.com/questions/4361826/does-chrome-have-buil-in-speech-recognition-for-input-type-text-x-webkit-speec\n *\n * Current HTML5 draft can be found here\n * http://lists.w3.org/Archives/Public/public-xg-htmlspeech/2011Feb/att-0020/api-draft.html\n *\n * \"Accessing Google Speech API Chrome 11\"\n * http://mikepultz.com/2011/03/accessing-google-speech-api-chrome-11/\n */\n(function(wysihtml5) {\n  var dom = wysihtml5.dom;\n\n  var linkStyles = {\n    position: \"relative\"\n  };\n\n  var wrapperStyles = {\n    left:     0,\n    margin:   0,\n    opacity:  0,\n    overflow: \"hidden\",\n    padding:  0,\n    position: \"absolute\",\n    top:      0,\n    zIndex:   1\n  };\n\n  var inputStyles = {\n    cursor:     \"inherit\",\n    fontSize:   \"50px\",\n    height:     \"50px\",\n    marginTop:  \"-25px\",\n    outline:    0,\n    padding:    0,\n    position:   \"absolute\",\n    right:      \"-4px\",\n    top:        \"50%\"\n  };\n\n  var inputAttributes = {\n    \"x-webkit-speech\": \"\",\n    \"speech\":          \"\"\n  };\n\n  wysihtml5.toolbar.Speech = function(parent, link) {\n    var input = document.createElement(\"input\");\n    if (!wysihtml5.browser.supportsSpeechApiOn(input)) {\n      link.style.display = \"none\";\n      return;\n    }\n    var lang = parent.editor.textarea.element.getAttribute(\"lang\");\n    if (lang) {\n      inputAttributes.lang = lang;\n    }\n\n    var wrapper = document.createElement(\"div\");\n\n    wysihtml5.lang.object(wrapperStyles).merge({\n      width:  link.offsetWidth  + \"px\",\n      height: link.offsetHeight + \"px\"\n    });\n\n    dom.insert(input).into(wrapper);\n    dom.insert(wrapper).into(link);\n\n    dom.setStyles(inputStyles).on(input);\n    dom.setAttributes(inputAttributes).on(input);\n\n    dom.setStyles(wrapperStyles).on(wrapper);\n    dom.setStyles(linkStyles).on(link);\n\n    var eventName = \"onwebkitspeechchange\" in input ? \"webkitspeechchange\" : \"speechchange\";\n    dom.observe(input, eventName, function() {\n      parent.execCommand(\"insertText\", input.value);\n      input.value = \"\";\n    });\n\n    dom.observe(input, \"click\", function(event) {\n      if (dom.hasClass(link, \"wysihtml5-command-disabled\")) {\n        event.preventDefault();\n      }\n\n      event.stopPropagation();\n    });\n  };\n})(wysihtml5);\n;/**\n * Toolbar\n *\n * @param {Object} parent Reference to instance of Editor instance\n * @param {Element} container Reference to the toolbar container element\n *\n * @example\n *    <div id=\"toolbar\">\n *      <a data-wysihtml5-command=\"createLink\">insert link</a>\n *      <a data-wysihtml5-command=\"formatBlock\" data-wysihtml5-command-value=\"h1\">insert h1</a>\n *    </div>\n *\n *    <script>\n *      var toolbar = new wysihtml5.toolbar.Toolbar(editor, document.getElementById(\"toolbar\"));\n *    </script>\n */\n(function(wysihtml5) {\n  var CLASS_NAME_COMMAND_DISABLED   = \"wysihtml5-command-disabled\",\n      CLASS_NAME_COMMANDS_DISABLED  = \"wysihtml5-commands-disabled\",\n      CLASS_NAME_COMMAND_ACTIVE     = \"wysihtml5-command-active\",\n      CLASS_NAME_ACTION_ACTIVE      = \"wysihtml5-action-active\",\n      dom                           = wysihtml5.dom;\n\n  wysihtml5.toolbar.Toolbar = Base.extend(\n    /** @scope wysihtml5.toolbar.Toolbar.prototype */ {\n    constructor: function(editor, container, showOnInit) {\n      this.editor     = editor;\n      this.container  = typeof(container) === \"string\" ? document.getElementById(container) : container;\n      this.composer   = editor.composer;\n\n      this._getLinks(\"command\");\n      this._getLinks(\"action\");\n\n      this._observe();\n      if (showOnInit) { this.show(); }\n\n      if (editor.config.classNameCommandDisabled != null) {\n        CLASS_NAME_COMMAND_DISABLED = editor.config.classNameCommandDisabled;\n      }\n      if (editor.config.classNameCommandsDisabled != null) {\n        CLASS_NAME_COMMANDS_DISABLED = editor.config.classNameCommandsDisabled;\n      }\n      if (editor.config.classNameCommandActive != null) {\n        CLASS_NAME_COMMAND_ACTIVE = editor.config.classNameCommandActive;\n      }\n      if (editor.config.classNameActionActive != null) {\n        CLASS_NAME_ACTION_ACTIVE = editor.config.classNameActionActive;\n      }\n\n      var speechInputLinks  = this.container.querySelectorAll(\"[data-wysihtml5-command=insertSpeech]\"),\n          length            = speechInputLinks.length,\n          i                 = 0;\n      for (; i<length; i++) {\n        new wysihtml5.toolbar.Speech(this, speechInputLinks[i]);\n      }\n    },\n\n    _getLinks: function(type) {\n      var links   = this[type + \"Links\"] = wysihtml5.lang.array(this.container.querySelectorAll(\"[data-wysihtml5-\" + type + \"]\")).get(),\n          length  = links.length,\n          i       = 0,\n          mapping = this[type + \"Mapping\"] = {},\n          link,\n          group,\n          name,\n          value,\n          dialog;\n      for (; i<length; i++) {\n        link    = links[i];\n        name    = link.getAttribute(\"data-wysihtml5-\" + type);\n        value   = link.getAttribute(\"data-wysihtml5-\" + type + \"-value\");\n        group   = this.container.querySelector(\"[data-wysihtml5-\" + type + \"-group='\" + name + \"']\");\n        dialog  = this._getDialog(link, name);\n\n        mapping[name + \":\" + value] = {\n          link:   link,\n          group:  group,\n          name:   name,\n          value:  value,\n          dialog: dialog,\n          state:  false\n        };\n      }\n    },\n\n    _getDialog: function(link, command) {\n      var that          = this,\n          dialogElement = this.container.querySelector(\"[data-wysihtml5-dialog='\" + command + \"']\"),\n          dialog,\n          caretBookmark;\n\n      if (dialogElement) {\n        if (wysihtml5.toolbar[\"Dialog_\" + command]) {\n            dialog = new wysihtml5.toolbar[\"Dialog_\" + command](link, dialogElement);\n        } else {\n            dialog = new wysihtml5.toolbar.Dialog(link, dialogElement);\n        }\n\n        dialog.on(\"show\", function() {\n          caretBookmark = that.composer.selection.getBookmark();\n\n          that.editor.fire(\"show:dialog\", { command: command, dialogContainer: dialogElement, commandLink: link });\n        });\n\n        dialog.on(\"save\", function(attributes) {\n          if (caretBookmark) {\n            that.composer.selection.setBookmark(caretBookmark);\n          }\n          that._execCommand(command, attributes);\n\n          that.editor.fire(\"save:dialog\", { command: command, dialogContainer: dialogElement, commandLink: link });\n        });\n\n        dialog.on(\"cancel\", function() {\n          that.editor.focus(false);\n          that.editor.fire(\"cancel:dialog\", { command: command, dialogContainer: dialogElement, commandLink: link });\n        });\n      }\n      return dialog;\n    },\n\n    /**\n     * @example\n     *    var toolbar = new wysihtml5.Toolbar();\n     *    // Insert a <blockquote> element or wrap current selection in <blockquote>\n     *    toolbar.execCommand(\"formatBlock\", \"blockquote\");\n     */\n    execCommand: function(command, commandValue) {\n      if (this.commandsDisabled) {\n        return;\n      }\n\n      var commandObj = this.commandMapping[command + \":\" + commandValue];\n\n      // Show dialog when available\n      if (commandObj && commandObj.dialog && !commandObj.state) {\n        commandObj.dialog.show();\n      } else {\n        this._execCommand(command, commandValue);\n      }\n    },\n\n    _execCommand: function(command, commandValue) {\n      // Make sure that composer is focussed (false => don't move caret to the end)\n      this.editor.focus(false);\n\n      this.composer.commands.exec(command, commandValue);\n      this._updateLinkStates();\n    },\n\n    execAction: function(action) {\n      var editor = this.editor;\n      if (action === \"change_view\") {\n        if (editor.textarea) {\n            if (editor.currentView === editor.textarea) {\n              editor.fire(\"change_view\", \"composer\");\n            } else {\n              editor.fire(\"change_view\", \"textarea\");\n            }\n        }\n      }\n      if (action == \"showSource\") {\n          editor.fire(\"showSource\");\n      }\n    },\n\n    _observe: function() {\n      var that      = this,\n          editor    = this.editor,\n          container = this.container,\n          links     = this.commandLinks.concat(this.actionLinks),\n          length    = links.length,\n          i         = 0;\n\n      for (; i<length; i++) {\n        // 'javascript:;' and unselectable=on Needed for IE, but done in all browsers to make sure that all get the same css applied\n        // (you know, a:link { ... } doesn't match anchors with missing href attribute)\n        if (links[i].nodeName === \"A\") {\n          dom.setAttributes({\n            href:         \"javascript:;\",\n            unselectable: \"on\"\n          }).on(links[i]);\n        } else {\n          dom.setAttributes({ unselectable: \"on\" }).on(links[i]);\n        }\n      }\n\n      // Needed for opera and chrome\n      dom.delegate(container, \"[data-wysihtml5-command], [data-wysihtml5-action]\", \"mousedown\", function(event) { event.preventDefault(); });\n\n      dom.delegate(container, \"[data-wysihtml5-command]\", \"click\", function(event) {\n        var link          = this,\n            command       = link.getAttribute(\"data-wysihtml5-command\"),\n            commandValue  = link.getAttribute(\"data-wysihtml5-command-value\");\n        that.execCommand(command, commandValue);\n        event.preventDefault();\n      });\n\n      dom.delegate(container, \"[data-wysihtml5-action]\", \"click\", function(event) {\n        var action = this.getAttribute(\"data-wysihtml5-action\");\n        that.execAction(action);\n        event.preventDefault();\n      });\n\n      editor.on(\"interaction:composer\", function() {\n          that._updateLinkStates();\n      });\n\n      editor.on(\"focus:composer\", function() {\n        that.bookmark = null;\n      });\n\n      if (this.editor.config.handleTables) {\n          editor.on(\"tableselect:composer\", function() {\n              that.container.querySelectorAll('[data-wysihtml5-hiddentools=\"table\"]')[0].style.display = \"\";\n          });\n          editor.on(\"tableunselect:composer\", function() {\n              that.container.querySelectorAll('[data-wysihtml5-hiddentools=\"table\"]')[0].style.display = \"none\";\n          });\n      }\n\n      editor.on(\"change_view\", function(currentView) {\n        // Set timeout needed in order to let the blur event fire first\n        if (editor.textarea) {\n            setTimeout(function() {\n              that.commandsDisabled = (currentView !== \"composer\");\n              that._updateLinkStates();\n              if (that.commandsDisabled) {\n                dom.addClass(container, CLASS_NAME_COMMANDS_DISABLED);\n              } else {\n                dom.removeClass(container, CLASS_NAME_COMMANDS_DISABLED);\n              }\n            }, 0);\n        }\n      });\n    },\n\n    _updateLinkStates: function() {\n\n      var commandMapping    = this.commandMapping,\n          actionMapping     = this.actionMapping,\n          i,\n          state,\n          action,\n          command;\n      // every millisecond counts... this is executed quite often\n      for (i in commandMapping) {\n        command = commandMapping[i];\n        if (this.commandsDisabled) {\n          state = false;\n          dom.removeClass(command.link, CLASS_NAME_COMMAND_ACTIVE);\n          if (command.group) {\n            dom.removeClass(command.group, CLASS_NAME_COMMAND_ACTIVE);\n          }\n          if (command.dialog) {\n            command.dialog.hide();\n          }\n        } else {\n          state = this.composer.commands.state(command.name, command.value);\n          dom.removeClass(command.link, CLASS_NAME_COMMAND_DISABLED);\n          if (command.group) {\n            dom.removeClass(command.group, CLASS_NAME_COMMAND_DISABLED);\n          }\n        }\n        if (command.state === state) {\n          continue;\n        }\n\n        command.state = state;\n        if (state) {\n          dom.addClass(command.link, CLASS_NAME_COMMAND_ACTIVE);\n          if (command.group) {\n            dom.addClass(command.group, CLASS_NAME_COMMAND_ACTIVE);\n          }\n          if (command.dialog) {\n            if (typeof(state) === \"object\" || wysihtml5.lang.object(state).isArray()) {\n\n              if (!command.dialog.multiselect && wysihtml5.lang.object(state).isArray()) {\n                // Grab first and only object/element in state array, otherwise convert state into boolean\n                // to avoid showing a dialog for multiple selected elements which may have different attributes\n                // eg. when two links with different href are selected, the state will be an array consisting of both link elements\n                // but the dialog interface can only update one\n                state = state.length === 1 ? state[0] : true;\n                command.state = state;\n              }\n              command.dialog.show(state);\n            } else {\n              command.dialog.hide();\n            }\n          }\n        } else {\n          dom.removeClass(command.link, CLASS_NAME_COMMAND_ACTIVE);\n          if (command.group) {\n            dom.removeClass(command.group, CLASS_NAME_COMMAND_ACTIVE);\n          }\n          if (command.dialog) {\n            command.dialog.hide();\n          }\n        }\n      }\n\n      for (i in actionMapping) {\n        action = actionMapping[i];\n\n        if (action.name === \"change_view\") {\n          action.state = this.editor.currentView === this.editor.textarea;\n          if (action.state) {\n            dom.addClass(action.link, CLASS_NAME_ACTION_ACTIVE);\n          } else {\n            dom.removeClass(action.link, CLASS_NAME_ACTION_ACTIVE);\n          }\n        }\n      }\n    },\n\n    show: function() {\n      this.container.style.display = \"\";\n    },\n\n    hide: function() {\n      this.container.style.display = \"none\";\n    }\n  });\n\n})(wysihtml5);\n;(function(wysihtml5) {\n    wysihtml5.toolbar.Dialog_createTable = wysihtml5.toolbar.Dialog.extend({\n        show: function(elementToChange) {\n            this.base(elementToChange);\n\n        }\n\n    });\n})(wysihtml5);\n;(function(wysihtml5) {\n  var dom                     = wysihtml5.dom,\n      SELECTOR_FIELDS         = \"[data-wysihtml5-dialog-field]\",\n      ATTRIBUTE_FIELDS        = \"data-wysihtml5-dialog-field\";\n\n  wysihtml5.toolbar.Dialog_foreColorStyle = wysihtml5.toolbar.Dialog.extend({\n    multiselect: true,\n\n    _serialize: function() {\n      var data    = {},\n          fields  = this.container.querySelectorAll(SELECTOR_FIELDS),\n          length  = fields.length,\n          i       = 0;\n\n      for (; i<length; i++) {\n        data[fields[i].getAttribute(ATTRIBUTE_FIELDS)] = fields[i].value;\n      }\n      return data;\n    },\n\n    _interpolate: function(avoidHiddenFields) {\n      var field,\n          fieldName,\n          newValue,\n          focusedElement = document.querySelector(\":focus\"),\n          fields         = this.container.querySelectorAll(SELECTOR_FIELDS),\n          length         = fields.length,\n          i              = 0,\n          firstElement   = (this.elementToChange) ? ((wysihtml5.lang.object(this.elementToChange).isArray()) ? this.elementToChange[0] : this.elementToChange) : null,\n          colorStr       = (firstElement) ? firstElement.getAttribute('style') : null,\n          color          = (colorStr) ? wysihtml5.quirks.styleParser.parseColor(colorStr, \"color\") : null;\n\n      for (; i<length; i++) {\n        field = fields[i];\n        // Never change elements where the user is currently typing in\n        if (field === focusedElement) {\n          continue;\n        }\n        // Don't update hidden fields3\n        if (avoidHiddenFields && field.type === \"hidden\") {\n          continue;\n        }\n        if (field.getAttribute(ATTRIBUTE_FIELDS) === \"color\") {\n          if (color) {\n            if (color[3] && color[3] != 1) {\n              field.value = \"rgba(\" + color[0] + \",\" + color[1] + \",\" + color[2] + \",\" + color[3] + \");\";\n            } else {\n              field.value = \"rgb(\" + color[0] + \",\" + color[1] + \",\" + color[2] + \");\";\n            }\n          } else {\n            field.value = \"rgb(0,0,0);\";\n          }\n        }\n      }\n    }\n\n  });\n})(wysihtml5);\n;(function(wysihtml5) {\n  var dom                     = wysihtml5.dom,\n      SELECTOR_FIELDS         = \"[data-wysihtml5-dialog-field]\",\n      ATTRIBUTE_FIELDS        = \"data-wysihtml5-dialog-field\";\n\n  wysihtml5.toolbar.Dialog_fontSizeStyle = wysihtml5.toolbar.Dialog.extend({\n    multiselect: true,\n\n    _serialize: function() {\n      return {\"size\" : this.container.querySelector('[data-wysihtml5-dialog-field=\"size\"]').value};\n    },\n\n    _interpolate: function(avoidHiddenFields) {\n      var focusedElement = document.querySelector(\":focus\"),\n          field          = this.container.querySelector(\"[data-wysihtml5-dialog-field='size']\"),\n          firstElement   = (this.elementToChange) ? ((wysihtml5.lang.object(this.elementToChange).isArray()) ? this.elementToChange[0] : this.elementToChange) : null,\n          styleStr       = (firstElement) ? firstElement.getAttribute('style') : null,\n          size           = (styleStr) ? wysihtml5.quirks.styleParser.parseFontSize(styleStr) : null;\n\n      if (field && field !== focusedElement && size && !(/^\\s*$/).test(size)) {\n        field.value = size;\n      }\n    }\n\n  });\n})(wysihtml5);\n/*!\n\n handlebars v1.3.0\n\nCopyright (C) 2011 by Yehuda Katz\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n\n@license\n*/\nvar Handlebars=function(){var a=function(){\"use strict\";function a(a){this.string=a}var b;return a.prototype.toString=function(){return\"\"+this.string},b=a}(),b=function(a){\"use strict\";function b(a){return h[a]||\"&amp;\"}function c(a,b){for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])}function d(a){return a instanceof g?a.toString():a||0===a?(a=\"\"+a,j.test(a)?a.replace(i,b):a):\"\"}function e(a){return a||0===a?m(a)&&0===a.length?!0:!1:!0}var f={},g=a,h={\"&\":\"&amp;\",\"<\":\"&lt;\",\">\":\"&gt;\",'\"':\"&quot;\",\"'\":\"&#x27;\",\"`\":\"&#x60;\"},i=/[&<>\"'`]/g,j=/[&<>\"'`]/;f.extend=c;var k=Object.prototype.toString;f.toString=k;var l=function(a){return\"function\"==typeof a};l(/x/)&&(l=function(a){return\"function\"==typeof a&&\"[object Function]\"===k.call(a)});var l;f.isFunction=l;var m=Array.isArray||function(a){return a&&\"object\"==typeof a?\"[object Array]\"===k.call(a):!1};return f.isArray=m,f.escapeExpression=d,f.isEmpty=e,f}(a),c=function(){\"use strict\";function a(a,b){var d;b&&b.firstLine&&(d=b.firstLine,a+=\" - \"+d+\":\"+b.firstColumn);for(var e=Error.prototype.constructor.call(this,a),f=0;f<c.length;f++)this[c[f]]=e[c[f]];d&&(this.lineNumber=d,this.column=b.firstColumn)}var b,c=[\"description\",\"fileName\",\"lineNumber\",\"message\",\"name\",\"number\",\"stack\"];return a.prototype=new Error,b=a}(),d=function(a,b){\"use strict\";function c(a,b){this.helpers=a||{},this.partials=b||{},d(this)}function d(a){a.registerHelper(\"helperMissing\",function(a){if(2===arguments.length)return void 0;throw new h(\"Missing helper: '\"+a+\"'\")}),a.registerHelper(\"blockHelperMissing\",function(b,c){var d=c.inverse||function(){},e=c.fn;return m(b)&&(b=b.call(this)),b===!0?e(this):b===!1||null==b?d(this):l(b)?b.length>0?a.helpers.each(b,c):d(this):e(b)}),a.registerHelper(\"each\",function(a,b){var c,d=b.fn,e=b.inverse,f=0,g=\"\";if(m(a)&&(a=a.call(this)),b.data&&(c=q(b.data)),a&&\"object\"==typeof a)if(l(a))for(var h=a.length;h>f;f++)c&&(c.index=f,c.first=0===f,c.last=f===a.length-1),g+=d(a[f],{data:c});else for(var i in a)a.hasOwnProperty(i)&&(c&&(c.key=i,c.index=f,c.first=0===f),g+=d(a[i],{data:c}),f++);return 0===f&&(g=e(this)),g}),a.registerHelper(\"if\",function(a,b){return m(a)&&(a=a.call(this)),!b.hash.includeZero&&!a||g.isEmpty(a)?b.inverse(this):b.fn(this)}),a.registerHelper(\"unless\",function(b,c){return a.helpers[\"if\"].call(this,b,{fn:c.inverse,inverse:c.fn,hash:c.hash})}),a.registerHelper(\"with\",function(a,b){return m(a)&&(a=a.call(this)),g.isEmpty(a)?void 0:b.fn(a)}),a.registerHelper(\"log\",function(b,c){var d=c.data&&null!=c.data.level?parseInt(c.data.level,10):1;a.log(d,b)})}function e(a,b){p.log(a,b)}var f={},g=a,h=b,i=\"1.3.0\";f.VERSION=i;var j=4;f.COMPILER_REVISION=j;var k={1:\"<= 1.0.rc.2\",2:\"== 1.0.0-rc.3\",3:\"== 1.0.0-rc.4\",4:\">= 1.0.0\"};f.REVISION_CHANGES=k;var l=g.isArray,m=g.isFunction,n=g.toString,o=\"[object Object]\";f.HandlebarsEnvironment=c,c.prototype={constructor:c,logger:p,log:e,registerHelper:function(a,b,c){if(n.call(a)===o){if(c||b)throw new h(\"Arg not supported with multiple helpers\");g.extend(this.helpers,a)}else c&&(b.not=c),this.helpers[a]=b},registerPartial:function(a,b){n.call(a)===o?g.extend(this.partials,a):this.partials[a]=b}};var p={methodMap:{0:\"debug\",1:\"info\",2:\"warn\",3:\"error\"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(a,b){if(p.level<=a){var c=p.methodMap[a];\"undefined\"!=typeof console&&console[c]&&console[c].call(console,b)}}};f.logger=p,f.log=e;var q=function(a){var b={};return g.extend(b,a),b};return f.createFrame=q,f}(b,c),e=function(a,b,c){\"use strict\";function d(a){var b=a&&a[0]||1,c=m;if(b!==c){if(c>b){var d=n[c],e=n[b];throw new l(\"Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version (\"+d+\") or downgrade your runtime to an older version (\"+e+\").\")}throw new l(\"Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version (\"+a[1]+\").\")}}function e(a,b){if(!b)throw new l(\"No environment passed to template\");var c=function(a,c,d,e,f,g){var h=b.VM.invokePartial.apply(this,arguments);if(null!=h)return h;if(b.compile){var i={helpers:e,partials:f,data:g};return f[c]=b.compile(a,{data:void 0!==g},b),f[c](d,i)}throw new l(\"The partial \"+c+\" could not be compiled when running in runtime-only mode\")},d={escapeExpression:k.escapeExpression,invokePartial:c,programs:[],program:function(a,b,c){var d=this.programs[a];return c?d=g(a,b,c):d||(d=this.programs[a]=g(a,b)),d},merge:function(a,b){var c=a||b;return a&&b&&a!==b&&(c={},k.extend(c,b),k.extend(c,a)),c},programWithDepth:b.VM.programWithDepth,noop:b.VM.noop,compilerInfo:null};return function(c,e){e=e||{};var f,g,h=e.partial?e:b;e.partial||(f=e.helpers,g=e.partials);var i=a.call(d,h,c,f,g,e.data);return e.partial||b.VM.checkRevision(d.compilerInfo),i}}function f(a,b,c){var d=Array.prototype.slice.call(arguments,3),e=function(a,e){return e=e||{},b.apply(this,[a,e.data||c].concat(d))};return e.program=a,e.depth=d.length,e}function g(a,b,c){var d=function(a,d){return d=d||{},b(a,d.data||c)};return d.program=a,d.depth=0,d}function h(a,b,c,d,e,f){var g={partial:!0,helpers:d,partials:e,data:f};if(void 0===a)throw new l(\"The partial \"+b+\" could not be found\");return a instanceof Function?a(c,g):void 0}function i(){return\"\"}var j={},k=a,l=b,m=c.COMPILER_REVISION,n=c.REVISION_CHANGES;return j.checkRevision=d,j.template=e,j.programWithDepth=f,j.program=g,j.invokePartial=h,j.noop=i,j}(b,c,d),f=function(a,b,c,d,e){\"use strict\";var f,g=a,h=b,i=c,j=d,k=e,l=function(){var a=new g.HandlebarsEnvironment;return j.extend(a,g),a.SafeString=h,a.Exception=i,a.Utils=j,a.VM=k,a.template=function(b){return k.template(b,a)},a},m=l();return m.create=l,f=m}(d,a,c,b,e);return f}();this[\"wysihtml5\"] = this[\"wysihtml5\"] || {};\nthis[\"wysihtml5\"][\"tpl\"] = this[\"wysihtml5\"][\"tpl\"] || {};\n\nthis[\"wysihtml5\"][\"tpl\"][\"blockquote\"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"btn-\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.options)),stack1 == null || stack1 === false ? stack1 : stack1.toolbar)),stack1 == null || stack1 === false ? stack1 : stack1.size)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1));\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  \n  return \" \\n      <span class=\\\"fa fa-quote-left\\\"></span>\\n    \";\n  }\n\nfunction program5(depth0,data) {\n  \n  \n  return \"\\n      <span class=\\\"glyphicon glyphicon-quote\\\"></span>\\n    \";\n  }\n\n  buffer += \"<li>\\n  <a class=\\\"btn \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = ((stack1 = (depth0 && depth0.options)),stack1 == null || stack1 === false ? stack1 : stack1.toolbar)),stack1 == null || stack1 === false ? stack1 : stack1.size), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" btn-default\\\" data-wysihtml5-command=\\\"formatBlock\\\" data-wysihtml5-command-value=\\\"blockquote\\\" data-wysihtml5-display-format-name=\\\"false\\\" tabindex=\\\"-1\\\">\\n    \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = ((stack1 = (depth0 && depth0.options)),stack1 == null || stack1 === false ? stack1 : stack1.toolbar)),stack1 == null || stack1 === false ? stack1 : stack1.fa), {hash:{},inverse:self.program(5, program5, data),fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n  </a>\\n</li>\\n\";\n  return buffer;\n  });\n\nthis[\"wysihtml5\"][\"tpl\"][\"color\"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"btn-\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.options)),stack1 == null || stack1 === false ? stack1 : stack1.toolbar)),stack1 == null || stack1 === false ? stack1 : stack1.size)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1));\n  return buffer;\n  }\n\n  buffer += \"<li class=\\\"dropdown\\\">\\n  <a class=\\\"btn btn-default dropdown-toggle \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = ((stack1 = (depth0 && depth0.options)),stack1 == null || stack1 === false ? stack1 : stack1.toolbar)),stack1 == null || stack1 === false ? stack1 : stack1.size), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\" data-toggle=\\\"dropdown\\\" tabindex=\\\"-1\\\">\\n    <span class=\\\"current-color\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.colours)),stack1 == null || stack1 === false ? stack1 : stack1.black)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</span>\\n    <b class=\\\"caret\\\"></b>\\n  </a>\\n  <ul class=\\\"dropdown-menu\\\">\\n    <li><div class=\\\"wysihtml5-colors\\\" data-wysihtml5-command-value=\\\"black\\\"></div><a class=\\\"wysihtml5-colors-title\\\" data-wysihtml5-command=\\\"foreColor\\\" data-wysihtml5-command-value=\\\"black\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.colours)),stack1 == null || stack1 === false ? stack1 : stack1.black)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</a></li>\\n    <li><div class=\\\"wysihtml5-colors\\\" data-wysihtml5-command-value=\\\"silver\\\"></div><a class=\\\"wysihtml5-colors-title\\\" data-wysihtml5-command=\\\"foreColor\\\" data-wysihtml5-command-value=\\\"silver\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.colours)),stack1 == null || stack1 === false ? stack1 : stack1.silver)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</a></li>\\n    <li><div class=\\\"wysihtml5-colors\\\" data-wysihtml5-command-value=\\\"gray\\\"></div><a class=\\\"wysihtml5-colors-title\\\" data-wysihtml5-command=\\\"foreColor\\\" data-wysihtml5-command-value=\\\"gray\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.colours)),stack1 == null || stack1 === false ? stack1 : stack1.gray)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</a></li>\\n    <li><div class=\\\"wysihtml5-colors\\\" data-wysihtml5-command-value=\\\"maroon\\\"></div><a class=\\\"wysihtml5-colors-title\\\" data-wysihtml5-command=\\\"foreColor\\\" data-wysihtml5-command-value=\\\"maroon\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.colours)),stack1 == null || stack1 === false ? stack1 : stack1.maroon)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</a></li>\\n    <li><div class=\\\"wysihtml5-colors\\\" data-wysihtml5-command-value=\\\"red\\\"></div><a class=\\\"wysihtml5-colors-title\\\" data-wysihtml5-command=\\\"foreColor\\\" data-wysihtml5-command-value=\\\"red\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.colours)),stack1 == null || stack1 === false ? stack1 : stack1.red)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</a></li>\\n    <li><div class=\\\"wysihtml5-colors\\\" data-wysihtml5-command-value=\\\"purple\\\"></div><a class=\\\"wysihtml5-colors-title\\\" data-wysihtml5-command=\\\"foreColor\\\" data-wysihtml5-command-value=\\\"purple\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.colours)),stack1 == null || stack1 === false ? stack1 : stack1.purple)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</a></li>\\n    <li><div class=\\\"wysihtml5-colors\\\" data-wysihtml5-command-value=\\\"green\\\"></div><a class=\\\"wysihtml5-colors-title\\\" data-wysihtml5-command=\\\"foreColor\\\" data-wysihtml5-command-value=\\\"green\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.colours)),stack1 == null || stack1 === false ? stack1 : stack1.green)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</a></li>\\n    <li><div class=\\\"wysihtml5-colors\\\" data-wysihtml5-command-value=\\\"olive\\\"></div><a class=\\\"wysihtml5-colors-title\\\" data-wysihtml5-command=\\\"foreColor\\\" data-wysihtml5-command-value=\\\"olive\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.colours)),stack1 == null || stack1 === false ? stack1 : stack1.olive)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</a></li>\\n    <li><div class=\\\"wysihtml5-colors\\\" data-wysihtml5-command-value=\\\"navy\\\"></div><a class=\\\"wysihtml5-colors-title\\\" data-wysihtml5-command=\\\"foreColor\\\" data-wysihtml5-command-value=\\\"navy\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.colours)),stack1 == null || stack1 === false ? stack1 : stack1.navy)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</a></li>\\n    <li><div class=\\\"wysihtml5-colors\\\" data-wysihtml5-command-value=\\\"blue\\\"></div><a class=\\\"wysihtml5-colors-title\\\" data-wysihtml5-command=\\\"foreColor\\\" data-wysihtml5-command-value=\\\"blue\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.colours)),stack1 == null || stack1 === false ? stack1 : stack1.blue)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</a></li>\\n    <li><div class=\\\"wysihtml5-colors\\\" data-wysihtml5-command-value=\\\"orange\\\"></div><a class=\\\"wysihtml5-colors-title\\\" data-wysihtml5-command=\\\"foreColor\\\" data-wysihtml5-command-value=\\\"orange\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.colours)),stack1 == null || stack1 === false ? stack1 : stack1.orange)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</a></li>\\n  </ul>\\n</li>\\n\";\n  return buffer;\n  });\n\nthis[\"wysihtml5\"][\"tpl\"][\"emphasis\"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"btn-\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.options)),stack1 == null || stack1 === false ? stack1 : stack1.toolbar)),stack1 == null || stack1 === false ? stack1 : stack1.size)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1));\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"\\n    <a class=\\\"btn \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = ((stack1 = (depth0 && depth0.options)),stack1 == null || stack1 === false ? stack1 : stack1.toolbar)),stack1 == null || stack1 === false ? stack1 : stack1.size), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" btn-default\\\" data-wysihtml5-command=\\\"small\\\" title=\\\"CTRL+S\\\" tabindex=\\\"-1\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.emphasis)),stack1 == null || stack1 === false ? stack1 : stack1.small)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</a>\\n    \";\n  return buffer;\n  }\n\n  buffer += \"<li>\\n  <div class=\\\"btn-group\\\">\\n    <a class=\\\"btn \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = ((stack1 = (depth0 && depth0.options)),stack1 == null || stack1 === false ? stack1 : stack1.toolbar)),stack1 == null || stack1 === false ? stack1 : stack1.size), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" btn-default\\\" data-wysihtml5-command=\\\"bold\\\" title=\\\"CTRL+B\\\" tabindex=\\\"-1\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.emphasis)),stack1 == null || stack1 === false ? stack1 : stack1.bold)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</a>\\n    <a class=\\\"btn \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = ((stack1 = (depth0 && depth0.options)),stack1 == null || stack1 === false ? stack1 : stack1.toolbar)),stack1 == null || stack1 === false ? stack1 : stack1.size), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" btn-default\\\" data-wysihtml5-command=\\\"italic\\\" title=\\\"CTRL+I\\\" tabindex=\\\"-1\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.emphasis)),stack1 == null || stack1 === false ? stack1 : stack1.italic)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</a>\\n    <a class=\\\"btn \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = ((stack1 = (depth0 && depth0.options)),stack1 == null || stack1 === false ? stack1 : stack1.toolbar)),stack1 == null || stack1 === false ? stack1 : stack1.size), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" btn-default\\\" data-wysihtml5-command=\\\"underline\\\" title=\\\"CTRL+U\\\" tabindex=\\\"-1\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.emphasis)),stack1 == null || stack1 === false ? stack1 : stack1.underline)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</a>\\n    \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.options)),stack1 == null || stack1 === false ? stack1 : stack1.toolbar)),stack1 == null || stack1 === false ? stack1 : stack1.emphasis)),stack1 == null || stack1 === false ? stack1 : stack1.small), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n  </div>\\n</li>\\n\";\n  return buffer;\n  });\n\nthis[\"wysihtml5\"][\"tpl\"][\"font-styles\"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"btn-\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.options)),stack1 == null || stack1 === false ? stack1 : stack1.toolbar)),stack1 == null || stack1 === false ? stack1 : stack1.size)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1));\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  \n  return \"\\n      <span class=\\\"fa fa-font\\\"></span>\\n    \";\n  }\n\nfunction program5(depth0,data) {\n  \n  \n  return \"\\n      <span class=\\\"glyphicon glyphicon-font\\\"></span>\\n    \";\n  }\n\n  buffer += \"<li class=\\\"dropdown\\\">\\n  <a class=\\\"btn btn-default dropdown-toggle \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = ((stack1 = (depth0 && depth0.options)),stack1 == null || stack1 === false ? stack1 : stack1.toolbar)),stack1 == null || stack1 === false ? stack1 : stack1.size), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\" data-toggle=\\\"dropdown\\\">\\n    \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = ((stack1 = (depth0 && depth0.options)),stack1 == null || stack1 === false ? stack1 : stack1.toolbar)),stack1 == null || stack1 === false ? stack1 : stack1.fa), {hash:{},inverse:self.program(5, program5, data),fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n    <span class=\\\"current-font\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.font_styles)),stack1 == null || stack1 === false ? stack1 : stack1.normal)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</span>\\n    <b class=\\\"caret\\\"></b>\\n  </a>\\n  <ul class=\\\"dropdown-menu\\\">\\n    <li><a data-wysihtml5-command=\\\"formatBlock\\\" data-wysihtml5-command-value=\\\"p\\\" tabindex=\\\"-1\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.font_styles)),stack1 == null || stack1 === false ? stack1 : stack1.normal)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</a></li>\\n    <li><a data-wysihtml5-command=\\\"formatBlock\\\" data-wysihtml5-command-value=\\\"h1\\\" tabindex=\\\"-1\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.font_styles)),stack1 == null || stack1 === false ? stack1 : stack1.h1)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</a></li>\\n    <li><a data-wysihtml5-command=\\\"formatBlock\\\" data-wysihtml5-command-value=\\\"h2\\\" tabindex=\\\"-1\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.font_styles)),stack1 == null || stack1 === false ? stack1 : stack1.h2)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</a></li>\\n    <li><a data-wysihtml5-command=\\\"formatBlock\\\" data-wysihtml5-command-value=\\\"h3\\\" tabindex=\\\"-1\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.font_styles)),stack1 == null || stack1 === false ? stack1 : stack1.h3)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</a></li>\\n    <li><a data-wysihtml5-command=\\\"formatBlock\\\" data-wysihtml5-command-value=\\\"h4\\\" tabindex=\\\"-1\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.font_styles)),stack1 == null || stack1 === false ? stack1 : stack1.h4)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</a></li>\\n    <li><a data-wysihtml5-command=\\\"formatBlock\\\" data-wysihtml5-command-value=\\\"h5\\\" tabindex=\\\"-1\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.font_styles)),stack1 == null || stack1 === false ? stack1 : stack1.h5)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</a></li>\\n    <li><a data-wysihtml5-command=\\\"formatBlock\\\" data-wysihtml5-command-value=\\\"h6\\\" tabindex=\\\"-1\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.font_styles)),stack1 == null || stack1 === false ? stack1 : stack1.h6)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</a></li>\\n  </ul>\\n</li>\\n\";\n  return buffer;\n  });\n\nthis[\"wysihtml5\"][\"tpl\"][\"html\"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"btn-\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.options)),stack1 == null || stack1 === false ? stack1 : stack1.toolbar)),stack1 == null || stack1 === false ? stack1 : stack1.size)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1));\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  \n  return \"\\n        <span class=\\\"fa fa-pencil\\\"></span>\\n      \";\n  }\n\nfunction program5(depth0,data) {\n  \n  \n  return \"\\n        <span class=\\\"glyphicon glyphicon-pencil\\\"></span>\\n      \";\n  }\n\n  buffer += \"<li>\\n  <div class=\\\"btn-group\\\">\\n    <a class=\\\"btn \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = ((stack1 = (depth0 && depth0.options)),stack1 == null || stack1 === false ? stack1 : stack1.toolbar)),stack1 == null || stack1 === false ? stack1 : stack1.size), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" btn-default\\\" data-wysihtml5-action=\\\"change_view\\\" title=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.html)),stack1 == null || stack1 === false ? stack1 : stack1.edit)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\" tabindex=\\\"-1\\\">\\n      \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = ((stack1 = (depth0 && depth0.options)),stack1 == null || stack1 === false ? stack1 : stack1.toolbar)),stack1 == null || stack1 === false ? stack1 : stack1.fa), {hash:{},inverse:self.program(5, program5, data),fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n    </a>\\n  </div>\\n</li>\\n\";\n  return buffer;\n  });\n\nthis[\"wysihtml5\"][\"tpl\"][\"image\"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  \n  return \"modal-sm\";\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"btn-\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.options)),stack1 == null || stack1 === false ? stack1 : stack1.toolbar)),stack1 == null || stack1 === false ? stack1 : stack1.size)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1));\n  return buffer;\n  }\n\nfunction program5(depth0,data) {\n  \n  \n  return \"\\n      <span class=\\\"fa fa-file-image-o\\\"></span>\\n    \";\n  }\n\nfunction program7(depth0,data) {\n  \n  \n  return \"\\n      <span class=\\\"glyphicon glyphicon-picture\\\"></span>\\n    \";\n  }\n\n  buffer += \"<li>\\n  <div class=\\\"bootstrap-wysihtml5-insert-image-modal modal fade\\\" data-wysihtml5-dialog=\\\"insertImage\\\">\\n    <div class=\\\"modal-dialog \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = ((stack1 = (depth0 && depth0.options)),stack1 == null || stack1 === false ? stack1 : stack1.toolbar)),stack1 == null || stack1 === false ? stack1 : stack1.smallmodals), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\">\\n      <div class=\\\"modal-content\\\">\\n        <div class=\\\"modal-header\\\">\\n          <a class=\\\"close\\\" data-dismiss=\\\"modal\\\">&times;</a>\\n          <h3>\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.image)),stack1 == null || stack1 === false ? stack1 : stack1.insert)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</h3>\\n        </div>\\n        <div class=\\\"modal-body\\\">\\n          <div class=\\\"form-group\\\">\\n            <input value=\\\"http://\\\" class=\\\"bootstrap-wysihtml5-insert-image-url form-control\\\" data-wysihtml5-dialog-field=\\\"src\\\">\\n          </div> \\n        </div>\\n        <div class=\\\"modal-footer\\\">\\n          <a class=\\\"btn btn-default\\\" data-dismiss=\\\"modal\\\" data-wysihtml5-dialog-action=\\\"cancel\\\" href=\\\"#\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.image)),stack1 == null || stack1 === false ? stack1 : stack1.cancel)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</a>\\n          <a class=\\\"btn btn-primary\\\" data-dismiss=\\\"modal\\\"  data-wysihtml5-dialog-action=\\\"save\\\" href=\\\"#\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.image)),stack1 == null || stack1 === false ? stack1 : stack1.insert)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</a>\\n        </div>\\n      </div>\\n    </div>\\n  </div>\\n  <a class=\\\"btn \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = ((stack1 = (depth0 && depth0.options)),stack1 == null || stack1 === false ? stack1 : stack1.toolbar)),stack1 == null || stack1 === false ? stack1 : stack1.size), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" btn-default\\\" data-wysihtml5-command=\\\"insertImage\\\" title=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.image)),stack1 == null || stack1 === false ? stack1 : stack1.insert)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\" tabindex=\\\"-1\\\">\\n    \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = ((stack1 = (depth0 && depth0.options)),stack1 == null || stack1 === false ? stack1 : stack1.toolbar)),stack1 == null || stack1 === false ? stack1 : stack1.fa), {hash:{},inverse:self.program(7, program7, data),fn:self.program(5, program5, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n  </a>\\n</li>\\n\";\n  return buffer;\n  });\n\nthis[\"wysihtml5\"][\"tpl\"][\"link\"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  \n  return \"modal-sm\";\n  }\n\nfunction program3(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"btn-\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.options)),stack1 == null || stack1 === false ? stack1 : stack1.toolbar)),stack1 == null || stack1 === false ? stack1 : stack1.size)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1));\n  return buffer;\n  }\n\nfunction program5(depth0,data) {\n  \n  \n  return \"\\n      <span class=\\\"fa fa-share-square-o\\\"></span>\\n    \";\n  }\n\nfunction program7(depth0,data) {\n  \n  \n  return \"\\n      <span class=\\\"glyphicon glyphicon-share\\\"></span>\\n    \";\n  }\n\n  buffer += \"<li>\\n  <div class=\\\"bootstrap-wysihtml5-insert-link-modal modal fade\\\" data-wysihtml5-dialog=\\\"createLink\\\">\\n    <div class=\\\"modal-dialog \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = ((stack1 = (depth0 && depth0.options)),stack1 == null || stack1 === false ? stack1 : stack1.toolbar)),stack1 == null || stack1 === false ? stack1 : stack1.smallmodals), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\\">\\n      <div class=\\\"modal-content\\\">\\n        <div class=\\\"modal-header\\\">\\n          <a class=\\\"close\\\" data-dismiss=\\\"modal\\\">&times;</a>\\n          <h3>\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.link)),stack1 == null || stack1 === false ? stack1 : stack1.insert)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</h3>\\n        </div>\\n        <div class=\\\"modal-body\\\">\\n          <div class=\\\"form-group\\\">\\n            <input value=\\\"http://\\\" class=\\\"bootstrap-wysihtml5-insert-link-url form-control\\\" data-wysihtml5-dialog-field=\\\"href\\\">\\n          </div> \\n          <div class=\\\"checkbox\\\">\\n            <label> \\n              <input type=\\\"checkbox\\\" class=\\\"bootstrap-wysihtml5-insert-link-target\\\" checked>\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.link)),stack1 == null || stack1 === false ? stack1 : stack1.target)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\n            </label>\\n          </div>\\n        </div>\\n        <div class=\\\"modal-footer\\\">\\n          <a class=\\\"btn btn-default\\\" data-dismiss=\\\"modal\\\" data-wysihtml5-dialog-action=\\\"cancel\\\" href=\\\"#\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.link)),stack1 == null || stack1 === false ? stack1 : stack1.cancel)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</a>\\n          <a href=\\\"#\\\" class=\\\"btn btn-primary\\\" data-dismiss=\\\"modal\\\" data-wysihtml5-dialog-action=\\\"save\\\">\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.link)),stack1 == null || stack1 === false ? stack1 : stack1.insert)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"</a>\\n        </div>\\n      </div>\\n    </div>\\n  </div>\\n  <a class=\\\"btn \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = ((stack1 = (depth0 && depth0.options)),stack1 == null || stack1 === false ? stack1 : stack1.toolbar)),stack1 == null || stack1 === false ? stack1 : stack1.size), {hash:{},inverse:self.noop,fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" btn-default\\\" data-wysihtml5-command=\\\"createLink\\\" title=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.link)),stack1 == null || stack1 === false ? stack1 : stack1.insert)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\" tabindex=\\\"-1\\\">\\n    \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = ((stack1 = (depth0 && depth0.options)),stack1 == null || stack1 === false ? stack1 : stack1.toolbar)),stack1 == null || stack1 === false ? stack1 : stack1.fa), {hash:{},inverse:self.program(7, program7, data),fn:self.program(5, program5, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n  </a>\\n</li>\\n\";\n  return buffer;\n  });\n\nthis[\"wysihtml5\"][\"tpl\"][\"lists\"] = Handlebars.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1;\n  buffer += \"btn-\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.options)),stack1 == null || stack1 === false ? stack1 : stack1.toolbar)),stack1 == null || stack1 === false ? stack1 : stack1.size)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1));\n  return buffer;\n  }\n\nfunction program3(depth0,data) {\n  \n  \n  return \"\\n      <span class=\\\"fa fa-list-ul\\\"></span>\\n    \";\n  }\n\nfunction program5(depth0,data) {\n  \n  \n  return \"\\n      <span class=\\\"glyphicon glyphicon-list\\\"></span>\\n    \";\n  }\n\nfunction program7(depth0,data) {\n  \n  \n  return \"\\n      <span class=\\\"fa fa-list-ol\\\"></span>\\n    \";\n  }\n\nfunction program9(depth0,data) {\n  \n  \n  return \"\\n      <span class=\\\"glyphicon glyphicon-th-list\\\"></span>\\n    \";\n  }\n\nfunction program11(depth0,data) {\n  \n  \n  return \"\\n      <span class=\\\"fa fa-outdent\\\"></span>\\n    \";\n  }\n\nfunction program13(depth0,data) {\n  \n  \n  return \"\\n      <span class=\\\"glyphicon glyphicon-indent-right\\\"></span>\\n    \";\n  }\n\nfunction program15(depth0,data) {\n  \n  \n  return \"\\n      <span class=\\\"fa fa-indent\\\"></span>\\n    \";\n  }\n\nfunction program17(depth0,data) {\n  \n  \n  return \"\\n      <span class=\\\"glyphicon glyphicon-indent-left\\\"></span>\\n    \";\n  }\n\n  buffer += \"<li>\\n  <div class=\\\"btn-group\\\">\\n    <a class=\\\"btn \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = ((stack1 = (depth0 && depth0.options)),stack1 == null || stack1 === false ? stack1 : stack1.toolbar)),stack1 == null || stack1 === false ? stack1 : stack1.size), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" btn-default\\\" data-wysihtml5-command=\\\"insertUnorderedList\\\" title=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.lists)),stack1 == null || stack1 === false ? stack1 : stack1.unordered)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\" tabindex=\\\"-1\\\">\\n    \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = ((stack1 = (depth0 && depth0.options)),stack1 == null || stack1 === false ? stack1 : stack1.toolbar)),stack1 == null || stack1 === false ? stack1 : stack1.fa), {hash:{},inverse:self.program(5, program5, data),fn:self.program(3, program3, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n    </a>\\n    <a class=\\\"btn \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = ((stack1 = (depth0 && depth0.options)),stack1 == null || stack1 === false ? stack1 : stack1.toolbar)),stack1 == null || stack1 === false ? stack1 : stack1.size), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" btn-default\\\" data-wysihtml5-command=\\\"insertOrderedList\\\" title=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.lists)),stack1 == null || stack1 === false ? stack1 : stack1.ordered)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\" tabindex=\\\"-1\\\">\\n    \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = ((stack1 = (depth0 && depth0.options)),stack1 == null || stack1 === false ? stack1 : stack1.toolbar)),stack1 == null || stack1 === false ? stack1 : stack1.fa), {hash:{},inverse:self.program(9, program9, data),fn:self.program(7, program7, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n    </a>\\n    <a class=\\\"btn \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = ((stack1 = (depth0 && depth0.options)),stack1 == null || stack1 === false ? stack1 : stack1.toolbar)),stack1 == null || stack1 === false ? stack1 : stack1.size), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" btn-default\\\" data-wysihtml5-command=\\\"Outdent\\\" title=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.lists)),stack1 == null || stack1 === false ? stack1 : stack1.outdent)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\" tabindex=\\\"-1\\\">\\n    \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = ((stack1 = (depth0 && depth0.options)),stack1 == null || stack1 === false ? stack1 : stack1.toolbar)),stack1 == null || stack1 === false ? stack1 : stack1.fa), {hash:{},inverse:self.program(13, program13, data),fn:self.program(11, program11, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n    </a>\\n    <a class=\\\"btn \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = ((stack1 = (depth0 && depth0.options)),stack1 == null || stack1 === false ? stack1 : stack1.toolbar)),stack1 == null || stack1 === false ? stack1 : stack1.size), {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \" btn-default\\\" data-wysihtml5-command=\\\"Indent\\\" title=\\\"\"\n    + escapeExpression(((stack1 = ((stack1 = ((stack1 = (depth0 && depth0.locale)),stack1 == null || stack1 === false ? stack1 : stack1.lists)),stack1 == null || stack1 === false ? stack1 : stack1.indent)),typeof stack1 === functionType ? stack1.apply(depth0) : stack1))\n    + \"\\\" tabindex=\\\"-1\\\">\\n    \";\n  stack1 = helpers['if'].call(depth0, ((stack1 = ((stack1 = (depth0 && depth0.options)),stack1 == null || stack1 === false ? stack1 : stack1.toolbar)),stack1 == null || stack1 === false ? stack1 : stack1.fa), {hash:{},inverse:self.program(17, program17, data),fn:self.program(15, program15, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n    </a>\\n  </div>\\n</li>\\n\";\n  return buffer;\n  });(function (factory) {\n  'use strict';\n  if (typeof define === 'function' && define.amd) {\n    // AMD. Register as an anonymous module.\n    define('bootstrap.wysihtml5', ['jquery', 'wysihtml5', 'bootstrap', 'bootstrap.wysihtml5.templates', 'bootstrap.wysihtml5.commands'], factory);\n  } else {\n    // Browser globals\n    factory(jQuery, wysihtml5); // jshint ignore:line\n  }\n}(function ($, wysihtml5) {\n  'use strict';\n  var bsWysihtml5 = function($, wysihtml5) {\n\n    var templates = function(key, locale, options) {\n      if(wysihtml5.tpl[key]) {\n        return wysihtml5.tpl[key]({locale: locale, options: options});\n      }\n    };\n\n    var Wysihtml5 = function(el, options) {\n      this.el = el;\n      var toolbarOpts = $.extend(true, {}, defaultOptions, options);\n      for(var t in toolbarOpts.customTemplates) {\n        if (toolbarOpts.customTemplates.hasOwnProperty(t)) {\n          wysihtml5.tpl[t] = toolbarOpts.customTemplates[t];\n        }\n      }\n      this.toolbar = this.createToolbar(el, toolbarOpts);\n      this.editor =  this.createEditor(toolbarOpts);\n    };\n\n    Wysihtml5.prototype = {\n\n      constructor: Wysihtml5,\n\n      createEditor: function(options) {\n        options = options || {};\n\n        // Add the toolbar to a clone of the options object so multiple instances\n        // of the WYISYWG don't break because 'toolbar' is already defined\n        options = $.extend(true, {}, options);\n        options.toolbar = this.toolbar[0];\n        \n        this.initializeEditor(this.el[0], options);\n      },\n\n\n      initializeEditor: function(el, options) {\n        var editor = new wysihtml5.Editor(this.el[0], options);\n\n        editor.on('beforeload', this.syncBootstrapDialogEvents);\n        editor.on('beforeload', this.loadParserRules);\n\n        // #30 - body is in IE 10 not created by default, which leads to nullpointer\n        // 2014/02/13 - adapted to wysihtml5-0.4, does not work in IE\n        if(editor.composer.editableArea.contentDocument) {\n          this.addMoreShortcuts(editor, \n                                editor.composer.editableArea.contentDocument.body || editor.composer.editableArea.contentDocument, \n                                options.shortcuts);\n        } else {\n          this.addMoreShortcuts(editor, editor.composer.editableArea, options.shortcuts);    \n        }\n\n        if(options && options.events) {\n          for(var eventName in options.events) {\n            if (options.events.hasOwnProperty(eventName)) {\n              editor.on(eventName, options.events[eventName]);\n            }\n          }\n        }\n\n        return editor;\n      },\n\n      loadParserRules: function() {\n        if($.type(this.config.parserRules) === 'string') {\n          $.ajax({\n            dataType: 'json',\n            url: this.config.parserRules,\n            context: this,\n            error: function (jqXHR, textStatus, errorThrown) {\n              console.log(errorThrown);\n            },\n            success: function (parserRules) {\n              this.config.parserRules = parserRules;\n              console.log('parserrules loaded');\n            }\n          });\n        }\n\n        if(this.config.pasteParserRulesets && $.type(this.config.pasteParserRulesets) === 'string') {\n          $.ajax({\n            dataType: 'json',\n            url: this.config.pasteParserRulesets,\n            context: this,\n            error: function (jqXHR, textStatus, errorThrown) {\n              console.log(errorThrown);\n            },\n            success: function (pasteParserRulesets) {\n              this.config.pasteParserRulesets = pasteParserRulesets;\n            }\n          });\n        }\n      },\n\n      //sync wysihtml5 events for dialogs with bootstrap events\n      syncBootstrapDialogEvents: function() {\n        var editor = this;\n        $.map(this.toolbar.commandMapping, function(value) {\n          return [value];\n        }).filter(function(commandObj) {\n          return commandObj.dialog;\n        }).map(function(commandObj) {\n          return commandObj.dialog;\n        }).forEach(function(dialog) {\n          dialog.on('show', function() {\n            $(this.container).modal('show');\n          });\n          dialog.on('hide', function() {\n            $(this.container).modal('hide');\n            setTimeout(editor.composer.focus, 0);\n          });\n          $(dialog.container).on('shown.bs.modal', function () {\n            $(this).find('input, select, textarea').first().focus();\n          });\n        });\n        this.on('change_view', function() {\n          $(this.toolbar.container.children).find('a.btn').not('[data-wysihtml5-action=\"change_view\"]').toggleClass('disabled');\n        });\n      },\n\n      createToolbar: function(el, options) {\n        var self = this;\n        var toolbar = $('<ul/>', {\n          'class' : 'wysihtml5-toolbar',\n          'style': 'display:none'\n        });\n        var culture = options.locale || defaultOptions.locale || 'en';\n        if(!locale.hasOwnProperty(culture)) {\n          console.debug('Locale \\'' + culture + '\\' not found. Available locales are: ' + Object.keys(locale) + '. Falling back to \\'en\\'.');\n          culture = 'en';\n        }\n        var localeObject = $.extend(true, {}, locale.en, locale[culture]);\n        for(var key in options.toolbar) {\n          if(options.toolbar[key]) {\n            toolbar.append(templates(key, localeObject, options));\n          }\n        }\n\n        toolbar.find('a[data-wysihtml5-command=\"formatBlock\"]').click(function(e) {\n          var target = e.delegateTarget || e.target || e.srcElement,\n          el = $(target),\n          showformat = el.data('wysihtml5-display-format-name'),\n          formatname = el.data('wysihtml5-format-name') || el.html();\n          if(showformat === undefined || showformat === 'true') {\n            self.toolbar.find('.current-font').text(formatname);\n          }\n        });\n\n        toolbar.find('a[data-wysihtml5-command=\"foreColor\"]').click(function(e) {\n          var target = e.target || e.srcElement;\n          var el = $(target);\n          self.toolbar.find('.current-color').text(el.html());\n        });\n\n        this.el.before(toolbar);\n\n        return toolbar;\n      },\n\n      addMoreShortcuts: function(editor, el, shortcuts) {\n        /* some additional shortcuts */\n        wysihtml5.dom.observe(el, 'keydown', function(event) {\n          var keyCode  = event.keyCode,\n          command  = shortcuts[keyCode];\n          if ((event.ctrlKey || event.metaKey || event.altKey) && command && wysihtml5.commands[command]) {\n            var commandObj = editor.toolbar.commandMapping[command + ':null'];\n            if (commandObj && commandObj.dialog && !commandObj.state) {\n              commandObj.dialog.show();\n            } else {\n              wysihtml5.commands[command].exec(editor.composer, command);\n            }\n            event.preventDefault();\n          }\n        });\n      }\n    };\n\n    // these define our public api\n    var methods = {\n      resetDefaults: function() {\n        $.fn.wysihtml5.defaultOptions = $.extend(true, {}, $.fn.wysihtml5.defaultOptionsCache);\n      },\n      bypassDefaults: function(options) {\n        return this.each(function () {\n          var $this = $(this);\n          $this.data('wysihtml5', new Wysihtml5($this, options));\n        });\n      },\n      shallowExtend: function (options) {\n        var settings = $.extend({}, $.fn.wysihtml5.defaultOptions, options || {}, $(this).data());\n        var that = this;\n        return methods.bypassDefaults.apply(that, [settings]);\n      },\n      deepExtend: function(options) {\n        var settings = $.extend(true, {}, $.fn.wysihtml5.defaultOptions, options || {});\n        var that = this;\n        return methods.bypassDefaults.apply(that, [settings]);\n      },\n      init: function(options) {\n        var that = this;\n        return methods.shallowExtend.apply(that, [options]);\n      }\n    };\n\n    $.fn.wysihtml5 = function ( method ) {\n      if ( methods[method] ) {\n        return methods[method].apply( this, Array.prototype.slice.call( arguments, 1 ));\n      } else if ( typeof method === 'object' || ! method ) {\n        return methods.init.apply( this, arguments );\n      } else {\n        $.error( 'Method ' +  method + ' does not exist on jQuery.wysihtml5' );\n      }    \n    };\n\n    $.fn.wysihtml5.Constructor = Wysihtml5;\n\n    var defaultOptions = $.fn.wysihtml5.defaultOptions = {\n      toolbar: {\n        'font-styles': true,\n        'color': false,\n        'emphasis': {\n          'small': true\n        },\n        'blockquote': true,\n        'lists': true,\n        'html': false,\n        'link': true,\n        'image': true,\n        'smallmodals': false\n      },\n      useLineBreaks: false,\n      parserRules: {\n        classes: {\n          'wysiwyg-color-silver' : 1,\n          'wysiwyg-color-gray' : 1,\n          'wysiwyg-color-white' : 1,\n          'wysiwyg-color-maroon' : 1,\n          'wysiwyg-color-red' : 1,\n          'wysiwyg-color-purple' : 1,\n          'wysiwyg-color-fuchsia' : 1,\n          'wysiwyg-color-green' : 1,\n          'wysiwyg-color-lime' : 1,\n          'wysiwyg-color-olive' : 1,\n          'wysiwyg-color-yellow' : 1,\n          'wysiwyg-color-navy' : 1,\n          'wysiwyg-color-blue' : 1,\n          'wysiwyg-color-teal' : 1,\n          'wysiwyg-color-aqua' : 1,\n          'wysiwyg-color-orange' : 1\n        },\n        tags: {\n          'b':  {},\n          'i':  {},\n          'strong': {},\n          'em': {},\n          'p': {},\n          'br': {},\n          'ol': {},\n          'ul': {},\n          'li': {},\n          'h1': {},\n          'h2': {},\n          'h3': {},\n          'h4': {},\n          'h5': {},\n          'h6': {},\n          'blockquote': {},\n          'u': 1,\n          'img': {\n            'check_attributes': {\n              'width': 'numbers',\n              'alt': 'alt',\n              'src': 'url',\n              'height': 'numbers'\n            }\n          },\n          'a':  {\n            'check_attributes': {\n              'href': 'url'\n            },\n            'set_attributes': {\n              'target': '_blank',\n              'rel': 'nofollow'\n            }\n          },\n          'span': 1,\n          'div': 1,\n          'small': 1,\n          'code': 1,\n          'pre': 1\n        }\n      },\n      locale: 'en',\n      shortcuts: {\n        '83': 'small',// S\n        '75': 'createLink'// K\n      }\n    };\n\n    if (typeof $.fn.wysihtml5.defaultOptionsCache === 'undefined') {\n      $.fn.wysihtml5.defaultOptionsCache = $.extend(true, {}, $.fn.wysihtml5.defaultOptions);\n    }\n\n    var locale = $.fn.wysihtml5.locale = {};\n  };\n  bsWysihtml5($, wysihtml5);\n}));\n(function(wysihtml5) {\n  wysihtml5.commands.small = {\n    exec: function(composer, command) {\n      return wysihtml5.commands.formatInline.exec(composer, command, \"small\");\n    },\n\n    state: function(composer, command) {\n      return wysihtml5.commands.formatInline.state(composer, command, \"small\");\n    }\n  };\n})(wysihtml5);\n\n/**\n * English translation for bootstrap-wysihtml5\n */\n(function (factory) {\n    if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define('bootstrap.wysihtml5.en-US', ['jquery', 'bootstrap.wysihtml5'], factory);\n    } else {\n        // Browser globals\n        factory(jQuery);\n    }\n}(function ($) {\n  $.fn.wysihtml5.locale.en = $.fn.wysihtml5.locale['en-US'] = {\n    font_styles: {\n      normal: 'Normal text',\n      h1: 'Heading 1',\n      h2: 'Heading 2',\n      h3: 'Heading 3',\n      h4: 'Heading 4',\n      h5: 'Heading 5',\n      h6: 'Heading 6'\n    },\n    emphasis: {\n      bold: 'Bold',\n      italic: 'Italic',\n      underline: 'Underline',\n      small: 'Small'\n    },\n    lists: {\n      unordered: 'Unordered list',\n      ordered: 'Ordered list',\n      outdent: 'Outdent',\n      indent: 'Indent'\n    },\n    link: {\n      insert: 'Insert link',\n      cancel: 'Cancel',\n      target: 'Open link in new window'\n    },\n    image: {\n      insert: 'Insert image',\n      cancel: 'Cancel'\n    },\n    html: {\n      edit: 'Edit HTML'\n    },\n    colours: {\n      black: 'Black',\n      silver: 'Silver',\n      gray: 'Grey',\n      maroon: 'Maroon',\n      red: 'Red',\n      purple: 'Purple',\n      green: 'Green',\n      olive: 'Olive',\n      navy: 'Navy',\n      blue: 'Blue',\n      orange: 'Orange'\n    }\n  };\n}));\n"]}